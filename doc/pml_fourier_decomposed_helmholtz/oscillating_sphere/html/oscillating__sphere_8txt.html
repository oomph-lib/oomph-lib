<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: oscillating_sphere.txt File Reference</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">oscillating_sphere.txt File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aa05bea9df6009950e0aa53b0c9d0abee"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a> = &quot;../../../fourier_decomposed_helmholtz/sphere_scattering/html/index.html&quot;&gt; another tutorial,&lt;/a &gt; the formulation used here allows the imposition of the Sommerfeld radiation condition by means of so-called &quot;perfectly matched layers&quot;(PMLs) as an alternative to classical absorbing/approximate <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> or DtN maps. We start by reviewing the relevant theory and then present the solution of a simple model <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> - the outward propagation of waves from the surface of a unit sphere.&lt; TABLE border=0 &gt;&lt; TR &gt;&lt; TD &gt;&lt; CENTER class=&quot;panel panel-success&quot;&gt;&lt; div class=&quot;panel-heading&quot;&gt;&lt; B &gt;Acknowledgements&lt;/B &gt;&lt;/div &gt;&lt; div class=&quot;panel-body&quot;&gt;This tutorial and the associated driver codes were developed jointly with Matthew Walker(The University of Manchester), with financial support from Thales Underwater Ltd.&lt;/div &gt;&lt;/CENTER &gt;&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt; HR &gt; \section theory Theory:The azimuthally Fourier-decomposed Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> The Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> governs time-harmonic solutions of problems governed by the linear wave <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\nabla^2 U(x, y, z, t)=\frac{1}{c^2} \frac{\partial^2 U(x, y, z, t)}{\partial t^2}, \ \ \ \ \ \ \ \ \ \ \ \ @E[lin_wave]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ c \f$ is the wavespeed. Assuming that \f$ U(x, y, z, t) \f$ is time-harmonic, with frequency \f$ \omega \f$, we write the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> function \f$ U(x, y, z, t) \f$ as \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[U(x, y, z, t)=Re(u(x, y, z) \ e^{-i \omega t}) \ \ \ \ \ \ \ \ \ \ \ \ @E[time_decomp]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ u(x, y, z) \f$ is complex-valued. This transforms( @R[lin_wave]@) into the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\nabla^2 u(x, y, z)+k^2 u(x, y, z)=0 \, \ \ \ \ \ \ \ \ \ \ \ \ @E[helmholtz]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ k=\omega/c \f$ is the wavenumber. Like other elliptic PDEs the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> admits Dirichlet, Neumann(flux) and Robin <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> conditions. If the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> is solved <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> an unbounded spatial <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a>(e.g. <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> scattering problems) the solution must also satisfy the so-called&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http: Sommerfeld radiation condition&lt;/a&gt;, which <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 3D has the form \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ \lim_{r\to \infty} r \left(\frac{\partial u}{\partial r} - iku \right) =0. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] Mathematically, this condition is required to ensure the uniqueness of the solution (and hence the well-posedness of the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a>). In a physical context, such as a scattering <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a>, the condition ensures that scattering of an incoming wave only produces outgoing not incoming waves from infinity. These equations can be solved using \c oomph-lib's cartesian Helmholtz <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>, described <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> &lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;../../../helmholtz/scattering/html/index.html&quot;&gt;another tutorial.&lt;/a&gt; Here we consider an alternative approach <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> which we solve the equations <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> cylindrical polar coordinates \f$ (r,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,z) \f$, related to the cartesian coordinates \f$ (x,y,z) \f$ via \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ x = r \cos(\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>), \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ y = r \sin(\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>), \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ z = z. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] We then decompose the solution into its Fourier components by writing \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ u(r,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,z) = \sum_{N=-\infty}^{\infty} u_N(r,z) \exp({\rm i} N \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] Since the governing equations are linear we can compute each Fourier component \f$ u_N(r,z) \f$ individually by solving \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ \nabla^2 {u_{N}}(r,z) + \left(k^2-\frac{N^2}{r^2}\right) u_N(r,z) = 0 \ \ \ \ \ \ \ \ \ \ \ \ @E[fourier_helmholtz]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] while specifying the Fourier wavenumber \f$ N \f$ as a parameter. &lt;HR&gt; \section discr Discretisation by finite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> The discretisation of the Fourier-decomposed Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> itself only requires a trivial modification of its &lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;../../../helmholtz/scattering/html/index.html&quot;&gt;cartesian counterpart&lt;/a&gt;. Since most practical applications of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> involve complex-valued solutions, we provide separate storage for the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts of the solution -- each \c Node therefore stores two unknowns values. By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>,the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts are stored as values 0 and 1, respectively</td></tr>
<tr class="separator:aa05bea9df6009950e0aa53b0c9d0abee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa9d9f6559fbca85135a48fb32eda1b88"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aa9d9f6559fbca85135a48fb32eda1b88">interest</a> (the vicinity of the scatterer, say). If computations are performed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> a finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a></td></tr>
<tr class="separator:aa9d9f6559fbca85135a48fb32eda1b88"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acbd75d9c449695d4f3497ee25fe93f33"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown in the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development in&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown in the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, in the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented in the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (in 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> in the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown in the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used in this case can be seen in the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used in the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ in spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed in terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed in terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices in the second sum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> (@R[gen_polar_hh]@). The relation between the cylindrical polar coordinates \f$(r</td></tr>
<tr class="separator:acbd75d9c449695d4f3497ee25fe93f33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aefa4af5ac906f5325536c58dbbfb3f98"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> f partial D_c f of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> f D_c f with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \f[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\f]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \f[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \f] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \f[ s_r(r) = 1. \f] - For the right layer that is aligned with the z axis we set \f[ s_z(z) = 1, \f] and \f[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \f] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \f[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \f] and \f[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \f] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \f[ s_r(r) = s_z(z) = 1. \f].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given by\f[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\f]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the functions\f[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \f]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel functions\f[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\f]The functions\f[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\f]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre polynomials\f[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\f]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l f which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z f and spherical polar coordinates&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> (\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$ is given by \f[\rho</td></tr>
<tr class="separator:aefa4af5ac906f5325536c58dbbfb3f98"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f576549dc9ac2728d61f3ee163c330d"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> and spherical polar coordinates <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\theta = \arctan(r/z),\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> = \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] so <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,2\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> remains and <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> theta <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> sweeps from the north&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a2f576549dc9ac2728d61f3ee163c330d">pole</a> (\f$ \theta=0 \f$)</td></tr>
<tr class="separator:a2f576549dc9ac2728d61f3ee163c330d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afefe646f568feee47987198143fbb914"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> and spherical polar coordinates <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\theta = \arctan(r/z),\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> = \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] so <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,2\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> remains and <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> theta <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> sweeps from the north via the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#afefe646f568feee47987198143fbb914">equator</a> (\f$ \theta=\pi/2 \f$) to the south <a class="el" href="oscillating__sphere_8txt.html#a2f576549dc9ac2728d61f3ee163c330d">pole</a>(\f$ \theta</td></tr>
<tr class="separator:afefe646f568feee47987198143fbb914"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab3ca09673101b3920b214f6d576851d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="oscillating__sphere_8txt.html#a2f76e88828a6b8514d2fa31f12c5515c">Next</a> we define the coefficients dontinclude oscillating_sphere cc skipline <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Vector&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aab3ca09673101b3920b214f6d576851d">Coeff</a> (N_terms, 1.0)</td></tr>
<tr class="memdesc:aab3ca09673101b3920b214f6d576851d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of terms in the exact solution.  <a href="oscillating__sphere_8txt.html#aab3ca09673101b3920b214f6d576851d">More...</a><br /></td></tr>
<tr class="separator:aab3ca09673101b3920b214f6d576851d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a130eaf1d2feef2136f6898ccc17bf86c"><td class="memItemLeft" align="right" valign="top">required for the specification of the exact solution dontinclude oscillating_sphere cc skipline <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a130eaf1d2feef2136f6898ccc17bf86c">get_exact_u</a> (const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;u) and its derivative \dontinclude oscillating_sphere.cc \skipline(spherical r) \<a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> exact_minus_dudr whose listings we omit here.&lt; HR &gt; \subsection drv_cde The driver code The driver code is very straightforward. We create the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> object</td></tr>
<tr class="memdesc:a130eaf1d2feef2136f6898ccc17bf86c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exact solution as a Vector of size 2, containing real and imag parts.  <a href="oscillating__sphere_8txt.html#a130eaf1d2feef2136f6898ccc17bf86c">More...</a><br /></td></tr>
<tr class="separator:a130eaf1d2feef2136f6898ccc17bf86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bc4cd80c8928687b39ebefb5ad315cc"><td class="memItemLeft" align="right" valign="top">and define the output directory dontinclude oscillating_sphere cc skipline <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> doc_info&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a9bc4cd80c8928687b39ebefb5ad315cc">set_directory</a> (<a class="el" href="namespaceProblemParameters.html#a9df0f1728e8e7e53dcca84385ae9a031">ProblemParameters::Directory</a>)</td></tr>
<tr class="separator:a9bc4cd80c8928687b39ebefb5ad315cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14576df8952318060b14848b23a6f9cb"><td class="memItemLeft" align="right" valign="top">we solve the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> and document the results dontinclude oscillating_sphere cc skipline Solve the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> with Newton s method <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a14576df8952318060b14848b23a6f9cb">newton_solve</a> ()</td></tr>
<tr class="separator:a14576df8952318060b14848b23a6f9cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af10ef57b5a2f4bc9729c690c53cd91a4"><td class="memItemLeft" align="right" valign="top">skipline Output the solution <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> end of <a class="el" href="oscillating__sphere_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>&lt; HR &gt; subsection prb_clss The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> class The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> class is very similar to that employed for the&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;../../../helmholtz/scattering/html/index.html&quot;&gt; solution of the D Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> with flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> conditions&lt;/a &gt; We provide helper functions to create the PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> and to apply the <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> (mainly because these tasks have to be performed repeatedly <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spatially adaptive version of this code which is not discussed explicitly here;but see the exercise on \ref adaptivity). \dontinclude oscillating_sphere.cc \skipline start_of_problem_class \<a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> create_power_monitor_mesh()</td></tr>
<tr class="separator:af10ef57b5a2f4bc9729c690c53cd91a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a566114d60479b614e9f94d830e74689d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> dontinclude oscillating_sphere cc skipline Setup <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbering scheme <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a566114d60479b614e9f94d830e74689d">assign_eqn_numbers</a> () The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> can now be solved.&lt; HR &gt; \subsection inner_flx Impose flux on inner <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> The function \c create_flux_elements() creates the FaceElements required to apply the flux/Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> on the <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the sphere. \dontinclude oscillating_sphere.cc \skipline start_of_create_flux_element \<a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> end of create flux <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> on inner <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a>&lt; HR &gt; \subsection p_monitor Create power monitor <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> The function \c create_power_monitor_mesh creates the FaceElements that allow the computation of the radiated power over the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the computational domain. \dontinclude oscillating_sphere.cc \skipline start_of_create_power_monitor_mesh \<a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> end of create_power_monitor_mesh&lt; HR &gt; \subsection c_prob_setup Complete <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> setup The helper function \c complete_problem_setup() completes the setup of the <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by passing pointers to the relevant <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> <a class="el" href="oscillating__sphere_8txt.html#a33650d25d57a83a28469b9defda6fedb">parameters</a> to them. We apply zero Dirichlet <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> on the centreline if the Fourier wavenumber is odd. \dontinclude oscillating_sphere.cc \skipline start_of_complete_problem_setup \<a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a>&lt; HR &gt; \subsection app_z_bc Apply zero Dirichlet <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> This final helper function pins both nodal values(representing the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary part of the solution) on the centreline and sets their values to zero. \dontinclude oscillating_sphere.cc \skipline start_of_apply_zero_dirichlet_boundary_conditions \<a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a>&lt; HR &gt; \subsection p_process Post-processing The post-processing function \c doc_solution(...) outputs the solution within the bulk</td></tr>
<tr class="separator:a566114d60479b614e9f94d830e74689d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28c94e0de096081d389e8e2a238d6bba"><td class="memItemLeft" align="right" valign="top">skipline Output solution within the bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> some_file&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a28c94e0de096081d389e8e2a238d6bba">close</a> ()</td></tr>
<tr class="separator:a28c94e0de096081d389e8e2a238d6bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48949ff2f6e8b315391b69a7d7ee215a"><td class="memItemLeft" align="right" valign="top">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt; HR &gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the most practically relevant solutions of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> are complex valued Since c oomph lib s solvers only deal with&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> (double precision) unknowns</td></tr>
<tr class="separator:a48949ff2f6e8b315391b69a7d7ee215a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a9a18528a3a08b0985c8b197f4e12846b"><td class="memItemLeft" align="right" valign="top">mainpage Example&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a></td></tr>
<tr class="separator:a9a18528a3a08b0985c8b197f4e12846b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22740c20e99352fbe54bcb96d67962cc"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a></td></tr>
<tr class="separator:a22740c20e99352fbe54bcb96d67962cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeebca83226489bb25c0f116bec0e6414"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D_c&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aeebca83226489bb25c0f116bec0e6414">f</a></td></tr>
<tr class="separator:aeebca83226489bb25c0f116bec0e6414"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14e8f683d4fb77d00b3fb8bb90761c23"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a14e8f683d4fb77d00b3fb8bb90761c23">middle</a></td></tr>
<tr class="separator:a14e8f683d4fb77d00b3fb8bb90761c23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3ffce5e745677b8f040caaf3440cd87"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ae3ffce5e745677b8f040caaf3440cd87">it</a></td></tr>
<tr class="separator:ae3ffce5e745677b8f040caaf3440cd87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4e2ee6949033743df56746ccec53b7a"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\varphi,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\varphi) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\varphi)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \varphi). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a></td></tr>
<tr class="separator:ae4e2ee6949033743df56746ccec53b7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad83f065ef4522a53bbfe66955036485e"><td class="memItemLeft" align="right" valign="top">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt; a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> and spherical polar coordinates <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\theta = \arctan(r/z),\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> = \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] so <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,2\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> remains&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ad83f065ef4522a53bbfe66955036485e">unchanged</a></td></tr>
<tr class="separator:ad83f065ef4522a53bbfe66955036485e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6e0fc65935716384de6d75d1442e294"><td class="memItemLeft" align="right" valign="top">required for the specification of the exact solution dontinclude oscillating_sphere cc skipline until void dontinclude oscillating_sphere cc skipline start_of_main&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a></td></tr>
<tr class="separator:ac6e0fc65935716384de6d75d1442e294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad929b1cb755dfec91450fd4b3154900e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a></td></tr>
<tr class="separator:ad929b1cb755dfec91450fd4b3154900e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6a65a4bc905ad6d7bdc2d682c446a4f"><td class="memItemLeft" align="right" valign="top">The private member data includes pointers to the bulk&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a></td></tr>
<tr class="separator:ae6a65a4bc905ad6d7bdc2d682c446a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3515bdc5abaf7202b32eefa88764f1ff"><td class="memItemLeft" align="right" valign="top">The private member data includes pointers to the bulk dontinclude oscillating_sphere cc skipline Pointer to the bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Bulk_mesh_pt a pointer to the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of FaceElements that apply the flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the surface of the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a3515bdc5abaf7202b32eefa88764f1ff">sphere</a></td></tr>
<tr class="separator:a3515bdc5abaf7202b32eefa88764f1ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a152f7b5af32e2751fa06dd6f0aa42f51"><td class="memItemLeft" align="right" valign="top">The private member data includes pointers to the bulk dontinclude oscillating_sphere cc skipline Pointer to the bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Bulk_mesh_pt a pointer to the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of FaceElements that apply the flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the surface of the dontinclude oscillating_sphere cc skipline Mesh of FaceElements that <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Helmholtz_inner_boundary_mesh_pt and the various PML sub&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a></td></tr>
<tr class="separator:a152f7b5af32e2751fa06dd6f0aa42f51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74802b7295659bc9e37a44d70d613d79"><td class="memItemLeft" align="right" valign="top">&lt; HR &gt; subsection prb_con The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> constructor We open a trace file <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> which we record the radiated power and create the c Circle object that defines the curvilinear inner <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> dontinclude oscillating_sphere cc skipline start_of_constructor <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> r_min skipline Circle *inner_circle_pt <a class="el" href="oscillating__sphere_8txt.html#a2f76e88828a6b8514d2fa31f12c5515c">Next</a> we specify the the outer radius of computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> dontinclude oscillating_sphere cc skipline double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a74802b7295659bc9e37a44d70d613d79">r_max</a> =3.0</td></tr>
<tr class="separator:a74802b7295659bc9e37a44d70d613d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad548c9b95034eb12dc7809dbb2fb9a27"><td class="memItemLeft" align="right" valign="top">and define its polygonal outer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a></td></tr>
<tr class="separator:ad548c9b95034eb12dc7809dbb2fb9a27"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04b2b2fb16b8821e58a5b516e51d7ed3"><td class="memItemLeft" align="right" valign="top">and define its polygonal outer&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a04b2b2fb16b8821e58a5b516e51d7ed3">boundary_id</a></td></tr>
<tr class="separator:a04b2b2fb16b8821e58a5b516e51d7ed3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33650d25d57a83a28469b9defda6fedb"><td class="memItemLeft" align="right" valign="top">we specify the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a33650d25d57a83a28469b9defda6fedb">parameters</a></td></tr>
<tr class="separator:a33650d25d57a83a28469b9defda6fedb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba13bf05d9ddc7d35aee69d61bcaa8ae"><td class="memItemLeft" align="right" valign="top">we specify the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> dontinclude oscillating_sphere cc skipline Use the TriangleMeshParameter <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aba13bf05d9ddc7d35aee69d61bcaa8ae">element_area</a></td></tr>
<tr class="separator:aba13bf05d9ddc7d35aee69d61bcaa8ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f76e88828a6b8514d2fa31f12c5515c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a2f76e88828a6b8514d2fa31f12c5515c">Next</a></td></tr>
<tr class="separator:a2f76e88828a6b8514d2fa31f12c5515c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61fe0fc5636402ca3797cad489becf6a"><td class="memItemLeft" align="right" valign="top">we create the FaceElements that apply the flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the <a class="el" href="oscillating__sphere_8txt.html#a3515bdc5abaf7202b32eefa88764f1ff">sphere</a> and add the corresponding <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a61fe0fc5636402ca3797cad489becf6a">too</a></td></tr>
<tr class="separator:a61fe0fc5636402ca3797cad489becf6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af618b8baefd50928e83125b76c2d4f77"><td class="memItemLeft" align="right" valign="top">We create another set of FaceElements that allow the computation of the radiated flux over the outer boundaries of the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a></td></tr>
<tr class="separator:af618b8baefd50928e83125b76c2d4f77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa162f89ece3ec8ee343cb997f9facb2c"><td class="memItemLeft" align="right" valign="top">We complete the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> setup by passing the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> <a class="el" href="oscillating__sphere_8txt.html#a33650d25d57a83a28469b9defda6fedb">parameters</a> to the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a></td></tr>
<tr class="separator:aa162f89ece3ec8ee343cb997f9facb2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fb8037de86c92a80bdf9e1a3c761310"><td class="memItemLeft" align="right" valign="top"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a2fb8037de86c92a80bdf9e1a3c761310">numbers</a></td></tr>
<tr class="separator:a2fb8037de86c92a80bdf9e1a3c761310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd42351d885e00835f391d8eb03b5302"><td class="memItemLeft" align="right" valign="top"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> dontinclude oscillating_sphere cc skipline Setup <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbering scheme <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> the solution within the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#afd42351d885e00835f391d8eb03b5302">PMLs</a></td></tr>
<tr class="separator:afd42351d885e00835f391d8eb03b5302"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade33917a6234df7322b6cafdb0953278"><td class="memItemLeft" align="right" valign="top"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> dontinclude oscillating_sphere cc skipline Setup <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbering scheme <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> the solution within the the exact solution and the radiated power dontinclude oscillating_sphere cc skipline start_of_doc <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#ade33917a6234df7322b6cafdb0953278">npts</a> =5</td></tr>
<tr class="separator:ade33917a6234df7322b6cafdb0953278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bb1e768639877331c6fd6ee89e1eb71"><td class="memItemLeft" align="right" valign="top">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt; HR &gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a8bb1e768639877331c6fd6ee89e1eb71">introduction</a></td></tr>
<tr class="separator:a8bb1e768639877331c6fd6ee89e1eb71"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73aeb342910308bf3baee52239210f17"><td class="memItemLeft" align="right" valign="top">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt; HR &gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the most practically relevant solutions of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> are complex valued Since c oomph lib s solvers only deal with the equations are separated into their <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts In the implementation of the Helmholtz we store the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts of the solution as two separate values at each node By&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a></td></tr>
<tr class="separator:a73aeb342910308bf3baee52239210f17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="aa05bea9df6009950e0aa53b0c9d0abee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa05bea9df6009950e0aa53b0c9d0abee">&#9670;&nbsp;</a></span>href</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a> =  &quot;../../../fourier_decomposed_helmholtz/sphere_scattering/html/index.html&quot;&gt; another tutorial, &lt;/a&gt; the formulation used here allows the imposition of the Sommerfeld radiation condition by means of so-called &quot;perfectly matched layers&quot; (PMLs) as an alternative to classical absorbing/approximate <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> or DtN maps. We start by reviewing the relevant theory and then present the solution of a simple model <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> - the outward propagation of waves from the surface of a unit sphere. &lt;TABLE border=0&gt; &lt;TR&gt; &lt;TD&gt; &lt;CENTER class=&quot;panel panel-success&quot;&gt; &lt;div class=&quot;panel-heading&quot;&gt;&lt;B&gt;Acknowledgements&lt;/B&gt;&lt;/div&gt;&lt;div class=&quot;panel-body&quot;&gt;This tutorial and the associated driver codes were developed jointly with Matthew Walker (The University of Manchester), with financial support from Thales Underwater Ltd. &lt;/div&gt;&lt;/CENTER&gt; &lt;/TD&gt; &lt;/TR&gt; &lt;/TABLE&gt; &lt;HR&gt; \section theory Theory: The azimuthally Fourier-decomposed Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> The Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> governs time-harmonic solutions of problems governed by the linear wave <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ \nabla^2 U(x,y,z,t) = \frac{1}{c^2} \frac{\partial^2 U(x,y,z,t)}{\partial t^2}, \ \ \ \ \ \ \ \ \ \ \ \ @E[lin_wave]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ c \f$ is the wavespeed. Assuming that \f$ U(x,y,z,t) \f$ is time-harmonic, with frequency \f$ \omega \f$, we write the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> function \f$ U(x,y,z,t) \f$ as \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ U(x,y,z,t) = Re (u(x,y,z) \ e^{-i \omega t}) \ \ \ \ \ \ \ \ \ \ \ \ @E[time_decomp]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ u(x,y,z) \f$ is complex-valued. This transforms (@R[lin_wave]@) into the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ \nabla^2 u(x,y,z) + k^2 u(x,y,z) = 0 \ , \ \ \ \ \ \ \ \ \ \ \ \ @E[helmholtz]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ k = \omega/c \f$ is the wavenumber. Like other elliptic PDEs the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> admits Dirichlet, Neumann (flux) and Robin <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> conditions. If the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> is solved <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> an unbounded spatial <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (e.g. <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> scattering problems) the solution must also satisfy the so-called &lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http: Sommerfeld radiation condition&lt;/a&gt;, which <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 3D has the form \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ \lim_{r\to \infty} r \left(\frac{\partial u}{\partial r} - iku \right) =0. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] Mathematically, this condition is required to ensure the uniqueness of the solution (and hence the well-posedness of the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a>). In a physical context, such as a scattering <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a>, the condition ensures that scattering of an incoming wave only produces outgoing not incoming waves from infinity. These equations can be solved using \c oomph-lib's cartesian Helmholtz <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>, described <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> &lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;../../../helmholtz/scattering/html/index.html&quot;&gt;another tutorial.&lt;/a&gt; Here we consider an alternative approach <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> which we solve the equations <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> cylindrical polar coordinates \f$ (r,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,z) \f$, related to the cartesian coordinates \f$ (x,y,z) \f$ via \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ x = r \cos(\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>), \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ y = r \sin(\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>), \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ z = z. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] We then decompose the solution into its Fourier components by writing \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ u(r,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,z) = \sum_{N=-\infty}^{\infty} u_N(r,z) \exp({\rm i} N \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] Since the governing equations are linear we can compute each Fourier component \f$ u_N(r,z) \f$ individually by solving \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ \nabla^2 {u_{N}}(r,z) + \left(k^2-\frac{N^2}{r^2}\right) u_N(r,z) = 0 \ \ \ \ \ \ \ \ \ \ \ \ @E[fourier_helmholtz]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] while specifying the Fourier wavenumber \f$ N \f$ as a parameter. &lt;HR&gt; \section discr Discretisation by finite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> The discretisation of the Fourier-decomposed Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> itself only requires a trivial modification of its &lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;../../../helmholtz/scattering/html/index.html&quot;&gt;cartesian counterpart&lt;/a&gt;. Since most practical applications of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> involve complex-valued solutions, we provide separate storage for the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts of the solution -- each \c Node therefore stores two unknowns values. By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>,the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts are stored as values 0 and 1, respectively</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00112">112</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a566114d60479b614e9f94d830e74689d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a566114d60479b614e9f94d830e74689d">&#9670;&nbsp;</a></span>assign_eqn_numbers()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> dontinclude oscillating_sphere cc skipline Setup <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbering scheme <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> assign_eqn_numbers </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">final</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00790">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;::PMLFourierDecomposedHelmholtzProblem()</a>.</p>

</div>
</div>
<a id="a28c94e0de096081d389e8e2a238d6bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28c94e0de096081d389e8e2a238d6bba">&#9670;&nbsp;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">skipline Output exact solution <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> some_file close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aab3ca09673101b3920b214f6d576851d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab3ca09673101b3920b214f6d576851d">&#9670;&nbsp;</a></span>Coeff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oscillating__sphere_8txt.html#a2f76e88828a6b8514d2fa31f12c5515c">Next</a> we define the coefficients dontinclude oscillating_sphere cc skipline <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Vector&lt;double&gt; Coeff </td>
          <td>(</td>
          <td class="paramtype">N_terms&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">1.&#160;</td>
          <td class="paramname"><em>0</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of terms in the exact solution. </p>

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00147">ProblemParameters::exact_minus_dudr()</a>, and <a class="el" href="oscillating__sphere_8cc_source.html#l00086">ProblemParameters::get_exact_u()</a>.</p>

</div>
</div>
<a id="af10ef57b5a2f4bc9729c690c53cd91a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af10ef57b5a2f4bc9729c690c53cd91a4">&#9670;&nbsp;</a></span>conditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">skipline Output the solution <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> end of <a class="el" href="oscillating__sphere_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>&lt;HR&gt; subsection prb_clss The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> class The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> class is very similar to that employed for the&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;../../../helmholtz/scattering/html/index.html&quot;&gt; solution of the D Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> with flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> conditions&lt;/a&gt; We provide helper functions to create the PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> and to apply the <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> conditions </td>
          <td>(</td>
          <td class="paramtype">mainly because these tasks have to be performed repeatedly <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spatially adaptive version of this code which is not discussed explicitly here;but see the exercise on \ref&#160;</td>
          <td class="paramname"><em>adaptivity</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afefe646f568feee47987198143fbb914"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afefe646f568feee47987198143fbb914">&#9670;&nbsp;</a></span>equator()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> and spherical polar coordinates <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\theta = \arctan(r/z),\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> = \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] so <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,2\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> remains and <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> theta <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> sweeps from the north via the equator </td>
          <td>(</td>
          <td class="paramtype">\f$ \&#160;</td>
          <td class="paramname"><em>theta</em> = <code>\pi/2&#160;\f$</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aefa4af5ac906f5325536c58dbbfb3f98"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aefa4af5ac906f5325536c58dbbfb3f98">&#9670;&nbsp;</a></span>f()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> f partial D_c f of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> f D_c f with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \f[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\f]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \f[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \f] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \f[ s_r(r) = 1. \f] - For the right layer that is aligned with the z axis we set \f[ s_z(z) = 1, \f] and \f[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \f] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \f[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \f] and \f[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \f] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \f[ s_r(r) = s_z(z) = 1. \f].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given by\f[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\f]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the functions\f[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \f]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel functions\f[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\f]The functions\f[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\f]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre polynomials\f[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\f]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l f which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z f and spherical polar coordinates f </td>
          <td>(</td>
          <td class="paramtype">\&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">\&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">\&#160;</td>
          <td class="paramname"><em>varphi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a130eaf1d2feef2136f6898ccc17bf86c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a130eaf1d2feef2136f6898ccc17bf86c">&#9670;&nbsp;</a></span>get_exact_u()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">required for the specification of the exact solution dontinclude oscillating_sphere cc skipline <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> void get_exact_u </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exact solution as a Vector of size 2, containing real and imag parts. </p>

</div>
</div>
<a id="acbd75d9c449695d4f3497ee25fe93f33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acbd75d9c449695d4f3497ee25fe93f33">&#9670;&nbsp;</a></span>in()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown in the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development in&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown in the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, in the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented in the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (in 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> in the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown in the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used in this case can be seen in the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used in the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ in spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed in terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed in terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices in the second sum in </td>
          <td>(</td>
          <td class="paramtype">@R@&#160;</td>
          <td class="paramname">[gen_polar_hh]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa9d9f6559fbca85135a48fb32eda1b88"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d9f6559fbca85135a48fb32eda1b88">&#9670;&nbsp;</a></span>interest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of interest </td>
          <td>(</td>
          <td class="paramtype">the vicinity of the&#160;</td>
          <td class="paramname"><em>scatterer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">say&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a14576df8952318060b14848b23a6f9cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14576df8952318060b14848b23a6f9cb">&#9670;&nbsp;</a></span>newton_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">we solve the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> and document the results dontinclude oscillating_sphere cc skipline Solve the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> with Newton s method <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> newton_solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2f576549dc9ac2728d61f3ee163c330d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f576549dc9ac2728d61f3ee163c330d">&#9670;&nbsp;</a></span>pole()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> and spherical polar coordinates <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\theta = \arctan(r/z),\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> = \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] so <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,2\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> remains and <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> theta <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> sweeps from the north pole </td>
          <td>(</td>
          <td class="paramtype">\f$ \&#160;</td>
          <td class="paramname"><em>theta</em> = <code>0&#160;\f$</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a48949ff2f6e8b315391b69a7d7ee215a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48949ff2f6e8b315391b69a7d7ee215a">&#9670;&nbsp;</a></span>real()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt;HR&gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the most practically relevant solutions of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> are complex valued Since c oomph lib s solvers only deal with real </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precision</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00284">oomph::PMLHelmholtzPointSourceElement&lt; ELEMENT &gt;::fill_in_point_source_contribution_to_residuals()</a>.</p>

</div>
</div>
<a id="a9bc4cd80c8928687b39ebefb5ad315cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9bc4cd80c8928687b39ebefb5ad315cc">&#9670;&nbsp;</a></span>set_directory()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">and define the output directory dontinclude oscillating_sphere cc skipline <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> doc_info set_directory </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespaceProblemParameters.html#a9df0f1728e8e7e53dcca84385ae9a031">ProblemParameters::Directory</a>&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad548c9b95034eb12dc7809dbb2fb9a27"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad548c9b95034eb12dc7809dbb2fb9a27">&#9670;&nbsp;</a></span>boundary</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">and combine the various pieces of the boundary to the closed outer boundary</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00468">468</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a04b2b2fb16b8821e58a5b516e51d7ed3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04b2b2fb16b8821e58a5b516e51d7ed3">&#9670;&nbsp;</a></span>boundary_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">and define its polygonal outer boundary_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00468">468</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00790">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;::PMLFourierDecomposedHelmholtzProblem()</a>.</p>

</div>
</div>
<a id="a73aeb342910308bf3baee52239210f17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73aeb342910308bf3baee52239210f17">&#9670;&nbsp;</a></span>default</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt;HR&gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the most practically relevant solutions of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> are complex valued Since c oomph lib s solvers only deal with the equations are separated into their <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts In the implementation of the Helmholtz we store the <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts of the solution as two separate values at each node By default</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00623">623</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="af618b8baefd50928e83125b76c2d4f77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af618b8baefd50928e83125b76c2d4f77">&#9670;&nbsp;</a></span>domain</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">We create another set of FaceElements that allow the computation of the radiated flux over the outer boundaries of the domain</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00506">506</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="aba13bf05d9ddc7d35aee69d61bcaa8ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba13bf05d9ddc7d35aee69d61bcaa8ae">&#9670;&nbsp;</a></span>element_area</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">we specify the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> dontinclude oscillating_sphere cc skipline Use the TriangleMeshParameter <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> element_area</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00487">487</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00790">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;::PMLFourierDecomposedHelmholtzProblem()</a>.</p>

</div>
</div>
<a id="aa162f89ece3ec8ee343cb997f9facb2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa162f89ece3ec8ee343cb997f9facb2c">&#9670;&nbsp;</a></span>elements</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt;HR&gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the most practically relevant solutions of the Helmholtz <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> are complex valued Since c oomph lib s solvers only deal with the equations are separated into their <a class="el" href="oscillating__sphere_8txt.html#a48949ff2f6e8b315391b69a7d7ee215a">real</a> and imaginary parts In the implementation of the Helmholtz elements</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00520">520</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a22740c20e99352fbe54bcb96d67962cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22740c20e99352fbe54bcb96d67962cc">&#9670;&nbsp;</a></span>equation</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson equation</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00138">138</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="aeebca83226489bb25c0f116bec0e6414"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeebca83226489bb25c0f116bec0e6414">&#9670;&nbsp;</a></span>f</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of f D_c f</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00144">144</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ad929b1cb755dfec91450fd4b3154900e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad929b1cb755dfec91450fd4b3154900e">&#9670;&nbsp;</a></span>Finally</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Finally</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00401">401</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a8bb1e768639877331c6fd6ee89e1eb71"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bb1e768639877331c6fd6ee89e1eb71">&#9670;&nbsp;</a></span>introduction</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">dontinclude oscillating_sphere cc skipline Total radiated power <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> power&lt;&lt; std::endl&lt;HR&gt; section comments Comments and Exercises subsection unkns The enumeration of the unknowns As discussed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the introduction</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00617">617</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ae3ffce5e745677b8f040caaf3440cd87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3ffce5e745677b8f040caaf3440cd87">&#9670;&nbsp;</a></span>it</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within it</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00151">151</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ae6a65a4bc905ad6d7bdc2d682c446a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6a65a4bc905ad6d7bdc2d682c446a4f">&#9670;&nbsp;</a></span>mesh</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">This mesh does not need to be added to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> since its <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> merely act as post processing tools and do not provide any contributions to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> s residual vector We build the PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> and combine the various sub <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> s global mesh</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00427">427</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a152f7b5af32e2751fa06dd6f0aa42f51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a152f7b5af32e2751fa06dd6f0aa42f51">&#9670;&nbsp;</a></span>meshes</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The private member data includes pointers to the bulk dontinclude oscillating_sphere cc skipline Pointer to the bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Bulk_mesh_pt a pointer to the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of FaceElements that apply the flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the surface of the dontinclude oscillating_sphere cc skipline Mesh of FaceElements that <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> Helmholtz_inner_boundary_mesh_pt and the various PML sub meshes</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00444">444</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a14e8f683d4fb77d00b3fb8bb90761c23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14e8f683d4fb77d00b3fb8bb90761c23">&#9670;&nbsp;</a></span>middle</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the middle</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00144">144</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a2f76e88828a6b8514d2fa31f12c5515c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f76e88828a6b8514d2fa31f12c5515c">&#9670;&nbsp;</a></span>Next</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Next</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00495">495</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ade33917a6234df7322b6cafdb0953278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade33917a6234df7322b6cafdb0953278">&#9670;&nbsp;</a></span>npts</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> dontinclude oscillating_sphere cc skipline Setup <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbering scheme <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> the solution within the the exact solution and the radiated power dontinclude oscillating_sphere cc skipline start_of_doc <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> unsigned npts =5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00595">595</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00975">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;::doc_solution()</a>.</p>

</div>
</div>
<a id="a2fb8037de86c92a80bdf9e1a3c761310"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2fb8037de86c92a80bdf9e1a3c761310">&#9670;&nbsp;</a></span>numbers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbers</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00529">529</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a33650d25d57a83a28469b9defda6fedb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33650d25d57a83a28469b9defda6fedb">&#9670;&nbsp;</a></span>parameters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">we specify the <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> parameters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00483">483</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="afd42351d885e00835f391d8eb03b5302"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd42351d885e00835f391d8eb03b5302">&#9670;&nbsp;</a></span>PMLs</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a> we assign the <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> dontinclude oscillating_sphere cc skipline Setup <a class="el" href="oscillating__sphere_8txt.html#a22740c20e99352fbe54bcb96d67962cc">equation</a> numbering scheme <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> the solution within the PMLs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00590">590</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a9a18528a3a08b0985c8b197f4e12846b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a18528a3a08b0985c8b197f4e12846b">&#9670;&nbsp;</a></span>problem</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">build the bulk and add <a class="el" href="oscillating__sphere_8txt.html#ae3ffce5e745677b8f040caaf3440cd87">it</a> to the problem</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00004">4</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l01184">main()</a>.</p>

</div>
</div>
<a id="a74802b7295659bc9e37a44d70d613d79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74802b7295659bc9e37a44d70d613d79">&#9670;&nbsp;</a></span>r_max</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">&lt;HR&gt; subsection prb_con The <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> constructor We open a trace file <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> which we record the radiated power and create the c Circle object that defines the curvilinear inner <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> dontinclude oscillating_sphere cc skipline start_of_constructor <a class="el" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a> r_min skipline Circle* inner_circle_pt <a class="el" href="oscillating__sphere_8txt.html#a2f76e88828a6b8514d2fa31f12c5515c">Next</a> we specify the the outer radius of computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> dontinclude oscillating_sphere cc skipline double r_max =3.0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00462">462</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

<p class="reference">Referenced by <a class="el" href="oscillating__sphere_8cc_source.html#l00790">PMLFourierDecomposedHelmholtzProblem&lt; ELEMENT &gt;::PMLFourierDecomposedHelmholtzProblem()</a>.</p>

</div>
</div>
<a id="a3515bdc5abaf7202b32eefa88764f1ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3515bdc5abaf7202b32eefa88764f1ff">&#9670;&nbsp;</a></span>sphere</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="oscillating__sphere_8txt.html#a2f76e88828a6b8514d2fa31f12c5515c">Next</a> we define the curvilinear inner <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of a c TriangleMeshCurviLine which defines the surface of the sphere</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00434">434</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="a61fe0fc5636402ca3797cad489becf6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61fe0fc5636402ca3797cad489becf6a">&#9670;&nbsp;</a></span>too</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">we create the FaceElements that apply the flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the <a class="el" href="oscillating__sphere_8txt.html#a3515bdc5abaf7202b32eefa88764f1ff">sphere</a> and add the corresponding <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> too</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00500">500</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ad83f065ef4522a53bbfe66955036485e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad83f065ef4522a53bbfe66955036485e">&#9670;&nbsp;</a></span>unchanged</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum z <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> and spherical polar coordinates <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\theta = \arctan(r/z),\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> [\<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> = \<a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a>,\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] so <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> <a class="el" href="oscillating__sphere_8txt.html#ae4e2ee6949033743df56746ccec53b7a">varphi</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> [0,2\pi] <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> remains unchanged</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00324">324</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ac6e0fc65935716384de6d75d1442e294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6e0fc65935716384de6d75d1442e294">&#9670;&nbsp;</a></span>until</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">required for the specification of the exact solution dontinclude oscillating_sphere cc skipline until void dontinclude oscillating_sphere cc skipline start_of_main until</td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Initial value:</b><div class="fragment"><div class="line">{</div>
<div class="line">\skipline Create the <a class="code" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> with 2D six-<a class="code" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">node</a></div>
<div class="line"><a class="code" href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">\until</a> <a class="code" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a></div>
</div><!-- fragment -->
<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00390">390</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
<a id="ae4e2ee6949033743df56746ccec53b7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae4e2ee6949033743df56746ccec53b7a">&#9670;&nbsp;</a></span>varphi</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">The application of Dirichlet and Neumann <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#af10ef57b5a2f4bc9729c690c53cd91a4">conditions</a> is straightforward and follows the pattern employed for the solution of the Poisson with the Sommerfeld radiation condition ensuring the suitable decay of the solution at large distances from the region of <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the spurious wave reflections are likely to be generated at the artificial <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> partial D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> The idea behind PML methods is to surround the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> D_c <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> with a layer of absorbing material whose properties are chosen such that the outgoing waves are absorbed within without creating any artificial reflected waves at the interface between the PML layer and the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> Our implementation of the perfectly matched layers follows the development <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a>&lt;a <a class="el" href="oscillating__sphere_8txt.html#aa05bea9df6009950e0aa53b0c9d0abee">href</a>=&quot;http:A. Bermudez, L. Hervella-Nieto, A. Prieto, and R. Rodriguez &quot;An optimal perfectly matched layer with unbounded absorbing function for time-harmonic acoustic scattering problems&quot;Journal of Computational Physics &lt;b&gt;223&lt;/b&gt; 469-488 (2007)&lt;/a&gt;and we assume the boundaries of the computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> to be alignedwith the coordinate axes, as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the sketch below.The method requires a slight further generalisation of the equations, achieved by introducing the complex coordinate mapping \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[\frac{\partial}{\partial x_j} \to \frac{1}{s_j(x_j)} \frac{\partial}{\partial x_j} \ \ \ \ \mbox{where $j =&quot;r&quot;,&quot;z&quot;$} \ \ \ \ \ \ \ \ @E[cctransform]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]within the perfectly matched layers. The choice of \f$ s_r(r) \f$ and \f$ s_z(z) \f$ depends on the orientation of the PML layer. Since we are restricting ourselves to axis-alignedmesh boundaries we distinguish three different cases- For layers that are aligned with the r axis (such as the top and bottom PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1 +\frac{i}{k}\ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}, \ \ \ \ \ @E[absorbingfctx]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ Z_{PML} \f$ is the z-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer, and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - For the right layer that is aligned with the z axis we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1, \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1+\frac{i}{k} \ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|}, \ \ \ \ \ @E[absorbingfcty]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] where \f$ R_{PML} \f$ is the r-coordinate of the outer <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> of the PML layer. - In corner regions that are bounded by two axis-aligned PML layers (with outer coordinates \f$ R_{PML} \f$ and \f$ Z_{PML} \f$) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = 1 +\frac{i}{k}\ \sigma_{r}(r) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{r}(r) = \frac{1}{|R_{PML}-r|} \ \ \ \ \ @E[absorbingfctx_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] and \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_z(z) = 1+\frac{i}{k} \ \sigma_{z}(z) \ \ \ \ \ \ \ \mbox{ \ \ \ with \ \ \ } \sigma_{z}(z) = \frac{1}{|Z_{PML}-z|}. \ \ \ \ \ @E[absorbingfcty_corner]@ \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>] - <a class="el" href="oscillating__sphere_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a>, <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the actual computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> (outside the PML layers) we set \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>[ s_r(r) = s_z(z) = 1. \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>].&lt;HR&gt;\section impl Implementation within oomph-libThe finite-element-discretised equations (modified by the PML terms discussed above) are implemented <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the \c PMLFourierDecomposedHelmholtzEquations class. As usual, we provide fully functional <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> by combining these with geometricfinite <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> (from the Q and T families -- corresponding (<a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> 2D)to triangles and quad <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a>). By <a class="el" href="oscillating__sphere_8txt.html#a73aeb342910308bf3baee52239210f17">default</a>, the PML modificationsare disabled, i.e. \f$ s_{r}(r) \f$ and \f$ s_{z}(z) \f$ are bothset to 1. The generation of suitable 2D PML <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> along the axis-alignedboundaries of a given bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> is facilitated by helperfunctions which automatically erect layers of (quadrilateral)PML elements. The layers are built from \c QPMLFourierDecomposedHelmholtzElement&lt;NNODE_1D&gt; <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> andthe parameter \c NNODE_1D is automatically chosen to match that ofthe <a class="el" href="oscillating__sphere_8txt.html#aa162f89ece3ec8ee343cb997f9facb2c">elements</a> <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the bulk mesh. The bulk <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> can contain quads or triangles(as shown <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the specific example presented below).&lt;HR&gt;\section osc_sph A specific example: Outward propagation of waves from the surface of an oscillating sphereWe will now demonstrate the methodology for a specific example:the propagation of waves from the surface of a unit sphere.The specific <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> this case can be seen <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the figure below.We create an unstructured <a class="el" href="oscillating__sphere_8txt.html#ae6a65a4bc905ad6d7bdc2d682c446a4f">mesh</a> of six-noded \c TPMLFourierDecomposedHelmholtzElementsto create the finite computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> surrounding a sphere.This is surrounded by three axis-aligned PML layers and twocorner <a class="el" href="oscillating__sphere_8txt.html#a152f7b5af32e2751fa06dd6f0aa42f51">meshes</a> (each made of nine-noded \c QPMLFourierDecomposedHelmholtzElements).@I w 0.5\textwidth comp_domain &quot;The computational <a class="el" href="oscillating__sphere_8txt.html#af618b8baefd50928e83125b76c2d4f77">domain</a> used <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the example problem. &quot;We construct an exact solution to the <a class="el" href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a> by applyingNeumann/flux <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> condition on the innerspherical <a class="el" href="oscillating__sphere_8txt.html#ad548c9b95034eb12dc7809dbb2fb9a27">boundary</a> such that the imposed flux \f$ \partial u/\partialn \f$ is consistent with the exact solution\f$ u(\rho,\varphi,\theta) \f$ <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> spherical polar coordinates \f$(\rho,\theta,\varphi) \f$, given <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">by\f</a>[u(\rho,\theta,\varphi)=\sum_{l=0}^{+\infty}\sum_{n=-l}^{l}\left(a_{ln} \ h_{l}^{(1)}(k\rho)+b_{ln} \ h_{l}^{(2)}(k\rho)\right)P_{l}^{n}(\cos\theta)\exp({\rm i} n \varphi). \ \ \ \ \ \ \ @E[gen_polar_hh]@\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]where the \f$a_{ln}, b_{ln} \f$ are arbitrary coefficients and the <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[h_{l}^{(1)}(x)=j_{l}(x)+{\rm i} y_{l}(x) \mbox{ \ \ \ \ and \ \ \ \ }h_{l}^{(2)}(x)=j_{l}(x)-{\rm i} y_{l}(x) \<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the spherical Hankel functions of first and second kind,respectively, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms the spherical Bessel <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[j_{l}(x)=\sqrt{\frac{\pi}{2x}}J_{l+1/2}(x) \mbox{ \ \ \ \ and \ \ \ \ }y_{l}(x)=\sqrt{\frac{\pi}{2x}}Y_{l+1/2}(x).\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]The <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">functions\f</a>[P_{l}^{m}(x)=(-1)^{m}(1-x^2)^{m/2}\frac{d^m}{dx^m}P_{l}(x)\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]are the associated Legendre functions, expressed <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> terms of theLegendre <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">polynomials\f</a>[P_{n}(x)=\frac{1}{2^{n} \, n!}\frac{d^n}{dx^n}[(x^2-1)^{n}].\<a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a>]This definition shows that \f$ P_{l}^{m}(x)=0 \f$ for \f$ m&gt; l <a class="el" href="oscillating__sphere_8txt.html#aefa4af5ac906f5325536c58dbbfb3f98">f</a> which explains the limited range of summation indices <a class="el" href="oscillating__sphere_8txt.html#acbd75d9c449695d4f3497ee25fe93f33">in</a> the second sum varphi</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="oscillating__sphere_8txt_source.html#l00312">312</a> of file <a class="el" href="oscillating__sphere_8txt_source.html">oscillating_sphere.txt</a>.</p>

</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aoscillating__sphere_8txt_html_a9a18528a3a08b0985c8b197f4e12846b"><div class="ttname"><a href="oscillating__sphere_8txt.html#a9a18528a3a08b0985c8b197f4e12846b">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="oscillating__sphere_8txt_source.html#l00004">oscillating_sphere.txt:4</a></div></div>
<div class="ttc" id="aoscillating__sphere_8txt_html_ac6e0fc65935716384de6d75d1442e294"><div class="ttname"><a href="oscillating__sphere_8txt.html#ac6e0fc65935716384de6d75d1442e294">until</a></div><div class="ttdeci">required for the specification of the exact solution dontinclude oscillating_sphere cc skipline until void dontinclude oscillating_sphere cc skipline start_of_main until</div><div class="ttdef"><b>Definition:</b> <a href="oscillating__sphere_8txt_source.html#l00390">oscillating_sphere.txt:390</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 23 2021 09:10:39
        </div>
      </div>
    </footer>
</body>
</html>

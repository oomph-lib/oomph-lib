<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Download/installation instructions</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../figures/manifest.json">
<link rel="mask-icon" href="../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../html/index.html"><img alt="oomph-lib" src="../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Download/installation instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p> 
<p>The latest version of the library is 1.0, 
<script>
      // This odd/hacky construction extracts the svn information automatically
       var revString = "$LastChangedRevision$";
       var dateString = "$LastChangedDate$";
       
       //Revision number should never be more than 5 digits
       revString = revString.substr(revString.indexOf(":")+1,5).trim();
       
       // The string should always be the same length
       var timeString = dateString.substr(28,8);
       
       dateString = dateString.substr(dateString.indexOf("(")+1, dateString.indexOf(")") - dateString.indexOf("(")-1);
       
       document.write("revision number ");
       document.write(revString);
       document.write(" and was committed on ");
       document.write(dateString);
       document.write(".");
</script> 
</p>
</p>
<p>See the <a href="../../change_log/html/index.html">change log page</a> for an overview of the changes made since the previous release.</p>
<h1><a class="anchor" id="instructions"></a>
The download/install process, step by step</h1>
<ol type="1">
<li><a class="el" href="index.html#download">Get the distribution</a><ol type="a">
<li><a class="el" href="index.html#tar_file">Option 1: Get a tar file</a></li>
<li><a class="el" href="index.html#subversion">Option 2: Get the distribution from the subversion repository</a></li>
</ol>
</li>
<li><a class="el" href="index.html#install">Install the distribution</a><ol type="a">
<li><a class="el" href="index.html#manual_install">Manual installation</a></li>
<li><a class="el" href="index.html#standard_install">Option 1: Standard installation</a></li>
<li><a class="el" href="index.html#custom_install">Configuration options</a></li>
</ol>
</li>
<li><a class="el" href="index.html#nav">Finding your way through the distribution</a></li>
<li><a class="el" href="index.html#external">External (third-party) libraries</a><ol type="a">
<li><a class="el" href="index.html#external_src">External (third-party) libraries that are distributed with oomph-lib</a><ol type="i">
<li><a class="el" href="index.html#blas">Specifying an existing, local copy of the blas library</a></li>
<li><a class="el" href="index.html#lapack">Specifying an existing, local copy of the lapack library</a></li>
</ol>
</li>
<li><a class="el" href="index.html#external_dist_cgal_etc">External (third-party) libraries whose tar files are distributed with oomph-lib</a></li>
<li><a class="el" href="index.html#external_dist">External (third-party) libraries that are not distributed with oomph-lib</a><ol type="i">
<li><a class="el" href="index.html#hypre">Hypre</a></li>
<li><a class="el" href="index.html#trilinos">Trilinos</a></li>
<li><a class="el" href="index.html#mumps">MUMPS and ScaLAPACK</a></li>
</ol>
</li>
</ol>
</li>
<li><a class="el" href="index.html#own">How to write your own code and link it against oomph-lib's library/libraries</a><ol type="a">
<li><a class="el" href="index.html#have_auto_tools">Writing/linking your own driver codes under autotools control</a><ol type="i">
<li><a class="el" href="index.html#add_driver">Adding your own driver codes</a></li>
<li><a class="el" href="index.html#add_src">Adding new libraries and linking against them from driver codes</a></li>
</ol>
</li>
<li><a class="el" href="index.html#dont_have_auto_tools">Writing/linking user code without autotools</a></li>
</ol>
</li>
</ol>
<hr  />
 <hr  />
<h1><a class="anchor" id="download"></a>
Get the distribution</h1>
<h2><a class="anchor" id="tar_file"></a>
Option 1: Get a tar file</h2>
<p>You can download a tar file of the latest distribution from the <a href="../../download/html/index.html">oomph-lib download page</a>.</p>
<p>Once you have downloaded the tar file unpack it:</p>
<div class="fragment"><div class="line">tar xvfz oomph-lib-*.tar.gz</div>
</div><!-- fragment --><p>The entire distribution will now be contained in the sub-directory <code>oomph-lib-*</code> where the "*" indicates the version/revision number (the same as in the tar file).</p>
<h2><a class="anchor" id="subversion"></a>
Option 2: Get the distribution from the subversion repository</h2>
<p>You can also get hold of the library from our <a href="http://www.subversion.tigris.org">subversion</a>-based repository. The procedure for checking out from the repository is explained in <a href="../../subversion/html/index.html">another tutorial.</a> When checking out from the repository, you can specify where the distribution is placed. By default subversion will place it into a directory called <code>trunk</code>.</p>
<hr  />
<h1><a class="anchor" id="install"></a>
Install the distribution</h1>
<h2><a class="anchor" id="standard_install"></a>
Option 1: Standard installation</h2>
<p>Change into the <code>oomph-lib</code> directory and run the <code>autogen.sh</code> build script:</p>
<div class="fragment"><div class="line">cd oomph-lib-*</div>
<div class="line">./autogen.sh</div>
</div><!-- fragment --><p>This build script will ask a few questions, e.g. to verify that the default build directory (<code>build </code>, relative to the oomph-lib home directory) is appropriate before starting the build.</p>
<p>By default, <code>autogen</code>.<code>sh</code> will build the library and the demo codes with certain default settings (using the gcc compilers with full optimisation, no debugging, no PARANOIA, and fully installed header files rather than symbolic links). These are appropriate if you wish to install the library once-and-for-all and do not anticipate any changes to their sources. The section <a class="el" href="index.html#custom_install">Configuration options</a> provides more details on the various options). <code>autogen.sh</code> will display the configure options and ask for confirmation that they are appropriate. If you are unsure if they are, simply hit return &ndash; the default will be fine.</p>
<p>The following flags for <code>autogen.sh</code> may be of interest:</p>
<ul>
<li><code>--jobs=n</code>: Run the build process using <code>n</code> cores. This can greatly speed up build times and is strongly recommended if you have a multicore machine.</li>
<li><code>--rebuild</code>: Rebuild the configuration files from scratch. This is useful if you believe you may have somehow broken the build process, but should not be necessary normally.</li>
</ul>
<p>Under the hood <code>autogen.sh</code> simply collects settings in a question and answer manner then calls a non-interactive script <code>non_interactive_autogen.sh</code> (yes, really!) with the appropriate flags. If you prefer you can simply call <code>non_interactive_autogen.sh</code> directly.</p>
<p>The self-tests can be initiated outside of <code>autogen.sh</code> using <code>make check -k</code> (to run on a single core) or <code>./bin/parallel_self_test.py</code> (to run on all available cores). These commands will compile and run all the demo codes and verify their output. This is an optional step and can be very time consuming, especially if run on a small number of cores.</p>
<h2><a class="anchor" id="manual_install"></a>
Manual installation</h2>
<p>If you're an experienced linux/unix user, you may prefer to control the build/install process manually, using the standard <code>configure</code>; <code>make</code>; <code>make</code> <code>install</code>; <code>make</code> <code>check</code>; sequence. Note that this will <em>only</em> work when building the tar file version (i.e. not the version from svn which still requires the configure script to be generated). In this case, the library will be compiled with GNU's default compiler options ("-O3 -g") and the libraries and include files will be installed in <code>/usr/local/</code> unless you specify a different directory with the <code>&ndash;prefix</code> argument to the <code>configure</code> command. Here's an example of a manual installation</p>
<ul>
<li>Unpack the distribution (you may have to replace the "*" with the actual revision number) <div class="fragment"><div class="line">tar xvfz oomph-lib-*.tar.gz</div>
</div><!-- fragment --></li>
<li>Change into the oomph-lib home directory (again, you may have to replace the "*" with the actual revision information) <div class="fragment"><div class="line">cd oomph-lib-*</div>
</div><!-- fragment --></li>
<li>Store the oomph-lib home directory in shell variable &ndash; in a bash shell this is done like this: <div class="fragment"><div class="line">OOMPH_HOME=`pwd`</div>
</div><!-- fragment --></li>
<li>Create the build directory &ndash; specify your own here! <div class="fragment"><div class="line">mkdir $OOMPH_HOME/build</div>
</div><!-- fragment --></li>
<li>Configure the distribution &ndash; prefix specifies the build directory <div class="fragment"><div class="line">./configure --prefix $OOMPH_HOME/build</div>
</div><!-- fragment --></li>
<li>Make and install the library <div class="fragment"><div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a>; <a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a> <a class="code" href="the__distribution_8txt.html#a450df5a275b46b68f1cc00515f04aefa">install</a></div>
</div><!-- fragment --></li>
<li>Done! Check if we can make and run the user codes <div class="fragment"><div class="line">cd $OOMPH_HOME/user_drivers/joe_cool</div>
<div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a></div>
<div class="line">./joes_poisson_code</div>
</div><!-- fragment --></li>
<li>Run the self-tests <div class="fragment"><div class="line">cd $OOMPH_HOME</div>
<div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a> <a class="code" href="the__distribution_8txt.html#ae663bd6cf76ba6ed02e28b120477cf7c">check</a> -k</div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="custom_install"></a>
Configuration options</h2>
<p>The build scripts allow you to specify a file of configure options. For instance, you may wish to specify another compiler, change the optimisation level, allow for debugging or range checking, etc. Previously used sets of options are stored in various files in the sub-directory <code>config/configure_options/</code>. The default settings are in <code>default</code>; the currently used ones are in <code>current</code>.</p>
<p>What options are there? You can get a complete list by typing </p><pre class="fragment">./configure --help
</pre><p>in <code>oomph-lib</code>'s top level directory. Here are some options that we use frequently:</p>
<h3><a class="anchor" id="no_doc"></a>
Suppressing the build of the documentation:</h3>
<p>Building the online documentation locally is time consuming and requires a significant amount of disk space. Since the documentation is also available from the <a href="http://www.oomph-lib.org">oomph-lib homepage</a> you may wish to suppress this step. To achieve this, specify the configure option </p><pre class="fragment">--enable-suppress-doc
</pre><h3><a class="anchor" id="no_doc"></a>
Suppressing the build of the documentation:</h3>
<p>By default the tutorials are built as html files (which are best accessed by starting from the local copy of the <code>oomph-lib</code> homepage, which is in <code>doc/html/index.html</code>) and as pdf files (which are accessible via a link at the bottom of the relevant html-based tutorial). In the past we have sometimes had problems with <code>doxygen</code> (and hence the entire build process!) hanging while the pdf files are generated. To avoid this (by not even attempting to create the pdf files) specify the configure option </p><pre class="fragment">--enable-suppress-pdf-doc
</pre><p>(or better: update to a more recent version of <code>doxygen</code> &ndash; for instance version 1.8.6 works).</p>
<h3><a class="anchor" id="sym_links"></a>
Replace library headers by symbolic links to the sources</h3>
<p>During the build process <code>oomph-lib's</code> various libraries are installed in the subdirectory <code>build/lib</code> (or in whatever other directory you may have specified when asked to confirm their location) and the associated header files are copied to <code>build/include</code>. This is a sensible default for libraries that are only installed once and then never again tinkered with. Here the situation is slightly different: If you ever decide to add your own "user libraries" to <code>oomph-lib</code> (and you are encouraged to do so!), their header files will also be copied to <code>build/include</code>. If during code development, any of your header files contain syntax errors, the compiler will complain about the syntax errors in the copied file in <code>build/include</code> rather than the one in your source directory. This will encourage you to edit the copied file rather than the original &ndash; clearly a recipe for disaster! To avoid it we provide the configure option </p><pre class="fragment"> --enable-symbolic-links-for-headers
</pre><p>In this mode, the copies of the header files in <code>build/include</code> are replaced by symbolic links to the actual sources in <code>src</code> or <code>user_src</code>.</p>
<h3><a class="anchor" id="paranoia"></a>
PARANOIA</h3>
<p><code>oomph-lib</code> provides an extensive range of optional run-time self-tests. The self-tests issue diagnostic error messages if any inconsistencies are detected at run-time and then terminate the code execution (semi-)gracefully by throwing an exception which (if not caught) aborts. This allows backtracking of the call sequence in a debugger during code development. Obviously, the self-tests introduce a slight run-time overhead and are therefore only performed if the C++ code is compiled with a special compiler flag, <code>PARANOID</code>. For gcc (and most other compilers we know) this is done by passing the flag <code>-DPARANOID</code> to the C++ compiler. This is achieved by adding </p><div class="fragment"><div class="line">CXXFLAGS=<span class="stringliteral">&quot;-DPARANOID&quot;</span></div>
</div><!-- fragment --><p> to the configure options. As discussed, during code development, this is most useful if debugging is also enabled, so the combination </p><div class="fragment"><div class="line">CXXFLAGS=<span class="stringliteral">&quot;-g -DPARANOID&quot;</span></div>
</div><!-- fragment --><p> is common.</p>
<h3><a class="anchor" id="bounds"></a>
Range checking</h3>
<p>Most of the containers used in <code>oomph-lib</code> allow for optional (and very costly!) range checking which is enabled by specifying the C++ compiler flag <code>RANGE_CHECKING</code>. You are advised to recompile the code (yes, all of it!) if (and only if) you encounter some mysterious segmentation fault. Again, this is most useful if used together with debugging, </p><div class="fragment"><div class="line">CXXFLAGS=<span class="stringliteral">&quot;-g -DRANGE_CHECKING&quot;</span></div>
</div><!-- fragment --><p> (Without the <code>-g</code> flag you will only find out that an illegal index has been specified, not where this happened...)</p>
<hr  />
<h1><a class="anchor" id="nav"></a>
Finding your way through the distribution</h1>
<p>The <code>oomph-lib</code> distribution has several main sub-directories:</p>
<h2><a class="anchor" id="src"></a>
The src directory</h2>
<p>The <code>src</code> sub-directory contains the source code for the various sub-libraries that make up <code>oomph-lib</code>. The most important one is the <code>generic</code> library which is built from the sources in the sub-directory <code>src/generic</code>. This library defines the fundamental <code>oomph-lib</code> objects (nodes, elements, meshes, timesteppers, linear and nonlinear solvers, mesh-adaptation routines, etc.)</p>
<p>The other libraries (<code>poisson</code>, <code>navier-stokes</code>,...) define elements for the solution of specific systems of PDEs.</p>
<p>Finally, the <code>src/meshes</code> subdirectory contains several fully functional <code>Meshes</code> (and, where appropriate, the associated <code>Domains</code>) that are used in the demo codes. All <code>Meshes</code> in this directory are templated by the type of element they contain. Since the element type can only be specified in the driver codes, the meshes cannot be compiled into libraries &ndash; the sources are always included as header-like files. Our <a href="../../example_code_list/html/index.html">list of example codes</a> contains an <a href="../../poisson/two_d_poisson/html/index.html#precompile_mesh">example</a> that explains this in more detail.</p>
<h2><a class="anchor" id="ext_src"></a>
The external_src directory</h2>
<p>The <code>external_src</code> directory contains "frozen" versions of various external libraries (e.g. <br  />
 <a href="http://crd.lbl.gov/~xiaoye/SuperLU">SuperLU</a>). Inclusion of these libraries into the distribution facilitates the overall build process: You only have to download and install a single distribution. This is much easier than finding out (typically halfway through the install process), that library A depends on library B which invariably turns out to depend on library C, etc.) Often the sources in the <code>external_src</code> subdirectories are sub-sets of the full libraries. For instance, we only include the double precision sources for <a href="http://crd.lbl.gov/~xiaoye/SuperLU">SuperLU</a> as neither the complex nor the single-precision versions are required within <code>oomph-lib</code>.</p>
<h2><a class="anchor" id="ext_dist"></a>
The external_distributions directory</h2>
<p><code>oomph-lib</code> provides interfaces to various third-party libraries which have their own build machinery. Some of these libraries are built by default in the course of the oomph-lib installation, using tar files that are distributed with <code>oomph-lib</code>; others will only be built if the user places the relevant tar files into the approproriate location within the <code>oomph-lib</code> directory structure.</p>
<h3><a class="anchor" id="cgal"></a>
External distributions that are built by default</h3>
<p>By default <code>oomph-lib</code> builds CGAL, the Computational Geometry Algorithms Library, <a href="http://www.cgal.org">http://www.cgal.org</a>. This library requires three other libraries which we also install:</p><ul>
<li>The GNU Multiple Precision Arithmetic Library (GMP), <a href="https://gmplib.org">https://gmplib.org</a>.</li>
<li>The GNU MPFR Library <a href="http://www.mpfr.org">https://gmplib.org</a>.</li>
<li>The Boost library, <a href="http://www.boost.org">http://www.boost.org</a>.</li>
</ul>
<p>Note that the installation of these libraries is not quick. We therefore provide the option to (i) suppress their installation (in which case <code>oomph-lib</code> will employ a sub-optimal "locate_zeta" algorithm in its multi-domain algorithms) or to (ii) link against already existing installations of the libraries; see <a class="el" href="index.html#external_dist_cgal_etc">External (third-party) libraries whose tar files are distributed with oomph-lib</a> for details.</p>
<h3><a class="anchor" id="trilinos_hypre_external"></a>
External distributions that are not built by default</h3>
<p><code>oomph-lib</code> provides interfaces to various optional third-party libraries whose sources we deemed to be too big to be included in the <code>oomph-lib</code> distribution. If you wish to use these we expect you to install them yourself. To facilitate this task, we provide the option to let the <code>oomph-lib</code> build machinery perform the installation for you. If you place a copy of the tar file into the appropriate sub-directory in <code>external_distributions</code>, <code>oomph-lib</code> will build and install the library for you; see <a class="el" href="index.html#external_dist">External (third-party) libraries that are not distributed with oomph-lib</a> for details. (Note that <code>oomph-lib</code> is fully functional without these libraries &ndash; if the libraries are not available the build process ignores any <code>oomph-lib</code> code that depends on them.)</p>
<h2><a class="anchor" id="demo_drivers"></a>
The demo_drivers directory</h2>
<p>The <code>demo_drivers</code> directory contains a large number of demo codes. They are arranged in sub-directories, based on the type of the problem that is being solved. For instance, the <code>demo_drivers/poisson</code> subdirectory contains a number of demo problems involving the Poisson equation.</p>
<p>All sub-directories in <code>demo_drivers</code> contain shell scripts that validate the output from the demo codes by comparing the computed results against the reference results stored in the <code>validata</code> sub-directories. The comparison is performed with the <code>python</code> script <code>bin/fpdiff</code>.<code>py</code> which tolerates slight differences due to the unavoidable variations in roundoff error on different platforms and/or at different optimisation levels. The validation scripts can either be executed individually in each sub-directory or for all sub-directories by issuing the command <code>make</code> <code>check</code>.</p>
<p>If the self-test is run at the top-level, a summary of the self-tests is stored in <code>self_test/analyse_self_tests/validation</code>.<code>log</code> </p>
<h2><a class="anchor" id="doc"></a>
The doc directory</h2>
<p>The structure of the <code>doc</code> directory (approximately) mirrors that of <code>demo_drivers</code> and contains the source code for the <code>doxygen</code> - based detailed explanation of the demo codes. If <code>configure</code> locates a sufficiently up-to-date version of <code>doxygen</code> on your system, the entire <code>oomph-lib</code> documentation will be built locally and can be navigated from the homepage in <code>doc/html/index</code>.<code>html</code> &ndash; a copy of the <code>oomph-lib</code> homepage.</p>
<h2><a class="anchor" id="user"></a>
The user_src and user_drivers directories</h2>
<p>The <code>configure</code> script and the associated <code>Makefiles</code> that build and install the <code>oomph-lib</code> libraries and demo codes are generated by <a href="http://www.gnu.org/software/autoconf/">autoconf</a> and <a href="http://www.gnu.org/software/automake/">automake</a>. If these powerful tools are installed on your machine, you can include your own libraries and driver codes into the fully-automated <code>oomph-lib</code> build process. Store your code in suitably named sub-directories in <code>user_src</code> and <code>user_drivers</code>. See <a class="el" href="index.html#own">How to write your own code and link it against oomph-lib's library/libraries</a> for more details.</p>
<hr  />
<h1><a class="anchor" id="external"></a>
External (third-party) libraries</h1>
<p><code>oomph-lib</code> provides interfaces to a number of third-party libraries. Those libraries that are essential for <code>oomph-lib</code> are distributed with the library to ensure that the user does not have to install these separately. We also provide interfaces to a number of third-party libraries that are not distributed with <code>oomph-lib</code>, typically because they are too big and/or take (too?) long to build. <code>oomph-lib</code> will only build the interfaces to these libraries if they are available and their location is specified during the configuration stage (or if the appropriate tar file is dropped into the required directory in which case <code>oomph-lib's</code> build process will build and install the library for you). In the latter case, the compiler flags used to build <code>oomph-lib</code> will be passed directly to the third-party libraries, so you may wish to compile the libraries separately if you wish to specify different compiler flags, e.g. no debugging information.</p>
<h2><a class="anchor" id="external_src"></a>
External (third-party) libraries that are distributed with oomph-lib</h2>
<p><code>oomph-lib</code> provides local copies of the following third-party libraries:</p><ul>
<li><a href="http://netlib.org/blas">BLAS</a></li>
<li><a href="http://netlib.org/lapack">LAPACK</a></li>
<li><a href="http://crd.lbl.gov/~xiaoye/SuperLU">SuperLU</a></li>
<li><a href="http://www-users.cs.umn.edu/~karypis/metis/">METIS</a></li>
</ul>
<p>By default <code>oomph-lib</code> automatically builds and links against these.</p>
<h3><a class="anchor" id="blas"></a>
Specifying an existing, local copy of the blas library</h3>
<p>If a local, possibly optimised version of the <a href="http://netlib.org/blas">blas library</a> already exists on your machine you can force <code>oomph-lib</code> to link against it and avoid the compilation of <code>oomph-lib's</code> own copy.</p>
<p>If your local copy of the <a href="http://netlib.org/blas">blas library</a> is located at </p><div class="fragment"><div class="line">/home/mheil/local/lib/blas/blas.a</div>
</div><!-- fragment --><p> say, you can link against it by specifying the configure option </p><div class="fragment"><div class="line">--with-blas=/home/mheil/local/lib/blas/blas.a</div>
</div><!-- fragment --><h3><a class="anchor" id="lapack"></a>
Specifying an existing, local copy of the lapack library</h3>
<p>If a local, possibly optimised version of the <a href="http://netlib.org/lapack">lapack library</a> already exists on your machine you can force <code>oomph-lib</code> to link against it and avoid the compilation of <code>oomph-lib's</code> own copy.</p>
<p>For instance, if your local copy of the <a href="http://netlib.org/lapack">lapack library</a> is located at </p><div class="fragment"><div class="line">/home/mheil/local/lib/lapack/lapack.a</div>
</div><!-- fragment --><p> you can link against it by specifying the configure option </p><div class="fragment"><div class="line">--with-lapack=/home/mheil/local/lib/lapack/lapack.a</div>
</div><!-- fragment --><h2><a class="anchor" id="external_dist_cgal_etc"></a>
External (third-party) libraries whose tar files are distributed with oomph-lib</h2>
<p>By default <code>oomph-lib</code> builds CGAL, the Computational Geometry Algorithms Library, <a href="http://www.cgal.org">http://www.cgal.org</a>. This library requires three other libraries which we also install:</p><ul>
<li>The GNU Multiple Precision Arithmetic Library (GMP), <a href="https://gmplib.org">https://gmplib.org</a>.</li>
<li>The GNU MPFR Library <a href="http://www.mpfr.org">https://gmplib.org</a>.</li>
<li>The Boost library, <a href="http://www.boost.org">http://www.boost.org</a>.</li>
</ul>
<p>These four libraries are built from tar files that we downloaded from the relevant webpages and then included into the <code>oomph-lib</code> distribution. We adopted this procedure to ensure that the versions of the libraries are consistent with each other.</p>
<h3><a class="anchor" id="cgal_default_install"></a>
Default CGAL installation.</h3>
<p>By default the four libraries are installed within <code>oomph-lib's</code> <code>external_distributions</code> directory, and the paths to the relevant <code>lib</code> and <code>include</code> directories are propagated to <code>oomph-lib's</code> <code>Makefile</code> s. The installations are deleted by "make clean" or "make distclean", i.e. they are treated like any other <code>oomph-lib</code> code.</p>
<h3><a class="anchor" id="cgal_permanent_install"></a>
Installing CGAL in a permanent location</h3>
<p>Given that the installation of the libraries takes a fair amount of time, we also provide the option to install them in a permanent location outside the <code>oomph-lib</code> directory structure. This is done by specifying the configure flag: </p><div class="fragment"><div class="line">--with-cgal-permanent-installation-dir=ABSOLUTE_PATH_TO_PERMAMENT_INSTALL_DIRECTORY</div>
</div><!-- fragment --><p> where <code>ABSOLUTE_PATH_TO_PERMAMENT_INSTALL_DIRECTORY</code> specifies what it says. So, for instance, specifying </p><div class="fragment"><div class="line">--with-cgal-permanent-installation-dir=/home/mheil/junk_default_installation</div>
</div><!-- fragment --><p> installs the libraries in <code>/home/mheil/junk_default_installation</code>. In subsequent rebuilds of <code>oomph-lib</code> it is then possible to specify the location of these libraries using configure options. Following an <code>oomph-lib</code> installation with <code>&ndash;with-cgal-permanent-installation-dir</code> these configure options are displayed at the end of the <code>oomph-lib</code> build procedure. (They are also contained in the file <br  />
 <code>external_distributions/cgal_configure_flags.txt</code>.) For instance, if the libraries have been installed in <code>/home/mheil/junk_default_installation</code> the relevant, the configure options are: </p><div class="fragment"><div class="line">--with-boost=/home/mheil/junk_default_installation/boost_default_installation</div>
<div class="line">--with-gmp=/home/mheil/junk_default_installation/gmp_default_installation</div>
<div class="line">--with-mpfr=/home/mheil/junk_default_installation/mpfr_default_installation</div>
<div class="line">--with-cgal=/home/mheil/junk_default_installation/cgal_default_installation</div>
</div><!-- fragment --><p>hierher auto?</p>
<h3><a class="anchor" id="cgal_no_install"></a>
Suppressing the CGAL installation</h3>
<p>Finally, it is possible to suppress the installation of CGAL (and the related libraries) using the configure option </p><div class="fragment"><div class="line">--enable-suppress-cgal-build</div>
</div><!-- fragment --><p> In this case <code>oomph-lib</code> will employ a sub-optimal "locate_zeta" algorithm in its multi-domain algorithms.</p>
<h2><a class="anchor" id="external_dist"></a>
External (third-party) libraries that are not distributed with oomph-lib</h2>
<h3><a class="anchor" id="hypre"></a>
Hypre</h3>
<p><code>oomph-lib</code> provides wrappers to the powerful solvers and preconditioners from the <a href="https://computation.llnl.gov/casc/linear_solvers/sls_hypre.html">Scalable Linear Solvers Project</a>. The wrappers are only built if <code>Hypre</code> is available on your machine. If your local <br  />
 copy of the <code>Hypre</code> library installed in </p><div class="fragment"><div class="line">/home/mheil/local/hypre</div>
</div><!-- fragment --><p> i.e. if this directory contains <code>Hypre's</code> lib and include directories: </p><div class="fragment"><div class="line">biowulf:~ 10:44:22$ ll /home/mheil/local/hypre</div>
<div class="line">total 8</div>
<div class="line">drwxr-xr-x    2 mheil    users        4096 Nov  3  2007 include</div>
<div class="line">drwxr-xr-x    2 mheil    users        4096 Nov  3  2007 lib</div>
</div><!-- fragment --><p> you can get <code>oomph-lib</code> to link against it (and to compile <code>oomph-lib's</code> wrappers to <code>Hypre's</code> solvers and preconditioners) by specifying the configure option </p><div class="fragment"><div class="line">--with-hypre=/home/mheil/local/hypre</div>
</div><!-- fragment --><p><b>Note:</b> <code>oomph-lib</code> works with version 2.0.0 of the library. If this version of <code>Hypre</code> is not available on your machine download the tar file from the our own website:</p>
<center> <a href="../../../../oomph-lib_external_distfiles/hypre-2.0.0.tar.gz">hypre-2.0.0.tar.gz</a> </center><p>You can either build the library yourself or get <code>oomph-lib</code> to build it for you. To do this simply place a copy of the tar file into the directory </p><div class="fragment"><div class="line">external_distributions/hypre</div>
</div><!-- fragment --><p> and (re-)run <code>autogen.sh</code>. The installation procedure will detect the tar file, unpack it, and install the library in </p><div class="fragment"><div class="line">external_distributions/hypre/hypre_default_installation</div>
</div><!-- fragment --><p> Unless you explicitly specified a library location using the <code>&ndash;with-hypre</code> flag, <code>oomph-lib</code> will then link against this newly created version of the library. However, we strongly recommend moving the newly created library to another place (outside the <code>oomph-lib</code> distribution) to preserve it for future use. Once this is done you simply specify the (new) location of the library with the <code>&ndash;with-hypre</code> flag, as discussed above. (Also make sure to delete the tar file from <code>external_distributions/hypre</code>, otherwise the library will be re-built.) Note that <code>make</code> <code>clean</code> will delete the unpacked <code>Hypre</code> sources but not the tar file and the library itself.</p>
<h3><a class="anchor" id="trilinos"></a>
Trilinos</h3>
<p><code>oomph-lib</code> provides wrappers to the powerful solvers and preconditioners from the <a href="http://trilinos.sandia.gov/">Trilinos Project</a>. The wrappers are only built if <code>Trilinos</code> is available on your machine. If your local <br  />
 copy of the <code>Trilinos</code> library installed in </p><div class="fragment"><div class="line">/home/mheil/local/trilinos</div>
</div><!-- fragment --><p> i.e. if this directory contains <code>Trilinos's</code> lib and include directories: </p><div class="fragment"><div class="line">biowulf:~ 10:44:31$ ll /home/mheil/local/trilinos</div>
<div class="line">total 24</div>
<div class="line">drwxr-xr-x    2 mheil    users        4096 Dec 20 15:34 bin</div>
<div class="line">drwxr-xr-x    2 mheil    users       16384 Dec 20 15:35 include</div>
<div class="line">drwxr-xr-x    2 mheil    users        4096 Dec 20 15:35 lib</div>
</div><!-- fragment --><p> you can get <code>oomph-lib</code> to link against it (and to compile <code>oomph-lib's</code> wrappers to <code>Trilinos's</code> solvers and preconditioners) by specifying the configure option </p><div class="fragment"><div class="line">--with-trilinos=/home/mheil/local/trilinos</div>
</div><!-- fragment --><p><b>Note:</b> <code>oomph-lib</code> should work with major version numbers 9, 10 and 11 of the Trilinos library, and for revision numbers from 11 onwards you will need to have <code>cmake</code> installed on your machine. If these versions of <code>Trilinos</code> are not available on your machine you can get the latest version from the <a href="http://trilinos.sandia.gov/">Trilinos web site </a> or download a copy of the relevant tar file from our own website:</p>
<center> <a href="../../../../oomph-lib_external_distfiles/trilinos-11.8.1-Source.tar.gz">trilinos-11.8.1-Source.tar.gz</a> </center><p>You can either build the library yourself or get <code>oomph-lib</code> to build it for you. To do this simply place a copy of the tar file into the directory </p><div class="fragment"><div class="line">external_distributions/trilinos</div>
</div><!-- fragment --><p> and (re-)run <code>autogen.sh</code>. The build process is somewhat different for major version numbers 9 and 10, but oomph-lib will detect this automatically, provided that the source file is called trilinos-N.*.tar.gz, where N is the major version number. The installation procedure will then detect the tar file, unpack it, and install the library in </p><div class="fragment"><div class="line">external_distributions/trilinos/trilinos_default_installation</div>
</div><!-- fragment --><p> Unless you explicitly specified a library location using the <code>&ndash;with-trilinos</code> flag, <code>oomph-lib</code> will then link against this newly created version of the library. However, we strongly recommend moving the newly created library to another place (outside the <code>oomph-lib</code> distribution) to preserve it for future use. Once this is done you simply specify the (new) location of the library with the <code>&ndash;with-trilinos</code> flag, as discussed above. (Also make sure to delete the tar file from <code>external_distributions/trilinos</code>, otherwise the library will be re-built.) Note that <code>make</code> <code>clean</code> will delete the unpacked <code>Trilinos</code> sources but not the tar file and the library itself.</p>
<hr  />
<h3><a class="anchor" id="mumps"></a>
MUMPS and ScaLAPACK</h3>
<p><code>oomph-lib</code> also provides wrappers to the <a href="http://graal.ens-lyon.fr/MUMPS/">MUMPS </a> multifrontal solver, if it is available on your system. <code>MUMPS</code> needs the linear algebra library <a href="http://www.netlib.org/scalapack/">ScaLAPACK </a> which must also be installed on your system. The configure options </p><div class="fragment"><div class="line">--with-mumps=/opt/mumps</div>
<div class="line">--with-scalapack=/opt/scalapack</div>
</div><!-- fragment --><p> will compile <code>oomph-lib's</code> wrappers and link against the <code>MUMPS</code> solver provided that <code>MUMPS</code> and ScaLAPACK  are installed in the directories </p><div class="fragment"><div class="line">/opt/mumps</div>
<div class="line">/opt/scalapack</div>
</div><!-- fragment --><p> i.e. these directories contain the <code>lib</code> and <code>include</code> directories that result from successful installations of <code>MUMPS</code> and <code>ScaLAPACK</code>, respectively.</p>
<p>If you do not have <code>MUMPS</code> available you can download the latest version <a href="http://graal.ens-lyon.fr/MUMPS/index.php?page=dwnld">here. </a> You can build and install the library yourself, or get <code>oomph-lib</code> to build it during part of its own build process. Simply place a copy of the tar file <code>MUMPS_4.10.0.tar.gz</code> in the directory </p><div class="fragment"><div class="line">external_distributions/mumps_and_scalapack</div>
</div><!-- fragment --><p> You will also need to download the <code>scalapack_installer.tgz</code> from <a href="http://www.netlib.org/scalapack/#_scalapack_installer_for_linux">here, </a> and place a copy in the same directory </p><div class="fragment"><div class="line">external_distributions/mumps_and_scalapack</div>
</div><!-- fragment --><p>You can also download both files from our own website: </p><center> <a href="../../../../oomph-lib_external_distfiles/MUMPS_4.10.0.tar.gz">MUMPS_4.10.0.tar.gz</a> </center> <center> <a href="../../../../oomph-lib_external_distfiles/scalapack_installer.tgz">scalapack_installer.tgz</a> </center><p>Note that the configure option </p><div class="fragment"><div class="line">--with-mpi-include-<a class="code" href="the__distribution_8txt.html#ad3083ce9e1c95654db5f3fef75b58f52">directory</a>=/usr/lib/openmpi/include</div>
</div><!-- fragment --><p> <b> must </b> be specified in order to build <code>MUMPS</code>, where <code>/usr/lib/openmpi/include</code> is the directory that contains the file <code>mpi.h</code>. [You can use <code>locate mpi.h</code>, to, well, locate that directory.]</p>
<p>Once the files have been placed in the <code>external_distributions/mumps_and_scalapack</code> directory, simply (re-)run <code>autogen.sh</code>, which will detect and build the libraries and install then in directory </p><div class="fragment"><div class="line">external_distributions/mumps_and_scalapack/mumps_and_scalapack_default_installation</div>
</div><!-- fragment --><p>Note that the installation of <code>ScaLAPACK</code> requires an active Internet connection because it automatically downloads additional files.</p>
<p>Unless you explicitly specified a library location using the <code>&ndash;with-mumps</code> and <code>&ndash;with-scalapack</code> flags, <code>oomph-lib</code> will then link against the newly created versions of the libraries. However, we strongly recommend moving the libraries outside the <code>oomph-lib</code> distribution to preserve them for future use. Once this is done you simply specify the (new) location of the library with the <code>&ndash;with-mumps</code> and <code>&ndash;with-scalapack</code> flags, as discussed above. (Also make sure to delete the tar files from <code>external_distributions/mumps_and_scalapack</code>, otherwise the libraries will be built again.) Note that <code>make</code> <code>clean</code> will delete the unpacked sources but not the tar files nor the installed libraries.</p>
<hr  />
<h1><a class="anchor" id="own"></a>
How to write your own code and link it against oomph-lib's library/libraries</h1>
<p>If you followed the instructions so far, you will be able to install <code>oomph-lib</code> and run the demo codes that are provided in the <code>demo_drivers</code> directory. Great! Now on to the next step: How do you write your own codes and link them against <code>oomph-lib</code>? There are two options, depending on whether you have (or are willing to install) the gnu autotools <a href="http://www.gnu.org/software/autoconf/">autoconf</a>, <a href="http://www.gnu.org/software/automake/">automake</a> and <a href="http://www.gnu.org/software/libtool/">libtool</a> on your machine.</p>
<h2><a class="anchor" id="have_auto_tools"></a>
Writing/linking your own driver codes under autotools control</h2>
<h3><a class="anchor" id="add_driver"></a>
Adding your own driver codes</h3>
<p>Let's start with the straightforward case: You want to use <code>oomph-lib</code> to solve one of your own problems. To do this within <code>oomph-lib's</code> autotools framework, simply create a new directory in <code>user_drivers</code> and write your driver code. To facilitate these steps, the <code>user_drivers</code> directory already contains a sample directory <code>joe_cool</code> for which all these steps have been performed. If you don't object to the directory name (or if your name is Joe Cool) you can simply work in that directory. If not, we suggest the following sequence of steps:</p><ol type="1">
<li>Go to the <code>user_drivers</code> directory and create a new directory, e.g. <div class="fragment"><div class="line">cd user_drivers</div>
<div class="line">mkdir josephine_cool</div>
</div><!-- fragment --></li>
<li>Copy the <code>Makefile.am</code> and the driver code <code>joes_poisson_code.cc</code> from <code>user_drivers/joe_cool</code> to <code>user_drivers/josephine_cool</code>.</li>
<li>Return to <code>oomph-lib's</code> top-level directory and re-run <code>./autogen.sh</code> to generate the required Makefile etc. in your own directory.</li>
<li>You may now return to your own directory in <code>user_drivers</code> and make your own driver code: <div class="fragment"><div class="line">cd user_drivers/josephine_cool</div>
<div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a></div>
</div><!-- fragment --> This will create the required executable. <br  />
<br  />
</li>
<li>Unfortunately, the driver code (copied from Joe Cool's directory!) is unlikely to be the one you want but you can now rename it, edit it, or add further driver codes to your directory. In general we suggest that you have a look at the <a href="../../example_code_list/html/index.html">list of example codes</a> and try to identify a problem that is similar to the one you want to solve. The associated driver code will be a good starting point for your own. Note that whenever you add new driver codes or rename existing ones you will have to update the local <code>Makefile</code>.<code>am</code>, though it is not necessary to re-run <code>autogen</code>.<code>sh</code>. The sample <code>Makefile</code>.<code>am</code> copied from Joe Cool's directory is well annotated and gives clear instructions how to adapt its contents: <br  />
<br  />
<div class="fragment"><div class="line"># Name of executables: The prefix &quot;noinst&quot; means the executables don&#39;t</div>
<div class="line"># have to be installed anywhere.</div>
<div class="line">noinst_PROGRAMS= joes_poisson_code</div>
<div class="line"> </div>
<div class="line">#---------------------------------------------------------------------------</div>
<div class="line"> </div>
<div class="line"># Local sources that Joe&#39;s Poisson code depends on:</div>
<div class="line">joes_poisson_code_SOURCES = joes_poisson_code.cc</div>
<div class="line"> </div>
<div class="line"># Required libraries: Only the &quot;generic&quot; and &quot;poisson&quot; libraries, </div>
<div class="line"># which are accessible via the general library directory which </div>
<div class="line"># we specify with -L. The generic sources also require the &quot;external&quot; libraries</div>
<div class="line"># that are shipped with oomph-lib. The Fortran libraries, $(FLIBS), get </div>
<div class="line"># included just in case we decide to use a solver that involves Fortran </div>
<div class="line"># sources. </div>
<div class="line"># NOTE: The order in which libraries are specified is important! </div>
<div class="line">#       The most specific ones (that might involve references to other</div>
<div class="line">#       libraries) need to be listed first, the more basic ones </div>
<div class="line">#       later. In this example we have (from right to left, i.e. from</div>
<div class="line">#       general to specific):</div>
<div class="line">#       -- The fortran libraries: They  are compiler specific and</div>
<div class="line">#          obviously can&#39;t depend on any code that we (or others)</div>
<div class="line">#          have written. $(FLIBS) is a variable that automake will translate</div>
<div class="line">#          to the actual fortran libraries.</div>
<div class="line">#       -- The external (third party) libraries: They cannot depend on </div>
<div class="line">#          any of our code. The variable $(EXTERNAL_LIBS) is defined</div>
<div class="line">#          in the machine-generated file configure.ac in oomph-lib&#39;s </div>
<div class="line">#          home directory. </div>
<div class="line">#       -- Oomph-lib&#39;s generic library contains oomph-lib&#39;s fundamental </div>
<div class="line">#          objects which do not depend on any specific system of PDEs </div>
<div class="line">#          or element types.</div>
<div class="line">#       -- Finally, oomph-lib&#39;s poisson library contains oomph-lib&#39;s </div>
<div class="line">#          Poisson elements which refer to objects from the generic</div>
<div class="line">#          library. </div>
<div class="line">joes_poisson_code_LDADD = -L@libdir@ -lpoisson -lgeneric $(EXTERNAL_LIBS) $(FLIBS)</div>
<div class="line"> </div>
<div class="line">#---------------------------------------------------------------------------</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Include path for library headers: All library headers live in </div>
<div class="line"># the include directory which we specify with -I</div>
<div class="line"># Automake will replace the variable @includedir@ with the actual</div>
<div class="line"># include directory.</div>
<div class="line">AM_CPPFLAGS += -I@includedir@  </div>
</div><!-- fragment --> <br  />
<br  />
 Note the following points: <br  />
<br  />
<ul>
<li>Lines that start with a "#" are comments. <br  />
<br  />
</li>
<li>The first (non-comment) line in the above file specifies the name(s) of the executable(s) that will be created by make. These names must be the same as those in the <code>*_SOURCES</code> and <code>*_LDADD</code> variables. <br  />
<br  />
</li>
<li>The <code>joes_poisson_code_SOURCES</code> variable declares which (local) sources your executable depends on. In the current example there is only a single file, the driver code, <code>joes_poisson_code</code>. <code>cc</code>, itself. <br  />
<br  />
</li>
<li>The <code>joes_poisson_code_LDADD</code> variable declares:<ul>
<li>the location of the library directory (automake will convert the macro <code>-L@libdir@</code> into the actual directory &ndash; you don't have to change this!).</li>
<li>the libraries (<code>oomph-lib</code> or otherwise) that you wish to link against. This is done with the usual <code>-l</code> flag that you will be familiar with from your compiler. Have a look at the comments regarding the order of the libraries! <br  />
<br  />
</li>
</ul>
</li>
<li>The <code>INCLUDES</code> variable specifies where to find the include header files. This line is again completely generic &ndash; automake will convert the macro <code>-I@includedir@</code> into the actual location. <br  />
<br  />
</li>
<li>If you have multiple driver codes, add the name of all executables to the <code>noinst_PROGRAMS</code> variable, and specify the <code>*_SOURCES</code> and <code>*_LDADD</code> variables for each one. <br  />
<br  />
</li>
<li>The <code>INCLUDES</code> variable should only be specified once.</li>
</ul>
</li>
</ol>
<h3><a class="anchor" id="add_src"></a>
Adding new libraries and linking against them from driver codes</h3>
<p>The above instructions should be sufficient to get you started. You can create multiple sub-directories for different projects and each sub-directory may, of course, contain multiple files, separated into header and source files. <code>automake</code> will ensure that only those files that have been changed will be recompiled when you issue the <code>make</code> command. However, at some point you may wish to package some of your sources into your own library and maybe even offer it for permanent inclusion into <code>oomph-lib</code>. For this purpose the <code>oomph-lib</code> distribution provides the sub-directory <code>user_src</code> which closely mirrors that of the <code>src</code> and <code>external_src</code> directories discussed earlier. During the build process, each sub-directory in <code>user_src</code> is compiled into its own library and installed in the standard location.</p>
<p>The steps required to include your own library into the <code>oomph-lib</code> build process are very similar to those required to add additional user drivers. As before, the <code>user_src</code> directory already contains a sample directory <code>jack_cool</code>, to facilitate the procedure. We therefore suggest the following sequence of steps:</p><ol type="1">
<li>Go to the <code>user_src</code> directory and create a new directory, e.g. <div class="fragment"><div class="line">cd user_src</div>
<div class="line">mkdir jacqueline_cool</div>
</div><!-- fragment --> <br  />
<br  />
</li>
<li>Copy the <code>Makefile.am</code> and the codes <code>hello_world.cc</code> and <code>hello_world.h</code> from <code>user_src/jack_cool</code> to <code>user_src/jacqueline_cool</code>. <br  />
<br  />
</li>
<li>Return to the top-level <code>oomph-lib</code> directory and re-run <code>autogen.sh</code>.</li>
<li>You may now return to your own directory in <code>user_src</code> and make and install our own library <div class="fragment"><div class="line">cd user_src/jacqueline_cool</div>
<div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a></div>
<div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a> <a class="code" href="the__distribution_8txt.html#a450df5a275b46b68f1cc00515f04aefa">install</a></div>
</div><!-- fragment --> This will create the library and install it in <code>build/lib</code> <br  />
<br  />
 The <code>Makefile</code>.<code>am</code> for libraries is slightly more complicated (though reasonably well documented) so &ndash; for now &ndash; we'll just list it here and hope that the changes required to include additional sources are obvious. If you really can't figure it out, send us an email and prompt us to complete this bit of the documentation.... <br  />
<br  />
<div class="fragment"><div class="line"># A few file definitions</div>
<div class="line">#-----------------------</div>
<div class="line"> </div>
<div class="line"># Define the sources</div>
<div class="line">sources =  \</div>
<div class="line">hello_world.cc</div>
<div class="line"> </div>
<div class="line"># Define the headers</div>
<div class="line">headers =  \</div>
<div class="line">hello_world.h</div>
<div class="line"> </div>
<div class="line"># Define name of library</div>
<div class="line">libname = jack_cool</div>
<div class="line"> </div>
<div class="line"># Combine headers and sources</div>
<div class="line">headers_and_sources = $(headers) $(sources)</div>
<div class="line"> </div>
<div class="line"># Define the library that gets placed in lib directory</div>
<div class="line">#-----------------------------------------------------</div>
<div class="line">lib_LTLIBRARIES = libjack_cool.la</div>
<div class="line"> </div>
<div class="line"># Sources that the library depends on: </div>
<div class="line">#-------------------------------------</div>
<div class="line">libjack_cool_la_SOURCES = $(headers_and_sources)</div>
<div class="line"> </div>
<div class="line"># The library&#39;s include headers:</div>
<div class="line">#-------------------------------</div>
<div class="line"># Headers that are to be included in the $(includedir) directory:</div>
<div class="line"># This is the combined header which contains &quot;#include&lt;...&gt;&quot; commands</div>
<div class="line"># for the real headers in the subdirectory below $(includedir)</div>
<div class="line">include_HEADERS = $(libname).h </div>
<div class="line"> </div>
<div class="line">#Here&#39;s the subdirectory where the actual header files are placed</div>
<div class="line">library_includedir=$(includedir)/jack_cool</div>
<div class="line"> </div>
<div class="line">#These are the header files that are to be placed in subdirectory</div>
<div class="line">library_include_HEADERS=$(headers) </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Required libraries -- [assuming that we want to link against stuff in generic</div>
<div class="line">#-------------------     add other oomph-lib libraries if you need them....]</div>
<div class="line"># Include path for library headers -- need to refer to include files</div>
<div class="line"># in their respective source directories as they will not have been </div>
<div class="line"># installed yet! </div>
<div class="line">AM_CPPFLAGS += -I$(top_builddir)/src/generic</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Combined header file</div>
<div class="line">#---------------------</div>
<div class="line"># Rule for building combined header (dummy target never gets made so</div>
<div class="line"># the combined header is remade every time)</div>
<div class="line">$(libname).h: dummy_$(libname).h</div>
<div class="line"> </div>
<div class="line">dummy_$(libname).h:  $(headers)</div>
<div class="line">        echo  $(libname) $(headers) &gt; all_$(libname).aux</div>
<div class="line">        $(AWK) -f $(top_builddir)/bin/headers.awk &lt; \</div>
<div class="line">               all_$(libname).aux &gt; $(libname).h</div>
<div class="line">        rm all_$(libname).aux</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Extra hook for install: Optionally replace headers by symbolic links</div>
<div class="line">#---------------------------------------------------------------------</div>
<div class="line">if SYMBOLIC_LINKS_FOR_HEADERS</div>
<div class="line">install-data-hook: </div>
<div class="line">        (cd $(library_includedir) &amp;&amp; rm -f $(headers) )</div>
<div class="line">        (echo &quot;$(headers)&quot; &gt; include_files.list )</div>
<div class="line">        ($(top_builddir)/bin/change_headers_to_links.sh `pwd`)</div>
<div class="line">        ($(LN_S) `cat include_files.list.aux` $(library_includedir) )</div>
<div class="line">        (rm -r include_files.list.aux include_files.list ) </div>
<div class="line">else</div>
<div class="line">install-data-hook: </div>
<div class="line">endif</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Tidy up</div>
<div class="line">#--------</div>
<div class="line">clean-local:</div>
<div class="line">        rm -f $(libname).h</div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --></li>
</ol>
<p>Note that the directory <code>user_drivers/jack_cool</code> contains an example of a user driver code (<code>jacks_own_code</code> <code></code>.cc) that uses a user library.</p>
<h2><a class="anchor" id="dont_have_auto_tools"></a>
Writing/linking user code without autotools</h2>
<p>Linking directly against <code>oomph-lib's</code> (sub-)libraries is slightly complicated by cross-compilation issues arising from the fact that the <code>oomph-lib</code> distribution includes a few C and Fortran sources. When linking is done (by the C++ compiler) one usually has to explicitly specify a few compiler-specific Fortran libraries. The beauty of the <code>autotools</code> approach described above is that these libraries (and any other flags that need to be passed to the compiler/linker) are determined and specified automatically. Doing this manually is no fun! Have a look at Mike Gerdts's excellent document <a href="https://sites.google.com/site/mgerdts/whatgccreallydoes">"How gcc really works"</a> for details.</p>
<p>The good news is that <code>oomph-lib's</code> installation procedure automatically generates a sample <code>Makefile</code> that contains all the relevant information. Once the installation is complete, the sample makefile is located at </p><div class="fragment"><div class="line">demo_drivers/linking/makefile.sample</div>
</div><!-- fragment --><p> Here is the version that was generated one of our machines:</p>
<div class="fragment"><div class="line">###############################################################</div>
<div class="line"># Automatically-generated sample makefile to illustrate how to  </div>
<div class="line"># link against oomph-lib from outside the automake/autoconf</div>
<div class="line"># framework. Do not edit this -- make a copy first</div>
<div class="line"># </div>
<div class="line"># When customising this makefile, you should only have to change</div>
<div class="line"># </div>
<div class="line"># - the variable OOMPH-LIB_LIBS:</div>
<div class="line">#         Add any additional oomph-lib sub-libraries that </div>
<div class="line">#         you may wish to use in your code. </div>
<div class="line"># </div>
<div class="line"># - the specific dependencies for your driver code: </div>
<div class="line">#         Include any additional local dependencies such as </div>
<div class="line">#         your own header files etc.</div>
<div class="line"># </div>
<div class="line">###############################################################</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Installation-specific information -- don&#39;t change any of this! </div>
<div class="line">#-------------------------------------------------------------- </div>
<div class="line"> </div>
<div class="line"># Flags for C pre-processor </div>
<div class="line">AM_CPPFLAGS=-DHAVE_CONFIG_H -I. -I../..  -DOOMPH_HAS_MPI -I/home/mheil/version_for_release/build/include</div>
<div class="line"> </div>
<div class="line"># Library include directory: This is where all the header files live</div>
<div class="line">OOMPH-LIB_INCLUDE_DIR=/home/mheil/version_for_release/build/include</div>
<div class="line"> </div>
<div class="line"># Library directory: This is where all of oomph-lib&#39;s sub-libraries live</div>
<div class="line">OOMPH-LIB_LIB_DIR=/home/mheil/version_for_release/build/lib</div>
<div class="line"> </div>
<div class="line"># These are the external (3rd party) libraries that are distributed</div>
<div class="line"># with oomph-lib and that we always link against</div>
<div class="line">OOMPH-LIB_EXTERNAL_LIBS=-loomph_hsl -loomph_superlu_3.0 -loomph_metis_4.0 -loomph_arpack -loomph_superlu_dist_2.0 /home/mheil/local/lib/lapack/lapack.a /home/mheil/local/lib/blas/blas.a</div>
<div class="line"> </div>
<div class="line"># This specifies where libraries built from third party </div>
<div class="line"># distributions can be found</div>
<div class="line">EXTERNAL_DIST_LIBRARIES=</div>
<div class="line"> </div>
<div class="line"># This is additional machine-specific linking information that </div>
<div class="line"># allows mixed-language compilation/linking</div>
<div class="line">FLIBS=-L/usr/lib/lam/lib -L/usr/lib/gcc/i486-linux-gnu/4.3.3 -L/usr/lib/gcc/i486-linux-gnu/4.3.3/../../../../lib -L/lib/../lib -L/usr/lib/../lib -L/usr/lib/gcc/i486-linux-gnu/4.3.3/../../.. -llammpio -llamf77mpi -lmpi -llam -lutil -ldl -lgfortranbegin -lgfortran -lm -lpthread</div>
<div class="line"> </div>
<div class="line"># Flags required for the use of shared libraries </div>
<div class="line">SHARED_LIBRARY_FLAGS=-Wl,--rpath -Wl,/home/mheil/version_for_release/build/lib</div>
<div class="line"> </div>
<div class="line">#Mac OSX: Replace the above line with the following</div>
<div class="line">#SHARED_LIBRARY_FLAGS= --rpath=/home/mheil/version_for_release/build/lib</div>
<div class="line"># Problem-specific information -- edit this for your driver code </div>
<div class="line"> </div>
<div class="line">#---------------------------------------------------------------</div>
<div class="line"># These are the specific oomph-lib sub-libraries that we have to link against</div>
<div class="line"># for this driver code -- edit this according to your requirements</div>
<div class="line"># but remember that the order of the libraries matters: List the</div>
<div class="line"># the more specific ones before the more general ones!</div>
<div class="line">OOMPH-LIB_LIBS=-lpoisson -lgeneric</div>
<div class="line"> </div>
<div class="line"># Dependencies for this driver code and compile instructions: </div>
<div class="line"># Which local source (usually *.cc or *.h) files does the</div>
<div class="line"># driver code depend on?</div>
<div class="line">my_demo_code.o: demo_code.cc</div>
<div class="line">         mpic++ $(AM_CPPFLAGS) -c demo_code.cc -o my_demo_code.o \</div>
<div class="line">               -I$(OOMPH-LIB_INCLUDE_DIR)  </div>
<div class="line"> </div>
<div class="line"># Linking instructions: Just declare the target (i.e. the name of the executable)</div>
<div class="line"># and the dependencies (i.e. the object files created above). The rest </div>
<div class="line"># should not have to be changed. </div>
<div class="line">my_demo_code: my_demo_code.o</div>
<div class="line">         mpic++ $(SHARED_LIBRARY_FLAGS) $&lt; -o $@ \</div>
<div class="line">               -L$(OOMPH-LIB_LIB_DIR) $(EXTERNAL_DIST_LIBRARIES) $(OOMPH-LIB_LIBS) \</div>
<div class="line">                $(OOMPH-LIB_EXTERNAL_LIBS) $(FLIBS)</div>
</div><!-- fragment --><p>The version that is generated during the build process on your machine provides template for your own customised Makefiles. When modifying the sample to different driver codes, you should not (have to) edit any of the "installation specific" variables. Simply specify the <code>oomph-lib</code> (sub-)libraries that you wish to link against in the <code>OOMPH_LIB-LIBS</code> variable (in the example shown above, we are linking against the <code>generic</code> and <code>poisson</code> libraries), and specify the dependencies for your own driver code, following the usual <code>Makefile</code> syntax. The executable may then be created by the usual </p><div class="fragment"><div class="line"><a class="code" href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a> -f makefile.sample my_demo_code</div>
</div><!-- fragment --><p><a class="anchor" id="apple_linking"></a> <b>Note/Disclaimer:</b> The sample <code>Makefile</code> generated during <code>oomph-lib's</code> installation should work for most (if not all) linux machines, though it may require slight tweaks for Darwin (the BSD-derived UNIX core of Apple's OSX operating system). Problems are most likely to arise from the <code>SHARED_LIBRARY_FLAGS</code> variable. As mentioned in the comment in the sample <code>Makefile</code>, on such machines the fragment <code>-Wl,&ndash;rpath -Wl,</code> should be deleted from the <code>SHARED_LIBRARY_FLAGS</code> variable.</p>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
<div class="ttc" id="athe__distribution_8txt_html_ae663bd6cf76ba6ed02e28b120477cf7c"><div class="ttname"><a href="the__distribution_8txt.html#ae663bd6cf76ba6ed02e28b120477cf7c">check</a></div><div class="ttdeci">c make c check</div><div class="ttdef"><b>Definition:</b> <a href="the__distribution_8txt_source.html#l00151">the_distribution.txt:151</a></div></div>
<div class="ttc" id="athe__distribution_8txt_html_ad3083ce9e1c95654db5f3fef75b58f52"><div class="ttname"><a href="the__distribution_8txt.html#ad3083ce9e1c95654db5f3fef75b58f52">directory</a></div><div class="ttdeci">&lt;/script &gt;&lt;/p &gt; endhtmlonly See the&lt; a href=&quot;../../change_log/html/index.html&quot;&gt; change log page&lt;/a &gt; for an overview of the changes made since the previous release&lt;/p &gt; section instructions The download install step by step&lt; HR &gt;&lt; HR &gt; section download Get the distribution subsection tar_file you can specify where the distribution is placed By default subversion will place it into a directory called&lt; code &gt; trunk&lt;/code &gt;&lt; HR &gt; section install Install the distribution subsection standard_install e g to verify that the default build directory(&lt; code &gt;build&lt;/code &gt;, relative to the oomph-lib home directory) is appropriate before starting the build. By default</div></div>
<div class="ttc" id="athe__distribution_8txt_html_a450df5a275b46b68f1cc00515f04aefa"><div class="ttname"><a href="the__distribution_8txt.html#a450df5a275b46b68f1cc00515f04aefa">install</a></div><div class="ttdeci">c make c install</div><div class="ttdef"><b>Definition:</b> <a href="the__distribution_8txt_source.html#l00151">the_distribution.txt:151</a></div></div>
<div class="ttc" id="athe__distribution_8txt_html_ae0e613792058a55170dfbb1e9e4831ec"><div class="ttname"><a href="the__distribution_8txt.html#ae0e613792058a55170dfbb1e9e4831ec">make</a></div><div class="ttdeci">c make</div><div class="ttdef"><b>Definition:</b> <a href="the__distribution_8txt_source.html#l00150">the_distribution.txt:150</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 6 2021 23:33:54
        </div>
      </div>
    </footer>
</body>
</html>

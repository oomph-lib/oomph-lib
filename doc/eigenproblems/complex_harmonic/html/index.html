<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Demo problem: A one-dimensional eigenproblem with complex eigenvalues</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.2 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Demo problem: A one-dimensional eigenproblem with complex eigenvalues </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >In this document, we demonstrate how to solve a 1D eigenproblem (eigenvalues of the shifted 1D Laplace operator in a bounded domain) by creating custom elements. The tutorial is related to the <a href="../../harmonic/html/index.html">harmonic eigenproblem </a>, which you should read first. The fundamental difference in this case, is that we treat the eigenproblem as two coupled first-order equations which ensures that many of the eigenvalues are complex. </p><center> <table class="doxtable">
<tr>
<td><center> <b>One-dimensional model eigenvalue problem with complex eigenvalues</b> </center> Solve <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial u}{\partial x} = (\lambda - \mu) w, \quad \frac{\partial w}{\partial x} = \lambda u \ \ \ \ \ \ \ \ \ \ (1) \]" src="form_0.png" width="208" height="28"/>
</p>
 in the domain <img class="formulaInl" alt="$D =\left\{ x_1 \in [0,1] \right\}$" src="form_1.png" width="93" height="14"/>, with homogeneous Dirichlet boundary conditions <p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left. u\right|_{\partial D}=0. \ \ \ \ \ \ \ \ \ \ (2) \]" src="form_2.png" width="109" height="14"/>
</p>
   </td></tr>
</table>
<br  />
 </center><p >We shall treat <img class="formulaInl" alt="$ \lambda$" src="form_3.png" width="8" height="10"/> as an eigenvalue (unknown), but the other parameter <img class="formulaInl" alt="$ \mu $" src="form_4.png" width="9" height="9"/> is a <b>shift</b>, which is used to modify the spectrum of the operator. The two first-order equations may be combined into a single second-order equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial^{2} u}{\partial x^{2}} = (\lambda - \mu) \frac{\partial w}{\partial x} = (\lambda - \mu) \lambda u \quad \Rightarrow\quad \frac{\partial^{2} u}{\partial x^{2}} + (\mu - \lambda) \lambda u = 0, \]" src="form_5.png" width="331" height="29"/>
</p>
<p> which is exactly the same equation as the <a href="../../harmonic/html/index.html">harmonic eigenproblem </a>, but with a redefinition of the eigenvalues. Hence, the exact solutions are given by the countably infinite set: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ u_{n} = \sin (\Lambda_{n} x_{1}), \ \ \ \ \ \ \ \Lambda_{n} = n \pi = \sqrt{\lambda_{n}(\mu - \lambda_{n})}, \]" src="form_6.png" width="259" height="16"/>
</p>
<p> which yields </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \lambda_{n} = \frac{\mu}{2} \pm \sqrt{\mu^{2}/4 - n^{2}\pi^{2}}. \ \ \ \ \ \ \ \ \ \ (3) \]" src="form_7.png" width="196" height="24"/>
</p>
<p> If the shift <img class="formulaInl" alt="$\mu = 0$" src="form_8.png" width="31" height="11"/>, then the eigenvalues are all imaginary and consist of the complex conjugate pairs given by <img class="formulaInl" alt="$ \lambda{n} = \pm n \pi\, \mbox{i} $" src="form_9.png" width="61" height="10"/>.</p>
<p >If <img class="formulaInl" alt="$ \mu^{2}/4 &gt; \pi^{2}$" src="form_10.png" width="55" height="15"/> <img class="formulaInl" alt="$ \Rightarrow $" src="form_11.png" width="13" height="9"/> <img class="formulaInl" alt="$ \mu &gt; 2\pi $" src="form_12.png" width="39" height="11"/>, then the first complex conjugate pair of imaginary eigenvalues becomes two distinct real eigenvalues because the term under the square root in (3) becomes positive. As <img class="formulaInl" alt="$ \mu $" src="form_4.png" width="9" height="9"/> increases further subsequent complex eigenvalues merge to be real. Thus, we can control the spectrum by modifying the parameter <img class="formulaInl" alt="$ \mu $" src="form_4.png" width="9" height="9"/>.</p>
<p >We now provide a detailed discussion of the driver code <a href="../../../../demo_drivers/eigenproblems/harmonic/complex_harmonic.cc">complex_harmonic.cc</a> which solves the problem for the first four eigenvalues, when <img class="formulaInl" alt="$ \mu = 6.5 &gt; 2\pi. $" src="form_13.png" width="74" height="11"/></p>
<hr  />
 <hr  />
<h1><a class="anchor" id="theory"></a>
Overview of the theory</h1>
<h2><a class="anchor" id="weak"></a>
Weak formulation of the problem</h2>
<p >If we wish to solve the problem (1) using finite elements, we simply multiply each equation by a test function, but do not integrate by parts. We shall use the same test functions for each variable and thus our governing equations become </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{D} \frac{\partial u}{\partial x} \phi^{(test)} \,\mbox{d} x = (\lambda -\mu) \int_{D} w\, \phi^{(test)}\,\mbox{d} x, \quad\quad \int_{D} \frac{\partial w}{\partial x} \phi^{(test)} \,\mbox{d} x = \lambda \int_{D} u\, \phi^{(test)}\,\mbox{d} x, \quad \]" src="form_14.png" width="438" height="30"/>
</p>
<p >If we expand <img class="formulaInl" alt="$ u(x) = U_{j} \psi_{j}(x) $" src="form_15.png" width="85" height="14"/> and <img class="formulaInl" alt="$ w(x) = W_{j} \psi_{j}(x) $" src="form_16.png" width="90" height="14"/> in terms of known basis functions <img class="formulaInl" alt="$ \psi_{j} $" src="form_17.png" width="14" height="14"/> and use the same basis functions as our test functions (Galerkin method), then the weak form becomes </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_{D} \frac{\partial \psi_{j}}{\partial x} \psi_{i} \,\mbox{d} x U_{j} = (\lambda - \mu) \int_{D} \psi_{i} \psi_{j}\,\mbox{d} x W_{j},\quad\quad \int_{D} \frac{\partial \psi_{j}}{\partial x} \psi_{i} \,\mbox{d} x W_{j} = \lambda \int_{D} \psi_{i} \psi_{j}\,\mbox{d} x U_{j}. \]" src="form_18.png" width="433" height="30"/>
</p>
<p> Thus, in order to form the discrete eigenproblem <img class="formulaInl" alt="$ J_{ij} v_{j} = \lambda M_{ij} v_{j} $" src="form_19.png" width="81" height="14"/>, we choose to order the unknowns in the form <img class="formulaInl" alt="$ v = [ U | W ]^{T} $" src="form_20.png" width="65" height="15"/>, leading to the block Jacobian and mass matrices </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ J = \left[\begin{array}{c|c} 0 &amp; A \\\hline A &amp; \mu B \end{array}\right],\quad M = \left[\begin{array}{c|c} B &amp; 0 \\\hline 0 &amp; B \end{array}\right], \]" src="form_21.png" width="204" height="33"/>
</p>
<p> where </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ A_{ij} = \int_{D} \frac{\partial \psi_{j}}{\partial x} \psi_{i} \,\mbox{d} x , \quad\quad B_{ij} = \int_{D} \psi_{i} \psi_{j}\,\mbox{d} x. \]" src="form_22.png" width="234" height="30"/>
</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="impl"></a>
Implementation</h1>
<p >The implementation closely follows that in the <a href="../../harmonic/html/index.html">harmonic eigenproblem </a>, and so we shall concentrate on the differences from that problem.</p>
<h2><a class="anchor" id="equations"></a>
Creating the elements</h2>
<p >For generality, we implement the mathematics to assemble contributions to the Jacobian and mass matrices defined above in the class <code>ComplexHarmonicEquations</code> that inherits from <code>FiniteElement</code>.</p>
 <div class="fragment"><div class="line"><span class="comment">/// A class for all elements that solve the eigenvalue problem</span></div>
<div class="line"><span class="comment">/// \f[ </span><span class="comment"></span></div>
<div class="line"><span class="comment">/// \frac{\partial w}{\partial x}  = \lambda u</span></div>
<div class="line"><span class="comment">/// \f] </span></div>
<div class="line"><span class="comment">/// \f[</span></div>
<div class="line"><span class="comment">/// \frac{\partial u}{\partial x} = (\lambda - \mu) w</span></div>
<div class="line"><span class="comment">/// \f]</span></div>
<div class="line"><span class="comment">/// This class  contains the generic maths. Shape functions, geometric</span></div>
<div class="line"><span class="comment">/// mapping etc. must get implemented in derived class.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">class </span>ComplexHarmonicEquations : <span class="keyword">public</span> <span class="keyword">virtual</span> FiniteElement</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:<span class="comment"></span></div>
<div class="line"><span class="comment"> /// Empty Constructor</span></div>
<div class="line"><span class="comment"></span> ComplexHarmonicEquations() {}</div>
</div><!-- fragment --><p> The unknowns that represent the discretised eigenfunction are assumed to be stored at the nodes, but there are now two unknowns: <img class="formulaInl" alt="$u$" src="form_23.png" width="9" height="6"/> is assumed to be the first and <img class="formulaInl" alt="$w$" src="form_24.png" width="10" height="6"/> is the second.</p>
<div class="fragment"><div class="line"><span class="comment"> /// Access function: First eigenfunction value at local node n</span></div>
<div class="line"><span class="comment"> /// Note that solving the eigenproblem does not assign values</span><span class="comment"></span></div>
<div class="line"><span class="comment"> /// to this storage space. It is used for output purposes only.</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> u(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n)<span class="keyword"> const </span></div>
<div class="line"><span class="keyword">  </span>{<span class="keywordflow">return</span> nodal_value(n,0);}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Second eigenfunction value at local node n</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">virtual</span> <span class="keyword">inline</span> <span class="keywordtype">double</span> w(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; n)<span class="keyword"> const </span></div>
<div class="line"><span class="keyword">  </span>{<span class="keywordflow">return</span> nodal_value(n,1);}</div>
</div><!-- fragment --><p> As before, the key function is <code>fill_in_contribution_to_jacobian_and_mass_matrix</code> which implements the calculation of the equations.</p>
<div class="fragment"><div class="line"> <span class="keywordtype">void</span> fill_in_contribution_to_jacobian_and_mass_matrix(</div>
<div class="line">  Vector&lt;double&gt; &amp;residuals,</div>
<div class="line">  DenseMatrix&lt;double&gt; &amp;jacobian, DenseMatrix&lt;double&gt; &amp;mass_matrix)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Find out how many nodes there are</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_node = nnode();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Set up memory for the shape functions and their derivatives</span></div>
<div class="line">   Shape psi(n_node);</div>
<div class="line">   DShape dpsidx(n_node,1);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set the number of integration points</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_intpt = integral_pt()-&gt;nweight();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Integers to store the local equation and unknown numbers</span></div>
<div class="line">   <span class="keywordtype">int</span> local_eqn=0, local_unknown=0;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Loop over the integration points</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ipt=0;ipt&lt;n_intpt;ipt++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">//Get the integral weight</span></div>
<div class="line">     <span class="keywordtype">double</span> w = integral_pt()-&gt;weight(ipt);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Call the derivatives of the shape and test functions</span></div>
<div class="line">     <span class="keywordtype">double</span> J = dshape_eulerian_at_knot(ipt,psi,dpsidx);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Premultiply the weights and the Jacobian</span></div>
<div class="line">     <span class="keywordtype">double</span> W = w*J;</div>
<div class="line"> </div>
<div class="line">     <span class="comment">//Assemble the contributions to the mass matrix</span></div>
<div class="line">     <span class="comment">//Loop over the test functions</span></div>
<div class="line">     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0;l&lt;n_node;l++)</div>
<div class="line">      {</div>
<div class="line">       <span class="comment">//Get the local equation number</span></div>
<div class="line">       local_eqn = u_local_eqn(l,0);</div>
<div class="line">       <span class="comment">//If it&#39;s not a boundary condition</span></div>
<div class="line">       <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line">        {</div>
<div class="line">         <span class="comment">//Loop over the shape functions</span></div>
<div class="line">         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line">          { </div>
<div class="line">           local_unknown = u_local_eqn(l2,0);</div>
<div class="line">           <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line">           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">             <span class="comment">//This corresponds to the top left B block</span></div>
<div class="line">             mass_matrix(local_eqn, local_unknown) += psi(l2)*psi(l)*W;</div>
<div class="line">            }</div>
<div class="line">           local_unknown = u_local_eqn(l2,1);</div>
<div class="line">           <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line">           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">             <span class="comment">//This corresponds to the top right A block</span></div>
<div class="line">             jacobian(local_eqn,local_unknown) += dpsidx(l2,0)*psi(l)*W;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">       <span class="comment">//Get the local equation number</span></div>
<div class="line">       local_eqn = u_local_eqn(l,1);</div>
<div class="line">       <span class="comment">//IF it&#39;s not a boundary condition</span></div>
<div class="line">       <span class="keywordflow">if</span>(local_eqn &gt;= 0)</div>
<div class="line">        {</div>
<div class="line">         <span class="comment">//Loop over the shape functions</span></div>
<div class="line">         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2=0;l2&lt;n_node;l2++)</div>
<div class="line">          { </div>
<div class="line">           local_unknown = u_local_eqn(l2,0);</div>
<div class="line">           <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line">           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">             <span class="comment">//This corresponds to the lower left A block</span></div>
<div class="line">             jacobian(local_eqn,local_unknown) += dpsidx(l2,0)*psi(l)*W;</div>
<div class="line">            }</div>
<div class="line">           local_unknown = u_local_eqn(l2,1);</div>
<div class="line">           <span class="comment">//If at a non-zero degree of freedom add in the entry</span></div>
<div class="line">           <span class="keywordflow">if</span>(local_unknown &gt;= 0)</div>
<div class="line">            {</div>
<div class="line">             <span class="comment">//This corresponds to the lower right B block</span></div>
<div class="line">             mass_matrix(local_eqn, local_unknown) += psi(l2)*psi(l)*W;</div>
<div class="line">             <span class="comment">//This corresponds to the lower right \mu B block</span></div>
<div class="line">             jacobian(local_eqn,local_unknown) += </div>
<div class="line">              <a class="code hl_variable" href="namespaceEigenproblemShift.html#a82e816b5ecba937123c65c5bd953a2fb">EigenproblemShift::Mu</a>*psi(l2)*psi(l)*W;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> } <span class="comment">//end_of_fill_in_contribution_to_jacobian_and_mass_matrix</span></div>
<div class="ttc" id="anamespaceEigenproblemShift_html_a82e816b5ecba937123c65c5bd953a2fb"><div class="ttname"><a href="namespaceEigenproblemShift.html#a82e816b5ecba937123c65c5bd953a2fb">EigenproblemShift::Mu</a></div><div class="ttdeci">double Mu</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00046">complex_harmonic.cc:46</a></div></div>
</div><!-- fragment --><p> Note that the <b>shift</b> <img class="formulaInl" alt="$\mu$" src="form_25.png" width="9" height="9"/> is implemented in a global namespace as <code><a class="el" href="namespaceEigenproblemShift.html#a82e816b5ecba937123c65c5bd953a2fb">EigenproblemShift::Mu</a></code>.</p>
<p >The shape functions are specified in the <code><a class="el" href="classQComplexHarmonicElement.html" title="QComplexHarmonicElement&lt;NNODE_1D&gt; elements are 1D Elements with NNODE_1D nodal points that are used t...">QComplexHarmonicElement</a></code> class that inherits from our standard one-dimensional Lagrange elements <code>QElement&lt;1,NNODE_1D&gt;</code> as well as <code>HarmonicEquations</code>. The number of unknowns (two) is specified and the output functions and shape functions are overloaded as required: the output functions are specified in the <code>ComplexHarmonicEquations</code> class, whereas the shape functions are provided by the <code>QElement&lt;1,NNODE_1D&gt;</code> class.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">unsigned</span> NNODE_1D&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classQComplexHarmonicElement.html">QComplexHarmonicElement</a> : <span class="keyword">public</span> <span class="keyword">virtual</span> QElement&lt;1,NNODE_1D&gt;, </div>
<div class="line">                         <span class="keyword">public</span> ComplexHarmonicEquations</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: Call constructors for QElement and </span></div>
<div class="line"><span class="comment"> /// Poisson equations</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_function" href="classQComplexHarmonicElement.html#a9f1e88c4b5c7031d77c6f6dd3758de2a">QComplexHarmonicElement</a>() : QElement&lt;1,NNODE_1D&gt;(), </div>
<div class="line">                             ComplexHarmonicEquations() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> ///  Required  # of `values&#39; (pinned or dofs) </span></div>
<div class="line"><span class="comment"> /// at node n. Here there are two (u and w)</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">unsigned</span> <a class="code hl_function" href="classQComplexHarmonicElement.html#a3f1d68324e9d8b9e143044d716c72a87">required_nvalue</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;n)<span class="keyword"> const </span>{<span class="keywordflow">return</span> 2;}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Output function overloaded from ComplexHarmonicEquations</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classQComplexHarmonicElement.html#a8c45d7281a7bc7e2e2d53a7f87339ca4">output</a>(ostream &amp;outfile) </div>
<div class="line">  {ComplexHarmonicEquations::output(outfile);}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> ///  Output function overloaded from ComplexHarmonicEquations</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classQComplexHarmonicElement.html#a8c45d7281a7bc7e2e2d53a7f87339ca4">output</a>(ostream &amp;outfile, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;Nplot) </div>
<div class="line">  {ComplexHarmonicEquations::output(outfile,Nplot);}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/// Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="classQComplexHarmonicElement.html#a7c97d4e8c5433a44640d30c936d69ffb">dshape_eulerian</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;s, </div>
<div class="line">                               Shape &amp;psi, </div>
<div class="line">                               DShape &amp;dpsidx)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{<span class="keywordflow">return</span> QElement&lt;1,NNODE_1D&gt;::dshape_eulerian(s,psi,dpsidx);}</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Shape, test functions &amp; derivs. w.r.t. to global coords. at</span></div>
<div class="line"><span class="comment"> /// integration point ipt. Return Jacobian.</span></div>
<div class="line"><span class="comment"></span> <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="classQComplexHarmonicElement.html#a3f8d1d9396135d4d86f416dcf6c23904">dshape_eulerian_at_knot</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; ipt,</div>
<div class="line">                                       Shape &amp;psi, </div>
<div class="line">                                       DShape &amp;dpsidx)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{<span class="keywordflow">return</span> QElement&lt;1,NNODE_1D&gt;::dshape_eulerian_at_knot(ipt,psi,dpsidx);}</div>
<div class="line"> </div>
<div class="line">}; <span class="comment">//end_of_QComplexHarmonic_class_definition</span></div>
<div class="ttc" id="aclassQComplexHarmonicElement_html"><div class="ttname"><a href="classQComplexHarmonicElement.html">QComplexHarmonicElement</a></div><div class="ttdoc">QComplexHarmonicElement&lt;NNODE_1D&gt; elements are 1D Elements with NNODE_1D nodal points that are used t...</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00302">complex_harmonic.cc:304</a></div></div>
<div class="ttc" id="aclassQComplexHarmonicElement_html_a3f1d68324e9d8b9e143044d716c72a87"><div class="ttname"><a href="classQComplexHarmonicElement.html#a3f1d68324e9d8b9e143044d716c72a87">QComplexHarmonicElement::required_nvalue</a></div><div class="ttdeci">unsigned required_nvalue(const unsigned &amp;n) const</div><div class="ttdoc">Required # of ‘values’ (pinned or dofs) at node n. Here there are two (u and w)</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00315">complex_harmonic.cc:315</a></div></div>
<div class="ttc" id="aclassQComplexHarmonicElement_html_a3f8d1d9396135d4d86f416dcf6c23904"><div class="ttname"><a href="classQComplexHarmonicElement.html#a3f8d1d9396135d4d86f416dcf6c23904">QComplexHarmonicElement::dshape_eulerian_at_knot</a></div><div class="ttdeci">double dshape_eulerian_at_knot(const unsigned &amp;ipt, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. at integration point ipt....</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00337">complex_harmonic.cc:337</a></div></div>
<div class="ttc" id="aclassQComplexHarmonicElement_html_a7c97d4e8c5433a44640d30c936d69ffb"><div class="ttname"><a href="classQComplexHarmonicElement.html#a7c97d4e8c5433a44640d30c936d69ffb">QComplexHarmonicElement::dshape_eulerian</a></div><div class="ttdeci">double dshape_eulerian(const Vector&lt; double &gt; &amp;s, Shape &amp;psi, DShape &amp;dpsidx) const</div><div class="ttdoc">Shape, test functions &amp; derivs. w.r.t. to global coords. Return Jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00329">complex_harmonic.cc:329</a></div></div>
<div class="ttc" id="aclassQComplexHarmonicElement_html_a8c45d7281a7bc7e2e2d53a7f87339ca4"><div class="ttname"><a href="classQComplexHarmonicElement.html#a8c45d7281a7bc7e2e2d53a7f87339ca4">QComplexHarmonicElement::output</a></div><div class="ttdeci">void output(ostream &amp;outfile)</div><div class="ttdoc">Output function overloaded from ComplexHarmonicEquations.</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00318">complex_harmonic.cc:318</a></div></div>
<div class="ttc" id="aclassQComplexHarmonicElement_html_a9f1e88c4b5c7031d77c6f6dd3758de2a"><div class="ttname"><a href="classQComplexHarmonicElement.html#a9f1e88c4b5c7031d77c6f6dd3758de2a">QComplexHarmonicElement::QComplexHarmonicElement</a></div><div class="ttdeci">QComplexHarmonicElement()</div><div class="ttdoc">Constructor: Call constructors for QElement and Poisson equations.</div><div class="ttdef"><b>Definition:</b> <a href="complex__harmonic_8cc_source.html#l00310">complex_harmonic.cc:310</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="main"></a>
The driver code</h1>
<p >The driver code is identical to that of the <a href="../../harmonic/html/index.html">harmonic eigenproblem </a>.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="problem"></a>
The problem class</h1>
<p >The <code><a class="el" href="classComplexHarmonicProblem.html" title="1D ComplexHarmonic problem in unit interval.">ComplexHarmonicProblem</a></code> is derived from <code>oomph-lib's</code> generic <code>Problem</code> class and the specific element type and eigensolver are specified as template parameters to make it easy for the "user" to change either of these from the driver code. Once again, it is very similar to the <code><a class="el" href="classHarmonicProblem.html" title="1D Harmonic problem in unit interval.">HarmonicProblem</a></code> class in the <a href="../../harmonic/html/index.html">harmonic eigenproblem </a>. The only member function with any differences is the <code>solve(...)</code> function, which requests 7 rather than 4 eigenvalues to be computed and outputs the eigenfunction associated with eigenvalue of smallest magnitude (which is real).</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="exercises"></a>
Comments and exercises</h1>
<ol type="1">
<li>Modify the code to compute a different number of eigenvalues. What is the maximum number of eigenvalues that could be computed?</li>
<li>Confirm that the eigenvalues agree with the analytic result and that a transition from real to complex values occurs when <img class="formulaInl" alt="$ \mu = 2\pi $" src="form_26.png" width="39" height="11"/>.</li>
<li>Explain why there are always two eigenvalues with the values <img class="formulaInl" alt="$\lambda = \mu$" src="form_27.png" width="31" height="13"/>. What are the corresponding eigenfunctions?</li>
<li>When the output is a complex conjugate pair of eigenvalues, the two associated eigenvectors are the real and imaginary parts of the eigenvector corresponding to the first eigenvalue. The complex conjugate eigenvalue has a complex conjugate eigenvector (can you prove this?), so no more information is required. Modify the output function to examine the real and imaginary parts of a complex eigenvalue. Are the results what you expect?</li>
</ol>
<hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory: <center> <a href="../../../../demo_drivers/eigenproblems/harmonic/">demo_drivers/eigenproblems/harmonic/ </a> </center></li>
<li>The driver code is: <center> <a href="../../../../demo_drivers/eigenproblems/harmonic/harmonic.cc">demo_drivers/eigenproblems/harmonic/harmonic.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p >A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Mon May 9 2022 10:16:40
        </div>
      </div>
    </footer>
</body>
</html>

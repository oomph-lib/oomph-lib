<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: The adaptive solution of the equations of time-harmonic linear elasticity on unstructured meshes</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.8 -->
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">The adaptive solution of the equations of time-harmonic linear elasticity on unstructured meshes </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The aim of this tutorial is to demonstrate the adaptive solution of the time-harmonic equations of linear elasticity in cartesian coordinates on unstructured meshes.</p>
<p>The driver code is very similar to the one presented in <a href="../../elastic_annulus/html/index.html">another tutorial</a> and we only discuss the changes necessary to deal with the generation of the unstructured mesh and the assignment of different material properties to different parts of the domain.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="test"></a>
A test problem: Time-harmonic oscillations of an elastic annulus reinforced by a T-rib</h1>
<p>The sketch below shows the problem setup: A 2D elastic annulus which is reinforced with two T-ribs is subjected to a time-periodic pressure load of magnitude  </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[
{\bf t} = P ( \exp(\alpha(\varphi-\pi/4)^2)  + \exp(\alpha(\varphi-3\pi/4)^2) )
\]" src="form_0.png" width="254" height="16"/>
</p>
<p> (where <img class="formulaInl" alt="$ \varphi $" src="form_1.png" width="8" height="9"/> is the polar angle) along its outer edge. The parameter <img class="formulaInl" alt="$ \alpha $" src="form_2.png" width="8" height="6"/> controls the "sharpness" of the pressure load. For <img class="formulaInl" alt="$ \alpha=0 $" src="form_3.png" width="30" height="9"/> we obtain a uniform, axisymmetric load; the sketch below shows the pressure distribution (red vectors indicating the traction) for <img class="formulaInl" alt="$ \alpha = 1. $" src="form_4.png" width="34" height="9"/></p>
<div class="image">
<img src="setup.gif" alt=""/>
<div class="caption">
Sketch of the problem setup. </div></div>
 <p>The structure is symmetric and we only discretise the right half ( <img class="formulaInl" alt="$ x_1 &gt; 0 $" src="form_5.png" width="36" height="11"/>) of the domain and apply symmetry conditions (zero horizontal displacement) on the <img class="formulaInl" alt="$ x_2-$" src="form_6.png" width="23" height="9"/> axis.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>The figure below shows an animation of the structure's time-harmonic oscillation. The blue shaded region shows the shape of the oscillating structure while the pink region shows its initial configuration. The left half of the plot is used to show the (mirror image of the) adaptive unstructured mesh on which the solution was computed:</p>
<div class="image">
<img src="all.gif" alt=""/>
<div class="caption">
Animation of the time-harmonic deformation. </div></div>
 <p>This looks very pretty and shows that we can compute in non-trivial geometries but should you believe the results? Here's an attempt to convince you: If we make the rib much softer than the annulus, the rib will not offer much structural resistance and the annular region will deform as if the rib was not present. If we then set <img class="formulaInl" alt="$ \alpha = 0 $" src="form_7.png" width="30" height="9"/> we apply an axisymmetric forcing onto the structure and would expect the resulting displacement field (at least in the annular region) to be axisymmetric. For this case it is easy to find an analytical solution to the problem. The next two figures show a comparison between the analytical (green spheres) and computed solutions (shaded) for the real part of the horizontal and vertical displacements, respectively.</p>
<div class="image">
<img src="validate_real.gif" alt=""/>
<div class="caption">
Real part of the horizontal displacement, computed (shaded) and exact (spheres). </div></div>
 <div class="image">
<img src="validate_imag.gif" alt=""/>
<div class="caption">
Real part of the vertical displacement, computed (shaded) and exact (spheres). </div></div>
 <p>Convinced?</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="num"></a>
The numerical solution</h1>
<p>The driver code for this problem is very similar to the one discussed in <a href="../../elastic_annulus/html/index.html">another tutorial</a>. Running <code>sdiff</code> on the two driver codes </p><center> <a href="../../../../demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/time_harmonic_elastic_annulus.cc">demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/time_harmonic_elastic_annulus.cc </a> </center><p> and </p><center> <a href="../../../../demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/unstructured_time_harmonic_elastic_annulus.cc">demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/unstructured_time_harmonic_elastic_annulus.cc </a> </center><p> shows you the differences, the most important of which are:</p><ul>
<li>The provision of multiple elasticity tensors and frequency parameters for the two different regions (the rib and the annulus). <br  />
<br  />
</li>
<li>The provision of a helper function <code>complete_problem_setup()</code> which rebuilds the elements (by passing the problem parameters to the elements) following the unstructured mesh adaptation. (The need/rationale for such a function is discussed in <a href="../../../meshes/mesh_from_inline_triangle/html/index.html">another tutorial.</a>) <br  />
<br  />
</li>
<li>The mesh generation &ndash; the specification of the curvilinear boundaries and the geometry of the rib is somewhat tedious. We refer to <a href="../../../meshes/mesh_from_inline_triangle_internal_boundaries/html/index.html">another tutorial</a> for a discussion of how to define the internal mesh boundary that separates the two regions (the rib and the annular region) so that we can assign different material properties to them. <br  />
<br  />
. <br  />
 All of this is reasonably straightforward and provides a powerful code that automatically adapts the mesh while respecting the curvilinear boundaries of the domain. Have a look through the driver code and play with it.</li>
</ul>
<hr  />
 <hr  />
<h1><a class="anchor" id="code"></a>
Code listing</h1>
<p>Here's a listing of the complete driver code:</p>
<div class="fragment"><div class="line"><span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// Copyright (C) 2006-2026 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC//====================================================================</span></div>
<div class="line"><span class="comment">// Time-harmonic deformation of an T-rib reinforced elastic annulus subject to </span></div>
<div class="line"><span class="comment">// a nonuniform pressure load.</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//Oomph-lib includes</span></div>
<div class="line"><span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;time_harmonic_linear_elasticity.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//The meshes</span></div>
<div class="line"><span class="preprocessor">#include &quot;meshes/triangle_mesh.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>oomph;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span><span class="comment">// Straight line as geometric object</span><span class="comment"></span></div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">///////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Straight 1D line in 2D space </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:  Pass start and end points</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; r_start, <span class="keyword">const</span> Vector&lt;double&gt;&amp; r_end) </div>
<div class="line">  :  GeomObject(1,2), <a class="code hl_variable" href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">R_start</a>(r_start), <a class="code hl_variable" href="classMyStraightLine.html#afa466e12301ccea99a02fe1bde615691">R_end</a>(r_end)</div>
<div class="line">  { }</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>&amp; dummy) </div>
<div class="line">  { </div>
<div class="line">   BrokenCopy::broken_copy(<span class="stringliteral">&quot;MyStraightLine&quot;</span>);</div>
<div class="line">  } </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classMyStraightLine.html#a926ab921fec52ded94509efce06b66a7">operator=</a>(<span class="keyword">const</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>&amp;) </div>
<div class="line">  {</div>
<div class="line">   BrokenCopy::broken_assign(<span class="stringliteral">&quot;MyStraightLine&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor:  Empty</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_function" href="classMyStraightLine.html#ae2f9a5860652a726b2f4dc94d1332ef1">~MyStraightLine</a>(){}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Position Vector at Lagrangian coordinate zeta </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classMyStraightLine.html#ae3ee51a7b81acc2ef652bec4ee955d2f">position</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">   <span class="comment">// Position Vector</span></div>
<div class="line">   r[0] = <a class="code hl_variable" href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">R_start</a>[0]+(<a class="code hl_variable" href="classMyStraightLine.html#afa466e12301ccea99a02fe1bde615691">R_end</a>[0]-<a class="code hl_variable" href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">R_start</a>[0])*zeta[0];</div>
<div class="line">   r[1] = <a class="code hl_variable" href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">R_start</a>[1]+(<a class="code hl_variable" href="classMyStraightLine.html#afa466e12301ccea99a02fe1bde615691">R_end</a>[1]-<a class="code hl_variable" href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">R_start</a>[1])*zeta[0];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Start point of line</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; <a class="code hl_variable" href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">R_start</a>;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// End point of line</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; <a class="code hl_variable" href="classMyStraightLine.html#afa466e12301ccea99a02fe1bde615691">R_end</a>;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">//////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=======start_namespace==========================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceGlobal__Parameters.html">Global_Parameters</a></div>
<div class="line">{</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Poisson&#39;s ratio</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Nu</a>=0.3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Square of non-dim frequency </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Omega_sq</a>=10.0; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Square of non-dim frequency for the two regions</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; <a class="code hl_function" href="namespaceGlobal__Parameters.html#a4c035035889b93588b44f7778bb27ef9">Omega_sq_region</a>(2,<a class="code hl_variable" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Omega_sq</a>);</div>
<div class="line">  <span class="comment"></span></div>
<div class="line"><span class="comment"> /// The elasticity tensors for the two regions</span></div>
<div class="line"><span class="comment"></span> Vector&lt;TimeHarmonicIsotropicElasticityTensor*&gt; <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">E_pt</a>;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Thickness of annulus</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a0b73c5ead1114ae88bbd4cb0eb54f078">H_annulus</a>=0.1;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Uniform pressure</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a> = 0.1;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Peakiness parameter for pressure load</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Alpha</a>=200.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constant pressure load (real and imag part)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">pressure_load</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line">                        <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, </div>
<div class="line">                        Vector&lt;std::complex&lt;double&gt; &gt;&amp;traction)</div>
<div class="line"> {</div>
<div class="line">  <span class="keywordtype">double</span> phi=atan2(x[1],x[0]);</div>
<div class="line">  <span class="keywordtype">double</span> magnitude=exp(-<a class="code hl_variable" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Alpha</a>*pow(phi-0.25*MathematicalConstants::Pi,2));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> dim = traction.size();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;dim;i++)</div>
<div class="line">   {</div>
<div class="line">    traction[i] = complex&lt;double&gt;(-magnitude*<a class="code hl_variable" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i],magnitude*<a class="code hl_variable" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i]);</div>
<div class="line">   }</div>
<div class="line"> } <span class="comment">// end_of_pressure_load</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Output directory</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">string</span> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Directory</a>=<span class="stringliteral">&quot;RESLT&quot;</span>;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end namespace</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=============begin_problem============================================ </span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Annular disk</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classRingWithTRibProblem.html">RingWithTRibProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:</span></div>
<div class="line"><span class="comment"></span> <a class="code hl_function" href="classRingWithTRibProblem.html#ad0313aac3c0cdb87e753ba474a4e334f">RingWithTRibProblem</a>();</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a5d9f7b05cc71c02275f6c3c1a465fd20">actions_after_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#aa74a20d5bd6d7f16eb00080734dde0d1">actions_before_newton_solve</a>() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Actions before adapt: Wipe the mesh of traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a7a170199d58390ae43a044294bfc7ac5">actions_before_adapt</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Actions after adapt: Rebuild the mesh of traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a8749aaf1e46d802c210b51e07093505b">actions_after_adapt</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Doc the solution</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a43b70b125f467aa5bb9c74d08f193aa5">doc_solution</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#ac4445c7a9fbfdcb69063d36fe0fe08c3">create_traction_elements</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Delete traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#aa85169a96623cb39f18111ee436f5b9d">delete_traction_elements</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Helper function to complete problem setup</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a7aa8c978ec6ff0a9823ef895b263fb41">complete_problem_setup</a>();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to refineable solid mesh</span></div>
<div class="line"><span class="comment"></span> RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;* <a class="code hl_variable" href="classRingWithTRibProblem.html#a89da884cecc2d8984168817de7b1927e">Solid_mesh_pt</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to solid mesh</span></div>
<div class="line"><span class="comment"></span> TriangleMesh&lt;ELASTICITY_ELEMENT&gt;* <a class="code hl_variable" href="classRingWithTRibProblem.html#a89da884cecc2d8984168817de7b1927e">Solid_mesh_pt</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of traction elements</span></div>
<div class="line"><span class="comment"></span> Mesh* <a class="code hl_variable" href="classRingWithTRibProblem.html#abf11b5c5d0c63c91ca7b248c18acad5b">Traction_mesh_pt</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// DocInfo object for output</span></div>
<div class="line"><span class="comment"></span> DocInfo <a class="code hl_variable" href="classRingWithTRibProblem.html#a086bb927e3091b5d38e193b2ccb84e3b">Doc_info</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of upper symmetry boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="classRingWithTRibProblem.html#ad15da3f1436b47c6cd7a79962aaa895d">Upper_symmetry_boundary_id</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower symmetry boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="classRingWithTRibProblem.html#a93f5abb451b85f65316b930802c727f8">Lower_symmetry_boundary_id</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of outer boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="classRingWithTRibProblem.html#a88918269cac403640e2659d48210d03c">Outer_boundary_id</a>;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//===========start_of_constructor======================================= </span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Constructor: </span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><a class="code hl_function" href="classRingWithTRibProblem.html#ad0313aac3c0cdb87e753ba474a4e334f">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::RingWithTRibProblem</a>() </div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid mesh</span></div>
<div class="line"> <span class="comment">//-----------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Start and end coordinates</span></div>
<div class="line"> Vector&lt;double&gt; r_start(2);</div>
<div class="line"> Vector&lt;double&gt; r_end(2);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Outer radius of hull</span></div>
<div class="line"> <span class="keywordtype">double</span> r_outer = 1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Inner radius of hull</span></div>
<div class="line"> <span class="keywordtype">double</span> r_inner = r_outer-<a class="code hl_variable" href="namespaceGlobal__Parameters.html#a0b73c5ead1114ae88bbd4cb0eb54f078">Global_Parameters::H_annulus</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Thickness of rib</span></div>
<div class="line"> <span class="keywordtype">double</span> rib_thick=0.05;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Depth of rib</span></div>
<div class="line"> <span class="keywordtype">double</span> rib_depth=0.2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Total width of T</span></div>
<div class="line"> <span class="keywordtype">double</span> t_width=0.2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Thickness of T</span></div>
<div class="line"> <span class="keywordtype">double</span> t_thick=0.05;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Half-opening angle of rib</span></div>
<div class="line"> <span class="keywordtype">double</span> half_phi_rib=asin(0.5*rib_thick/r_inner);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Pointer to the closed curve that defines the outer boundary</span></div>
<div class="line"> TriangleMeshClosedCurve* closed_curve_pt=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Provide storage for pointers to the parts of the curvilinear boundary</span></div>
<div class="line"> Vector&lt;TriangleMeshCurveSection*&gt; curvilinear_boundary_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Outer boundary</span></div>
<div class="line"> <span class="comment">//---------------</span></div>
<div class="line"> Ellipse* outer_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_outer,r_outer);</div>
<div class="line"> <span class="keywordtype">double</span> zeta_start=-0.5*MathematicalConstants::Pi;</div>
<div class="line"> <span class="keywordtype">double</span> zeta_end=0.5*MathematicalConstants::Pi;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nsegment=50;</div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   outer_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Outer_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Upper straight line segment on symmetry axis</span></div>
<div class="line"> <span class="comment">//---------------------------------------------</span></div>
<div class="line"> r_start[0]=0.0;</div>
<div class="line"> r_start[1]=r_outer;</div>
<div class="line"> r_end[0]=0.0;</div>
<div class="line"> r_end[1]=r_inner;</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* upper_sym_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   upper_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">                                                        </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Upper_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Upper part of inner boundary</span></div>
<div class="line"> <span class="comment">//-----------------------------</span></div>
<div class="line"> Ellipse* upper_inner_boundary_pt = </div>
<div class="line">  <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line"> zeta_start=0.5*MathematicalConstants::Pi;</div>
<div class="line"> zeta_end=half_phi_rib;</div>
<div class="line"> nsegment=20;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   upper_inner_boundary_pt,</div>
<div class="line">   zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Upper half of inward rib</span></div>
<div class="line"> <span class="comment">//-------------------------</span></div>
<div class="line"> r_start[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_start[1]=r_inner*sin(half_phi_rib);</div>
<div class="line"> r_end[0]=r_start[0]-rib_depth;</div>
<div class="line"> r_end[1]=r_start[1];</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* upper_inward_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> TriangleMeshCurviLine* upper_inward_rib_curviline_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   upper_inward_rib_pt,zeta_start,zeta_end,nsegment,boundary_id);</div>
<div class="line"> curvilinear_boundary_pt.push_back(upper_inward_rib_curviline_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical upper bit of T</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0];</div>
<div class="line"> r_end[1]=r_start[1]+0.5*(t_width-rib_thick);</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* vertical_upper_t_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   vertical_upper_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Horizontal upper bit of T</span></div>
<div class="line"> <span class="comment">//-----------==-------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0]-t_thick;</div>
<div class="line"> r_end[1]=r_start[1];</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* horizontal_upper_t_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   horizontal_upper_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical end of rib end</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0];</div>
<div class="line"> r_end[1]=-r_start[1];</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* inner_vertical_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   inner_vertical_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Horizontal lower bit of T</span></div>
<div class="line"> <span class="comment">//-----------==-------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0]+t_thick;</div>
<div class="line"> r_end[1]=r_start[1];</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* horizontal_lower_t_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   horizontal_lower_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical lower bit of T</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0];</div>
<div class="line"> r_end[1]=r_start[1]+0.5*(t_width-rib_thick);</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* vertical_lower_t_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   vertical_lower_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Lower half of inward rib</span></div>
<div class="line"> <span class="comment">//-------------------------</span></div>
<div class="line"> r_end[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_end[1]=-r_inner*sin(half_phi_rib);</div>
<div class="line"> r_start[0]=r_end[0]-rib_depth;</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* lower_inward_rib_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> TriangleMeshCurviLine* lower_inward_rib_curviline_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   lower_inward_rib_pt,zeta_start,zeta_end,nsegment,boundary_id);</div>
<div class="line"> curvilinear_boundary_pt.push_back(lower_inward_rib_curviline_pt);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Lower part of inner boundary</span></div>
<div class="line"> <span class="comment">//-----------------------------</span></div>
<div class="line"> Ellipse* lower_inner_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line"> zeta_start=-half_phi_rib;</div>
<div class="line"> zeta_end=-0.5*MathematicalConstants::Pi;</div>
<div class="line"> nsegment=20;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   lower_inner_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Lower straight line segment on symmetry axis</span></div>
<div class="line"> <span class="comment">//---------------------------------------------</span></div>
<div class="line"> r_start[0]=0.0;</div>
<div class="line"> r_start[1]=-r_inner;</div>
<div class="line"> r_end[0]=0.0;</div>
<div class="line"> r_end[1]=-r_outer;</div>
<div class="line"> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>* lower_sym_pt = <span class="keyword">new</span> <a class="code hl_class" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   lower_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">      </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Lower_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Combine to curvilinear boundary</span></div>
<div class="line"> <span class="comment">//--------------------------------</span></div>
<div class="line"> closed_curve_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshClosedCurve(curvilinear_boundary_pt); </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Vertical dividing line across base of T-rib</span></div>
<div class="line"> <span class="comment">//--------------------------------------------</span></div>
<div class="line"> Vector&lt;TriangleMeshCurveSection*&gt; internal_polyline_pt(1);</div>
<div class="line"> r_start[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_start[1]=r_inner*sin(half_phi_rib);</div>
<div class="line"> r_end[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_end[1]=-r_inner*sin(half_phi_rib);</div>
<div class="line"> </div>
<div class="line"> Vector&lt;Vector&lt;double&gt; &gt; boundary_vertices(2);</div>
<div class="line"> boundary_vertices[0]=r_start;</div>
<div class="line"> boundary_vertices[1]=r_end;</div>
<div class="line"> boundary_id=100;</div>
<div class="line"> TriangleMeshPolyLine* rib_divider_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshPolyLine(boundary_vertices,boundary_id); </div>
<div class="line"> internal_polyline_pt[0]=rib_divider_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Make connection</span></div>
<div class="line"> <span class="keywordtype">double</span> s_connect=0.0;</div>
<div class="line"> internal_polyline_pt[0]-&gt;connect_initial_vertex_to_curviline(</div>
<div class="line">  upper_inward_rib_curviline_pt,s_connect);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Make connection</span></div>
<div class="line"> s_connect=1.0;</div>
<div class="line"> internal_polyline_pt[0]-&gt;connect_final_vertex_to_curviline(</div>
<div class="line">  lower_inward_rib_curviline_pt,s_connect);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create open curve that defines internal bondary</span></div>
<div class="line"> Vector&lt;TriangleMeshOpenCurve*&gt; inner_boundary_pt;</div>
<div class="line"> inner_boundary_pt.push_back(<span class="keyword">new</span> TriangleMeshOpenCurve(internal_polyline_pt));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define coordinates of a point inside the rib</span></div>
<div class="line"> Vector&lt;double&gt; rib_center(2);</div>
<div class="line"> rib_center[0]=r_inner-rib_depth;</div>
<div class="line"> rib_center[1]=0.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Now build the mesh</span></div>
<div class="line"> <span class="comment">//===================</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Use the TriangleMeshParameters object for helping on the manage of the</span></div>
<div class="line"> <span class="comment">// TriangleMesh parameters. The only parameter that needs to take is the</span></div>
<div class="line"> <span class="comment">// outer boundary.</span></div>
<div class="line"> TriangleMeshParameters triangle_mesh_parameters(closed_curve_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Target area</span></div>
<div class="line"> triangle_mesh_parameters.element_area()=0.2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Specify the internal open boundary</span></div>
<div class="line"> triangle_mesh_parameters.internal_open_curves_pt()=inner_boundary_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define the region</span></div>
<div class="line"> triangle_mesh_parameters.add_region_coordinates(1,rib_center);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the mesh</span></div>
<div class="line"> Solid_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">  RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set error estimator</span></div>
<div class="line"> Solid_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the mesh</span></div>
<div class="line"> Solid_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">  TriangleMesh&lt;ELASTICITY_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Let&#39;s have a look where the boundaries are</span></div>
<div class="line"> Solid_mesh_pt-&gt;output(<span class="stringliteral">&quot;solid_mesh.dat&quot;</span>);</div>
<div class="line"> Solid_mesh_pt-&gt;output_boundaries(<span class="stringliteral">&quot;solid_mesh_boundary.dat&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the traction element mesh</span></div>
<div class="line"> Traction_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_traction_elements(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid mesh is first sub-mesh</span></div>
<div class="line"> add_sub_mesh(Solid_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add traction sub-mesh</span></div>
<div class="line"> add_sub_mesh(Traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build combined &quot;global&quot; mesh</span></div>
<div class="line"> build_global_mesh();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create elasticity tensors</span></div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>.resize(2);</div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[0]=<span class="keyword">new</span> TimeHarmonicIsotropicElasticityTensor(</div>
<div class="line">    <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>);</div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[1]=<span class="keyword">new</span> TimeHarmonicIsotropicElasticityTensor(</div>
<div class="line">  <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> complete_problem_setup();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign equation numbers</span></div>
<div class="line"> cout &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set output directory</span></div>
<div class="line"> Doc_info.set_directory(<a class="code hl_variable" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end_of_constructor</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_complete_problem_setup====================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Complete problem setup</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a7aa8c978ec6ff0a9823ef895b263fb41">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::complete_problem_setup</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Min element size allowed during adaptation</span></div>
<div class="line"> <span class="keywordflow">if</span> (!CommandLineArgs::command_line_flag_has_been_set(<span class="stringliteral">&quot;--validation&quot;</span>))</div>
<div class="line">  {   </div>
<div class="line">   Solid_mesh_pt-&gt;min_element_size()=1.0e-5;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign the physical properties to the elements</span></div>
<div class="line"> <span class="comment">//----------------------------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nreg=Solid_mesh_pt-&gt;nregion();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> r=0;r&lt;nreg;r++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> nel=Solid_mesh_pt-&gt;nregion_element(r);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">    {     </div>
<div class="line">     <span class="comment">//Cast to a solid element</span></div>
<div class="line">     ELASTICITY_ELEMENT *el_pt = </div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(Solid_mesh_pt-&gt;region_element_pt(r,e));</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Set the constitutive law</span></div>
<div class="line">     el_pt-&gt;elasticity_tensor_pt() = <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[r];</div>
<div class="line"> </div>
<div class="line">     <span class="comment">// Square of non-dim frequency</span></div>
<div class="line">     el_pt-&gt;omega_sq_pt()= &amp;<a class="code hl_function" href="namespaceGlobal__Parameters.html#a4c035035889b93588b44f7778bb27ef9">Global_Parameters::Omega_sq_region</a>[r];</div>
<div class="line">    }</div>
<div class="line">  }                         </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid boundary conditions:</span></div>
<div class="line"> <span class="comment">//---------------------------</span></div>
<div class="line"> <span class="comment">// Pin real and imag part of horizontal displacement components </span></div>
<div class="line"> <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// on vertical boundaries</span></div>
<div class="line"> <span class="comment">//-----------------------</span></div>
<div class="line"> {  </div>
<div class="line">  <span class="comment">//Loop over the nodes to pin and assign boundary displacements on </span></div>
<div class="line">  <span class="comment">//solid boundary</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(Upper_symmetry_boundary_id);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node;i++)</div>
<div class="line">   {</div>
<div class="line">    Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(Upper_symmetry_boundary_id,i);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Real part of x-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(0);</div>
<div class="line">    nod_pt-&gt;set_value(0,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of x-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(2);</div>
<div class="line">    nod_pt-&gt;set_value(2,0.0);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> {</div>
<div class="line">  <span class="comment">//Loop over the nodes to pin and assign boundary displacements on </span></div>
<div class="line">  <span class="comment">//solid boundary</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(Lower_symmetry_boundary_id);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node;i++)</div>
<div class="line">   {</div>
<div class="line">    Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(Lower_symmetry_boundary_id,i);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real part of x-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(0);</div>
<div class="line">    nod_pt-&gt;set_value(0,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of x-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(2);</div>
<div class="line">    nod_pt-&gt;set_value(2,0.0);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_before_adapt======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Actions before adapt: Wipe the mesh of traction elements</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a7a170199d58390ae43a044294bfc7ac5">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::actions_before_adapt</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Kill the traction elements and wipe surface mesh</span></div>
<div class="line"> delete_traction_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> rebuild_global_mesh();</div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end of actions_before_adapt</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_after_adapt=======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">///  Actions after adapt: Rebuild the mesh of traction elements</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a8749aaf1e46d802c210b51e07093505b">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::actions_after_adapt</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Create traction elements from all elements that are </span></div>
<div class="line"> <span class="comment">// adjacent to FSI boundaries and add them to surface meshes</span></div>
<div class="line"> create_traction_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> rebuild_global_mesh();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> complete_problem_setup();   </div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end of actions_after_adapt</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_traction_elements==============================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create traction elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#ac4445c7a9fbfdcb69063d36fe0fe08c3">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::create_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">unsigned</span> b=Outer_boundary_id;</div>
<div class="line"> {</div>
<div class="line">  <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line">   </div>
<div class="line">  <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">   {</div>
<div class="line">    <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">    ELASTICITY_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">     Solid_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">    <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Create element</span></div>
<div class="line">    TimeHarmonicLinearElasticityTractionElement&lt;ELASTICITY_ELEMENT&gt;* el_pt=</div>
<div class="line">     <span class="keyword">new</span> TimeHarmonicLinearElasticityTractionElement&lt;ELASTICITY_ELEMENT&gt;</div>
<div class="line">     (bulk_elem_pt,face_index);   </div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Add to mesh</span></div>
<div class="line">    Traction_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">    <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">    el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">    </div>
<div class="line">    <span class="comment">//Set the traction function</span></div>
<div class="line">    el_pt-&gt;traction_fct_pt() = <a class="code hl_function" href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">Global_Parameters::pressure_load</a>;</div>
<div class="line">    </div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end_of_create_traction_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_delete_traction_elements==============================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Delete traction elements and wipe the  traction meshes</span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#aa85169a96623cb39f18111ee436f5b9d">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::delete_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// How many surface elements are in the surface mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Traction_mesh_pt-&gt;nelement();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the surface elements</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Kill surface element</span></div>
<div class="line">   <span class="keyword">delete</span> Traction_mesh_pt-&gt;element_pt(e);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Wipe the mesh</span></div>
<div class="line"> Traction_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of delete_traction_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//==============start_doc===========================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Doc the solution</span></div>
<div class="line"><span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="classRingWithTRibProblem.html#a43b70b125f467aa5bb9c74d08f193aa5">RingWithTRibProblem&lt;ELASTICITY_ELEMENT&gt;::doc_solution</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> ofstream some_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_plot=5; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output displacement field</span></div>
<div class="line"> <span class="comment">//--------------------------</span></div>
<div class="line"> snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;%s/elast_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output traction elements</span></div>
<div class="line"> <span class="comment">//-------------------------</span></div>
<div class="line"> snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;%s/traction_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Traction_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output regions</span></div>
<div class="line"> <span class="comment">//---------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nreg=Solid_mesh_pt-&gt;nregion();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> r=0;r&lt;nreg;r++)</div>
<div class="line">  {</div>
<div class="line">   snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;%s/region%i_%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">           r,Doc_info.number());   </div>
<div class="line">   some_file.open(filename);   </div>
<div class="line">   <span class="keywordtype">unsigned</span> nel=Solid_mesh_pt-&gt;nregion_element(r);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">    {     </div>
<div class="line">     FiniteElement* el_pt=Solid_mesh_pt-&gt;region_element_pt(r,e);</div>
<div class="line">     el_pt-&gt;output(some_file,n_plot);</div>
<div class="line">    }</div>
<div class="line">   some_file.close();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output norm of solution (to allow validation of solution even</span></div>
<div class="line"> <span class="comment">// if triangle generates a slightly different mesh)</span></div>
<div class="line"> snprintf(filename, <span class="keyword">sizeof</span>(filename), <span class="stringliteral">&quot;%s/norm%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());   </div>
<div class="line"> some_file.open(filename);   </div>
<div class="line"> <span class="keywordtype">double</span> norm=0.0;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nel=Solid_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">double</span> el_norm=0.0;</div>
<div class="line">   Solid_mesh_pt-&gt;compute_norm(el_norm);</div>
<div class="line">   norm+=el_norm;</div>
<div class="line">  }</div>
<div class="line"> some_file &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Increment label for output files</span></div>
<div class="line"> Doc_info.number()++;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end doc</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=======start_of_main==================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Driver for annular disk loaded by pressure</span></div>
<div class="line"><span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="time__harmonic__elastic__annulus_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Store command line arguments</span></div>
<div class="line"> CommandLineArgs::setup(argc,argv);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define possible command line arguments and parse the ones that</span></div>
<div class="line"> <span class="comment">// were actually specified </span></div>
<div class="line">  </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Max. number of adaptations</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> max_adapt=3;</div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--max_adapt&quot;</span>,&amp;max_adapt);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Peakiness parameter for loading</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--alpha&quot;</span>,</div>
<div class="line">                                            &amp;<a class="code hl_variable" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Global_Parameters::Alpha</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Validation run?</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--validation&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parse command line</span></div>
<div class="line"> CommandLineArgs::parse_and_assign(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc what has actually been specified on the command line</span></div>
<div class="line"> CommandLineArgs::doc_specified_flags();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Set up the problem</span></div>
<div class="line"> <a class="code hl_class" href="classRingWithTRibProblem.html">RingWithTRibProblem</a>&lt;ProjectableTimeHarmonicLinearElasticityElement</div>
<div class="line">                    &lt;TTimeHarmonicLinearElasticityElement&lt;2,3&gt; &gt; &gt;</div>
<div class="line">  problem;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Set up the problem</span></div>
<div class="line"> <a class="code hl_class" href="classRingWithTRibProblem.html">RingWithTRibProblem&lt;TTimeHarmonicLinearElasticityElement&lt;2,3&gt;</a> &gt; problem;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Initial values for parameter values</span></div>
<div class="line"> <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a>=0.1; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Parameter incrementation</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nstep=2;</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nstep;i++)</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADAPTIVE</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Solve the problem with Newton&#39;s method, allowing</span></div>
<div class="line">   <span class="comment">// up to max_adapt mesh adaptations after every solve.</span></div>
<div class="line">   problem.newton_solve(max_adapt);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Solve the problem using Newton&#39;s method</span></div>
<div class="line">   problem.newton_solve();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Doc solution</span></div>
<div class="line">   problem.<a class="code hl_function" href="classRingWithTRibProblem.html#a43b70b125f467aa5bb9c74d08f193aa5">doc_solution</a>();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Now reduce the stiffness of the rib and set its inertia to</span></div>
<div class="line">   <span class="comment">// zero, then re-solve. Resulting displacement field should</span></div>
<div class="line">   <span class="comment">// be approximately axisymmetric in the annular region.</span></div>
<div class="line">   <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[1]-&gt;update_constitutive_parameters(</div>
<div class="line">    <a class="code hl_variable" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>,1.0e-10);</div>
<div class="line">   <a class="code hl_function" href="namespaceGlobal__Parameters.html#a4c035035889b93588b44f7778bb27ef9">Global_Parameters::Omega_sq_region</a>[1]=0.0;</div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end of main</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="aclassMyStraightLine_html"><div class="ttname"><a href="classMyStraightLine.html">MyStraightLine</a></div><div class="ttdoc">Straight 1D line in 2D space.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00050">unstructured_time_harmonic_elastic_annulus.cc:51</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html_a0f66636dd5d1e7ff6ec93acf90879f0c"><div class="ttname"><a href="classMyStraightLine.html#a0f66636dd5d1e7ff6ec93acf90879f0c">MyStraightLine::R_start</a></div><div class="ttdeci">Vector&lt; double &gt; R_start</div><div class="ttdoc">Start point of line.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00088">unstructured_time_harmonic_elastic_annulus.cc:88</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html_a926ab921fec52ded94509efce06b66a7"><div class="ttname"><a href="classMyStraightLine.html#a926ab921fec52ded94509efce06b66a7">MyStraightLine::operator=</a></div><div class="ttdeci">void operator=(const MyStraightLine &amp;)</div><div class="ttdoc">Broken assignment operator.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00068">unstructured_time_harmonic_elastic_annulus.cc:68</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html_ae2f9a5860652a726b2f4dc94d1332ef1"><div class="ttname"><a href="classMyStraightLine.html#ae2f9a5860652a726b2f4dc94d1332ef1">MyStraightLine::~MyStraightLine</a></div><div class="ttdeci">~MyStraightLine()</div><div class="ttdoc">Destructor: Empty.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00075">unstructured_time_harmonic_elastic_annulus.cc:75</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html_ae3ee51a7b81acc2ef652bec4ee955d2f"><div class="ttname"><a href="classMyStraightLine.html#ae3ee51a7b81acc2ef652bec4ee955d2f">MyStraightLine::position</a></div><div class="ttdeci">void position(const Vector&lt; double &gt; &amp;zeta, Vector&lt; double &gt; &amp;r) const</div><div class="ttdoc">Position Vector at Lagrangian coordinate zeta.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00078">unstructured_time_harmonic_elastic_annulus.cc:78</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html_afa466e12301ccea99a02fe1bde615691"><div class="ttname"><a href="classMyStraightLine.html#afa466e12301ccea99a02fe1bde615691">MyStraightLine::R_end</a></div><div class="ttdeci">Vector&lt; double &gt; R_end</div><div class="ttdoc">End point of line.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00091">unstructured_time_harmonic_elastic_annulus.cc:91</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html"><div class="ttname"><a href="classRingWithTRibProblem.html">RingWithTRibProblem</a></div><div class="ttdoc">Annular disk.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00155">unstructured_time_harmonic_elastic_annulus.cc:156</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a086bb927e3091b5d38e193b2ccb84e3b"><div class="ttname"><a href="classRingWithTRibProblem.html#a086bb927e3091b5d38e193b2ccb84e3b">RingWithTRibProblem::Doc_info</a></div><div class="ttdeci">DocInfo Doc_info</div><div class="ttdoc">DocInfo object for output.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00205">unstructured_time_harmonic_elastic_annulus.cc:205</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a43b70b125f467aa5bb9c74d08f193aa5"><div class="ttname"><a href="classRingWithTRibProblem.html#a43b70b125f467aa5bb9c74d08f193aa5">RingWithTRibProblem::doc_solution</a></div><div class="ttdeci">void doc_solution()</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00753">unstructured_time_harmonic_elastic_annulus.cc:753</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a5d9f7b05cc71c02275f6c3c1a465fd20"><div class="ttname"><a href="classRingWithTRibProblem.html#a5d9f7b05cc71c02275f6c3c1a465fd20">RingWithTRibProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00164">unstructured_time_harmonic_elastic_annulus.cc:164</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a7a170199d58390ae43a044294bfc7ac5"><div class="ttname"><a href="classRingWithTRibProblem.html#a7a170199d58390ae43a044294bfc7ac5">RingWithTRibProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of traction elements.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00648">unstructured_time_harmonic_elastic_annulus.cc:648</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a7aa8c978ec6ff0a9823ef895b263fb41"><div class="ttname"><a href="classRingWithTRibProblem.html#a7aa8c978ec6ff0a9823ef895b263fb41">RingWithTRibProblem::complete_problem_setup</a></div><div class="ttdeci">void complete_problem_setup()</div><div class="ttdoc">Helper function to complete problem setup.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00566">unstructured_time_harmonic_elastic_annulus.cc:566</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a8749aaf1e46d802c210b51e07093505b"><div class="ttname"><a href="classRingWithTRibProblem.html#a8749aaf1e46d802c210b51e07093505b">RingWithTRibProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of traction elements.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00664">unstructured_time_harmonic_elastic_annulus.cc:664</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a88918269cac403640e2659d48210d03c"><div class="ttname"><a href="classRingWithTRibProblem.html#a88918269cac403640e2659d48210d03c">RingWithTRibProblem::Outer_boundary_id</a></div><div class="ttdeci">unsigned Outer_boundary_id</div><div class="ttdoc">Boundary ID of outer boundary.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00214">unstructured_time_harmonic_elastic_annulus.cc:214</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a89da884cecc2d8984168817de7b1927e"><div class="ttname"><a href="classRingWithTRibProblem.html#a89da884cecc2d8984168817de7b1927e">RingWithTRibProblem::Solid_mesh_pt</a></div><div class="ttdeci">RefineableTriangleMesh&lt; ELASTICITY_ELEMENT &gt; * Solid_mesh_pt</div><div class="ttdoc">Pointer to refineable solid mesh.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00192">unstructured_time_harmonic_elastic_annulus.cc:192</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_a93f5abb451b85f65316b930802c727f8"><div class="ttname"><a href="classRingWithTRibProblem.html#a93f5abb451b85f65316b930802c727f8">RingWithTRibProblem::Lower_symmetry_boundary_id</a></div><div class="ttdeci">unsigned Lower_symmetry_boundary_id</div><div class="ttdoc">Boundary ID of lower symmetry boundary.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00211">unstructured_time_harmonic_elastic_annulus.cc:211</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_aa74a20d5bd6d7f16eb00080734dde0d1"><div class="ttname"><a href="classRingWithTRibProblem.html#aa74a20d5bd6d7f16eb00080734dde0d1">RingWithTRibProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update function (empty)</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00167">unstructured_time_harmonic_elastic_annulus.cc:167</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_aa85169a96623cb39f18111ee436f5b9d"><div class="ttname"><a href="classRingWithTRibProblem.html#aa85169a96623cb39f18111ee436f5b9d">RingWithTRibProblem::delete_traction_elements</a></div><div class="ttdeci">void delete_traction_elements()</div><div class="ttdoc">Delete traction elements.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00728">unstructured_time_harmonic_elastic_annulus.cc:728</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_abf11b5c5d0c63c91ca7b248c18acad5b"><div class="ttname"><a href="classRingWithTRibProblem.html#abf11b5c5d0c63c91ca7b248c18acad5b">RingWithTRibProblem::Traction_mesh_pt</a></div><div class="ttdeci">Mesh * Traction_mesh_pt</div><div class="ttdoc">Pointer to mesh of traction elements.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00202">unstructured_time_harmonic_elastic_annulus.cc:202</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_ac4445c7a9fbfdcb69063d36fe0fe08c3"><div class="ttname"><a href="classRingWithTRibProblem.html#ac4445c7a9fbfdcb69063d36fe0fe08c3">RingWithTRibProblem::create_traction_elements</a></div><div class="ttdeci">void create_traction_elements()</div><div class="ttdoc">Create traction elements.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00683">unstructured_time_harmonic_elastic_annulus.cc:683</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_ad0313aac3c0cdb87e753ba474a4e334f"><div class="ttname"><a href="classRingWithTRibProblem.html#ad0313aac3c0cdb87e753ba474a4e334f">RingWithTRibProblem::RingWithTRibProblem</a></div><div class="ttdeci">RingWithTRibProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00223">unstructured_time_harmonic_elastic_annulus.cc:223</a></div></div>
<div class="ttc" id="aclassRingWithTRibProblem_html_ad15da3f1436b47c6cd7a79962aaa895d"><div class="ttname"><a href="classRingWithTRibProblem.html#ad15da3f1436b47c6cd7a79962aaa895d">RingWithTRibProblem::Upper_symmetry_boundary_id</a></div><div class="ttdeci">unsigned Upper_symmetry_boundary_id</div><div class="ttdoc">Boundary ID of upper symmetry boundary.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00208">unstructured_time_harmonic_elastic_annulus.cc:208</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">Global variables.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00049">time_harmonic_elastic_annulus.cc:50</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a0b73c5ead1114ae88bbd4cb0eb54f078"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a0b73c5ead1114ae88bbd4cb0eb54f078">Global_Parameters::H_annulus</a></div><div class="ttdeci">double H_annulus</div><div class="ttdoc">Thickness of annulus.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00062">time_harmonic_elastic_annulus.cc:62</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a0ddb3a77481b907fbb34f2e8d0a6eb9f"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">Global_Parameters::pressure_load</a></div><div class="ttdeci">void pressure_load(const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; std::complex&lt; double &gt; &gt; &amp;traction)</div><div class="ttdoc">Constant pressure load (real and imag part)</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00130">unstructured_time_harmonic_elastic_annulus.cc:130</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a20fccdcfa2c15ad8b951b9ada3bb1661"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00053">time_harmonic_elastic_annulus.cc:53</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a301ab922df72030c660b21328d6caf76"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a></div><div class="ttdeci">string Directory</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00097">time_harmonic_elastic_annulus.cc:97</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a31fb55c20db4aa0127aafa20f0d76731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00081">time_harmonic_elastic_annulus.cc:81</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a4c035035889b93588b44f7778bb27ef9"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a4c035035889b93588b44f7778bb27ef9">Global_Parameters::Omega_sq_region</a></div><div class="ttdeci">Vector&lt; double &gt; Omega_sq_region(2, Omega_sq)</div><div class="ttdoc">Square of non-dim frequency for the two regions.</div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a73c731fa617a9d92851e4195493262e7"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a></div><div class="ttdeci">Vector&lt; TimeHarmonicIsotropicElasticityTensor * &gt; E_pt</div><div class="ttdoc">The elasticity tensors for the two regions.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00118">unstructured_time_harmonic_elastic_annulus.cc:118</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_af9e1e178dfb7f5e35b452599bd4c4324"><div class="ttname"><a href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a></div><div class="ttdeci">double Omega_sq</div><div class="ttdoc">Square of non-dim frequency.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00056">time_harmonic_elastic_annulus.cc:56</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_afbe27ad463a1fb23cb99d029a9fac731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Global_Parameters::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdoc">Peakiness parameter for pressure load.</div><div class="ttdef"><b>Definition</b> <a href="unstructured__time__harmonic__elastic__annulus_8cc_source.html#l00127">unstructured_time_harmonic_elastic_annulus.cc:127</a></div></div>
<div class="ttc" id="atime__harmonic__elastic__annulus_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="time__harmonic__elastic__annulus_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver for annular disk loaded by pressure.</div><div class="ttdef"><b>Definition</b> <a href="time__harmonic__elastic__annulus_8cc_source.html#l00646">time_harmonic_elastic_annulus.cc:646</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
<center> <a href="../../../../demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/">demo_drivers/time_harmonic_linear_elasticity/elastic_annulus </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
<center> <a href="../../../../demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/unstructured_time_harmonic_elastic_annulus.cc">demo_drivers/time_harmonic_linear_elasticity/elastic_annulus/unstructured_time_harmonic_elastic_annulus.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. \ </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Tue Jan 13 2026 16:35:05
        </div>
      </div>
    </footer>
</body>
</html>

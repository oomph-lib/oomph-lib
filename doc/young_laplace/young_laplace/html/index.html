<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Example problem: The Young Laplace equation</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Example problem: The Young Laplace equation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This document discusses the finite-element-based solution of the <a href="http://en.wikipedia.org/wiki/Young-Laplace_equation">Young Laplace equation</a>, a nonlinear PDE that determines the static equilibrium shapes of droplets or bubbles. We start by reviewing the relevant theory and then present the solution of a simple model problem.</p>
<center> <table border="1," width="500px">
<tr>
<td bgcolor="cornsilk"><center> <b>Acknowledgement:</b> </center> This tutorial and the associated driver codes were developed jointly with Cedric Ody (Ecole Polytechnique, Paris; now Rennes). <br  />
<br  />
  </td></tr>
</table>
</center><h1><a class="anchor" id="theory"></a>
Theory</h1>
<p>The figure below illustrates a representative problem: A small droplet is extruded slowly from the outlet of a cylindrical tube. The air-liquid interface is pinned at the end of the tube. We assume that the size of the droplet and the rate of extrusion are so small that gravitational, viscous and inertial forces may be neglected compared to the interfacial forces acting at the air-liquid interface.</p>
<div class="image">
<img src="spherical_cap.gif" alt=""/>
<div class="caption">
A typical problem: The extrusion of a small droplet from a cylindrical tube. </div></div>
 <p>The shape of the air-liquid interface (the meniscus) is then determined by Laplace's law which expresses the balance between the (spatially constant) pressure drop across the meniscus, <img class="formulaInl" alt="$ \Delta p^* $" src="form_0.png" width="21" height="13"/>, and the surface tension forces acting at the air-liquid interface, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Delta p^* = \sigma \kappa^*, \]" src="form_1.png" width="63" height="13"/>
</p>
<p> where <img class="formulaInl" alt="$ \kappa^* $" src="form_2.png" width="11" height="10"/> is the mean curvature and <img class="formulaInl" alt="$ \sigma $" src="form_3.png" width="8" height="6"/> the surface tension.</p>
<p>Non-dimensionalising all lengths on some problem-specific lengthscale <img class="formulaInl" alt="$ {\cal L} $" src="form_4.png" width="10" height="10"/> (e.g. the radius of the cylindrical tube) and scaling the pressure on the associated capillary scale, <img class="formulaInl" alt="$ \Delta p^* = \sigma/{\cal L} \ \Delta p $" src="form_5.png" width="83" height="14"/>, yields the non-dimensional form of the Young-Laplace equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Delta p = \kappa. \]" src="form_6.png" width="44" height="13"/>
</p>
<p> This must be augmented by suitable boundary conditions, to be applied at the contact line &ndash; the line along which the meniscus meets the solid surface. We can either "pin" the position of the contact line (as in the above example), or prescribe the <br  />
 <a href="http://en.wikipedia.org/wiki/Contact_angle">contact angle</a> at which the air-liquid interface meets the solid surface.</p>
<p>The mathematical problem may be interpreted as follows: Given the prescribed pressure drop <img class="formulaInl" alt="$ \Delta p $" src="form_7.png" width="16" height="13"/> (and thus <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/>), we wish to determine an interface shape of the required mean curvature <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/> that satisfies the boundary conditions along the contact line.</p>
<h2><a class="anchor" id="cartesian"></a>
Cartesian PDE-based formulation</h2>
<p>Expressing the (non-dimensional) height of the interface above the <img class="formulaInl" alt="$ (x_1, x_2) $" src="form_9.png" width="40" height="14"/>-plane as <img class="formulaInl" alt="$ x_3 = u(x_1,x_2) $" src="form_10.png" width="78" height="14"/> yields the cartesian form of the Young-Laplace equation: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}}, \]" src="form_11.png" width="156" height="33"/>
</p>
<p> where <img class="formulaInl" alt="$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T $" src="form_12.png" width="116" height="15"/> Given the imposed pressure drop across the interface, this equation must be solved for <img class="formulaInl" alt="$ u(x_1, x_2) $" src="form_13.png" width="48" height="14"/>. Note that this is only possible if the interface can be projected onto the <img class="formulaInl" alt="$ (x_1, x_2) $" src="form_9.png" width="40" height="14"/>-plane.</p>
<h2><a class="anchor" id="pvd"></a>
The principle of virtual displacements</h2>
<p>The interface shape can also be determined from the <a href="http://en.wikipedia.org/wiki/Virtual_displacement">principle of virtual displacements</a> </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \delta \left( \int_S \mathit{\, d} s \right)= \int_S \Delta p {\bf N} \cdot \delta {\bf N} \mathit{\, d} s + \oint_{L} \ \ {\bf T}_n \cdot \delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ (1) \]" src="form_14.png" width="321" height="31"/>
</p>
<p> which may be derived from energetic considerations. Here the symbol <img class="formulaInl" alt="$ \delta $" src="form_15.png" width="6" height="10"/> denotes a variation, <img class="formulaInl" alt="$ {\bf R } $" src="form_16.png" width="13" height="10"/> is the position vector to the interface, and the vector <img class="formulaInl" alt="$ {\bf N} $" src="form_17.png" width="13" height="10"/> is the unit normal to the meniscus. The left hand side of this equation represents the variation of the interfacial energy during a virtual displacement, and <img class="formulaInl" alt="$ ds $" src="form_18.png" width="13" height="10"/> is an infinitesimal element of the meniscus surface, <img class="formulaInl" alt="$S$" src="form_19.png" width="9" height="10"/>. The terms on the right hand side represent the virtual work done by the pressure and the virtual work done by the surface tension forces acting at the free contact line, respectively. <img class="formulaInl" alt="$ dl $" src="form_20.png" width="10" height="10"/> is the length of an element of the contact line <img class="formulaInl" alt="$L$" src="form_21.png" width="9" height="10"/>, and <img class="formulaInl" alt="$ {\bf T}_n $" src="form_22.png" width="18" height="11"/> is the vector tangent to the interface and normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, <img class="formulaInl" alt="$ \delta {\bf R} = {\bf 0} $" src="form_23.png" width="40" height="10"/>, and the line integral vanishes.</p>
<p>The variational formulation of the problem is particularly convenient for a finite-element-based solution; see, e.g. the <a href="../../../solid/solid_theory/html/index.html#CartesianLagrangian">Solid Mechanics Theory document</a> for a discussion of how to discretise variational principles with finite elements. The variational and PDE-based formulations are, of course, related to each other: The Young-Laplace equation is the Euler-Lagrange equation of the variational principle.</p>
<h2><a class="anchor" id="intrinsic"></a>
Parametric representation</h2>
<p>To deal with cases in which the interface cannot be projected onto the <img class="formulaInl" alt="$ (x_1, x_2) $" src="form_9.png" width="40" height="14"/>-plane, we parametrise the meniscus by two intrinsic coordinates as <img class="formulaInl" alt="$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3$" src="form_24.png" width="79" height="15"/>, where <img class="formulaInl" alt="$(\zeta_1,\zeta_2) \in D \in { R}^2$" src="form_25.png" width="93" height="15"/>. Furthermore, we parametrise the domain boundary, <img class="formulaInl" alt="$\partial D$" src="form_26.png" width="18" height="10"/>, by a scalar coordinate <img class="formulaInl" alt="$\xi$" src="form_27.png" width="8" height="13"/> so that, </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\partial D} = \bigg\{ (\zeta_1,\zeta_2) \ \bigg| \ (\zeta_1,\zeta_2) = \left( \zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \]" src="form_28.png" width="271" height="31"/>
</p>
<p> The normal to the meniscus is then given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} } {\mathcal{A}^{1/2}}, \]" src="form_29.png" width="89" height="28"/>
</p>
<p> where the commas denote partial differentiation with respect to the intrinsic coordinates, and <img class="formulaInl" alt="$ \mathcal{A}^{1/2}= |{\bf R}_{,1} \times {\bf R}_{,2}| $" src="form_30.png" width="103" height="16"/> is the square root of the surface metric tensor.</p>
<p>The area and length differentials required in variational principle are </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \]" src="form_31.png" width="89" height="15"/>
</p>
<p> and </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ d l=\left| \frac{d {\bf R}\left( \zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi, \]" src="form_32.png" width="186" height="49"/>
</p>
<p> allowing us to write the principle of virtual displacements as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \int_S \left( \frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} - \kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2 = \oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left| \frac{d {\bf R}\left( \zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi. \]" src="form_33.png" width="429" height="49"/>
</p>
<h2><a class="anchor" id="spines"></a>
The method of spines</h2>
<p>In the current form, the variational principle cannot yield a unique solution because there are infinitely many vector fields <img class="formulaInl" alt="$ {\bf R}(\zeta_1,\zeta_2) $" src="form_34.png" width="49" height="14"/> that parametrise the same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the <img class="formulaInl" alt="$ (x_1,x_2) $" src="form_35.png" width="40" height="14"/>-plane, we employ the so-called "Method of Spines". This method was originally proposed by Kistler and Scriven for the computation of free surface flows. We decompose the vector <img class="formulaInl" alt="$ {\bf R} $" src="form_36.png" width="13" height="10"/> into two parts by writing it as </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf R}(\zeta_1,\zeta_2) = {\bf B}(\zeta_1,\zeta_2) + \mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \]" src="form_37.png" width="225" height="14"/>
</p>
<p> Here the "spine basis" <img class="formulaInl" alt="${\bf B}(\zeta_1,\zeta_2)$" src="form_38.png" width="48" height="14"/> and the "spines" <img class="formulaInl" alt="${\bf S}(\zeta_1,\zeta_2)$" src="form_39.png" width="44" height="14"/> are pre-determined vector fields that must be chosen by the user. Using this decomposition, the meniscus shape is determined by the scalar function <img class="formulaInl" alt="$\mathit{u}(\zeta_1,\zeta_2)$" src="form_40.png" width="44" height="14"/> which represents the meniscus' displacement along the spines <img class="formulaInl" alt="${\bf S}$" src="form_41.png" width="8" height="10"/>.</p>
<p>The idea is illustrated in the simple 2D sketch below: the spine basis vectors, <img class="formulaInl" alt="$ {\bf B}(\zeta), $" src="form_42.png" width="30" height="14"/> parametrise the straight line corresponding to a flat meniscus. Positive values of <img class="formulaInl" alt="$ u $" src="form_43.png" width="9" height="6"/> displace the meniscus along the spines, <img class="formulaInl" alt="$ {\bf S}(\zeta) $" src="form_44.png" width="23" height="14"/> (the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as <img class="formulaInl" alt="$ x_2 = u(x_1). $" src="form_45.png" width="63" height="14"/></p>
<div class="image">
<img src="spine_sketch.gif" alt=""/>
<div class="caption">
Sketch illustrating the parametrisation of the meniscus by the Method of Spines. </div></div>
 <p>The spine basis and the spines themselves must be chosen such that the mapping from <img class="formulaInl" alt="$(\zeta_1,\zeta_2)$" src="form_46.png" width="36" height="14"/> to <img class="formulaInl" alt="${\bf R}(\zeta_1,\zeta_2)$" src="form_47.png" width="49" height="14"/> is one-to-one, at least for the meniscus shapes of interest. Pinned boundary conditions of the form <img class="formulaInl" alt="$ \left. {\bf R}\right|_{\partial D} = {\bf R}_{\rm pinned} $" src="form_48.png" width="86" height="14"/> are most easily imposed by choosing the spine basis such that <img class="formulaInl" alt="$ \left. {\bf B}\right|_{\partial D} = {\bf R}_{\rm pinned}, $" src="form_49.png" width="89" height="14"/> implying that <img class="formulaInl" alt="$ \left. u\right|_{\partial D} = 0. $" src="form_50.png" width="51" height="14"/></p>
<p>The simplest possible choice for the spines and spine basis is one that returns the problem to its original cartesian formulation. This is achieved by setting <img class="formulaInl" alt="$ {\bf B}(\zeta_1,\zeta_2) = (\zeta_1,\zeta_2,0)^T $" src="form_51.png" width="121" height="15"/> and <img class="formulaInl" alt="$ {\bf S}(\zeta_1,\zeta_2) = (0,0,1)^T. $" src="form_52.png" width="111" height="15"/></p>
<h2><a class="anchor" id="displ"></a>
Displacement Control</h2>
<p>The Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure the convergence of the Newton iteration. In many cases good initial guesses can be provided by a simple, physically motivated continuation method. For instance in the model problem shown above, the computation was started by computing the solution for <img class="formulaInl" alt="$ \Delta p = \kappa = 0 $" src="form_53.png" width="63" height="13"/> &ndash; a flat interface. This solution was then used as the initial guess for the solution at a small positive value of <img class="formulaInl" alt="$ \Delta p $" src="form_7.png" width="16" height="13"/>. This process was continued, allowing us to compute strongly deformed meniscus shapes. This method works well, provided small increments in the control parameter <img class="formulaInl" alt="$ \Delta p $" src="form_7.png" width="16" height="13"/> (or equivalently, <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/>) create small changes in the interface shape. This is not always the case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the <a href="../../../beam/steady_ring/html/index.html">solid mechanics tutorials</a>. Rather than prescribing the pressure drop <img class="formulaInl" alt="$ \Delta p $" src="form_7.png" width="16" height="13"/> we prescribe the displacement of a control point on the meniscus and regard the pressure drop required to achieve this displacement as an unknown. Since the implementation of the method is very similar to that used for solid mechanics problems, we shall not discuss it in detail here but refer to the appropriate <a href="../../../beam/steady_ring/html/index.html">solid mechanics tutorial.</a></p>
<hr  />
 <hr  />
<h1><a class="anchor" id="barrel"></a>
An example problem: A barrel-shaped meniscus</h1>
<p>As an example, we consider the following problem: Fluid is extruded from an infinitely long, parallel-sided slot of width <img class="formulaInl" alt="$ 2a $" src="form_54.png" width="13" height="9"/>. If we assume that the air-liquid interface is pinned at the edges of the slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circular cylinder. If we characterise the meniscus' shape by its vertical displacement along the centreline, <img class="formulaInl" alt="$ H $" src="form_55.png" width="11" height="10"/>, the (dimensional) curvature of the air-liquid interface is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \kappa^* = \frac{2/a}{H/a + a/H}. \]" src="form_56.png" width="99" height="31"/>
</p>
<p> The plot of this function, shown in the right half of the figure below, may be interpreted as a "load-displacement
diagram" as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, <img class="formulaInl" alt="$ \Delta p = a \kappa^*. $" src="form_57.png" width="55" height="13"/></p>
<div class="image">
<img src="meniscus_sketch_and_limit_point.gif" alt=""/>
<div class="caption">
Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. </div></div>
 <p>The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at <img class="formulaInl" alt="$ a \kappa^* = 1 $" src="form_58.png" width="41" height="10"/> indicates that the maximum curvature of the meniscus is given by <img class="formulaInl" alt="$ \kappa_{max}^* = 1/a. $" src="form_59.png" width="66" height="14"/> This implies that the maximum (dimensional) pressure that the meniscus can withstand is given by <img class="formulaInl" alt="$ \Delta p^*_{max} = \sigma \kappa_{max}^* = \sigma/a $" src="form_60.png" width="126" height="14"/>.</p>
<p>The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/> in small increments. However, use of a displacement control approach, by prescribing <img class="formulaInl" alt="$ H $" src="form_55.png" width="11" height="10"/> while regarding <img class="formulaInl" alt="$ \Delta p $" src="form_7.png" width="16" height="13"/> (and thus <img class="formulaInl" alt="$\kappa$" src="form_61.png" width="8" height="6"/>) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which <img class="formulaInl" alt="$ H $" src="form_55.png" width="11" height="10"/> is increased in small increments.</p>
<p>This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configuration of the meniscus (corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines <img class="formulaInl" alt="$ y=0 $" src="form_62.png" width="30" height="11"/> and <img class="formulaInl" alt="$ y=1 $" src="form_63.png" width="30" height="11"/>, and symmetry (natural) boundary conditions were applied along the lines <img class="formulaInl" alt="$ x=0 $" src="form_64.png" width="31" height="9"/> and <img class="formulaInl" alt="$ x=1; $" src="form_65.png" width="34" height="11"/> see <a class="el" href="index.html#comm_ex">Comments and Exercises</a> for further details on the natural boundary conditions. As the pressure drop increases, the meniscus is deflected upwards until it reaches the configuration of maximum curvature when <img class="formulaInl" alt="$ H/a=1 $" src="form_66.png" width="46" height="14"/>. Beyond this point, the pressure drop has to be reduced to compute the "bulging" meniscus shapes obtained for <img class="formulaInl" alt="$ H/a &gt; 1. $" src="form_67.png" width="49" height="14"/></p>
<div class="image">
<img src="barrel.gif" alt=""/>
<div class="caption">
Deformation of a meniscus that is pinned along the lines y=0 and y=1. </div></div>
 <p>The comparison of the computed "load-displacement curve" against the exact solution, shown below, indicates that the two agree to within plotting accuracy.</p>
<div class="image">
<img src="trace.gif" alt=""/>
<div class="caption">
Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="impl"></a>
Implementation</h1>
<p>We shall now discuss the solution of the above problem with <code>oomph-lib's</code> Young Laplace elements.</p>
<h2><a class="anchor" id="namespace"></a>
The global namespace</h2>
<p>As usual we define the problem parameters in a global namespace. The key parameter is the value of the prescribed control displacement which we initialise to zero. The function <code><a class="el" href="namespaceGlobalParameters.html#a4571d41514b16946dd31d075d44c5593" title="Exact kappa.">get_exact_kappa()</a></code> returns the exact solution for the mean curvature of the meniscus. We will use this function for the validation of our results.</p>
 <div class="fragment"><div class="line"><span class="comment">//===== start_of_namespace========================================</span></div>
<div class="line"><span class="comment">/// Namespace for &quot;global&quot; problem parameters</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobalParameters.html">GlobalParameters</a></div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Displacement control:</span></div>
<div class="line"> <span class="comment">//----------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Height control value</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">Controlled_height</a> = 0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Exact kappa </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a4571d41514b16946dd31d075d44c5593">get_exact_kappa</a>()</div>
<div class="line"> { </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Mean curvature of barrel-shaped meniscus</span></div>
<div class="line">  <span class="keywordflow">return</span> 2.0*<a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">Controlled_height</a>/</div>
<div class="line">   (<a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">Controlled_height</a>*<a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">Controlled_height</a>+1.0/4.0);</div>
<div class="line"> </div>
<div class="line"> } <span class="comment">//end exact kappa</span></div>
<div class="ttc" id="anamespaceGlobalParameters_html"><div class="ttname"><a href="namespaceGlobalParameters.html">GlobalParameters</a></div><div class="ttdoc">Namespace for &quot;global&quot; problem parameters.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00044">barrel.cc:45</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a3731f24a02ce4f306d65a9a488f85c96"><div class="ttname"><a href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a></div><div class="ttdeci">double Controlled_height</div><div class="ttdoc">Height control value.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00051">barrel.cc:51</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a4571d41514b16946dd31d075d44c5593"><div class="ttname"><a href="namespaceGlobalParameters.html#a4571d41514b16946dd31d075d44c5593">GlobalParameters::get_exact_kappa</a></div><div class="ttdeci">double get_exact_kappa()</div><div class="ttdoc">Exact kappa.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00054">barrel.cc:54</a></div></div>
</div><!-- fragment --><p> Next we define the orientation of the spines. Anticipating the shape of the meniscus, we set <img class="formulaInl" alt="$ {\bf B}(\zeta_1,\zeta_2)= (\zeta_1,\zeta_2,0) $" src="form_68.png" width="114" height="14"/> so that <img class="formulaInl" alt="$ u=0 $" src="form_69.png" width="31" height="9"/> corresponds to a flat meniscus in the <img class="formulaInl" alt="$ (x,y) $" src="form_70.png" width="28" height="14"/>-plane,</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Spine basis</span></div>
<div class="line"> <span class="comment">//------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Spine basis: The position vector to the basis of the spine</span></div>
<div class="line"><span class="comment"> /// as a function of the two coordinates x_1 and x_2, and its</span></div>
<div class="line"><span class="comment"> /// derivatives w.r.t. to these coordinates. </span></div>
<div class="line"><span class="comment"> /// dspine_B[i][j] = d spine_B[j] / dx_i</span></div>
<div class="line"><span class="comment"> /// Spines start in the (x_1,x_2) plane at (x_1,x_2).</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobalParameters.html#ac81daf87f8d3f075d9fd108427e70c4f">spine_base_function</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, </div>
<div class="line">                          Vector&lt;double&gt;&amp; spine_B, </div>
<div class="line">                          Vector&lt; Vector&lt;double&gt; &gt;&amp; dspine_B)</div>
<div class="line"> {</div>
<div class="line">  </div>
<div class="line">  <span class="comment">// Bspines and derivatives </span></div>
<div class="line">  spine_B[0]     = x[0];</div>
<div class="line">  spine_B[1]     = x[1];</div>
<div class="line">  spine_B[2]     = 0.0 ;</div>
<div class="line">  dspine_B[0][0] = 1.0 ;</div>
<div class="line">  dspine_B[1][0] = 0.0 ;</div>
<div class="line">  dspine_B[0][1] = 0.0 ; </div>
<div class="line">  dspine_B[1][1] = 1.0 ;</div>
<div class="line">  dspine_B[0][2] = 0.0 ;</div>
<div class="line">  dspine_B[1][2] = 0.0 ;</div>
<div class="line">  </div>
<div class="line"> } <span class="comment">// End of bspine functions</span></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ac81daf87f8d3f075d9fd108427e70c4f"><div class="ttname"><a href="namespaceGlobalParameters.html#ac81daf87f8d3f075d9fd108427e70c4f">GlobalParameters::spine_base_function</a></div><div class="ttdeci">void spine_base_function(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;spine_B, Vector&lt; Vector&lt; double &gt; &gt; &amp;dspine_B)</div><div class="ttdoc">Spine basis: The position vector to the basis of the spine as a function of the two coordinates x_1 a...</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00072">barrel.cc:72</a></div></div>
</div><!-- fragment --><p> and rotate the spines in the <img class="formulaInl" alt="$ y $" src="form_71.png" width="8" height="9"/> direction by setting </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf S}(\zeta_1,\zeta_2) = \left( \begin{array}{c} 0 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right) \]" src="form_72.png" width="161" height="46"/>
</p>
<p> where <img class="formulaInl" alt="$ \alpha(\zeta_2) = \alpha_{min} + (\alpha_{max}-\alpha_{min}) \zeta_2 $" src="form_73.png" width="179" height="14"/>. With this choice, the spines are unit vectors that form an angle <img class="formulaInl" alt="$ \alpha $" src="form_74.png" width="8" height="6"/> (varying between <img class="formulaInl" alt="$ \alpha_{min} $" src="form_75.png" width="26" height="9"/> and <img class="formulaInl" alt="$ \alpha_{max} $" src="form_76.png" width="28" height="9"/>) with the y-axis.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Spines rotate in the y-direction</span></div>
<div class="line"> <span class="comment">//---------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Min. spine angle against horizontal plane</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a> = MathematicalConstants::Pi/2.0*1.5;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Max. spine angle against horizontal plane</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a> = MathematicalConstants::Pi/2.0*0.5;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Spine: The spine vector field as a function of the two </span></div>
<div class="line"><span class="comment"> /// coordinates x_1 and x_2, and its derivatives w.r.t. to these coordinates:</span></div>
<div class="line"><span class="comment"> /// dspine[i][j] = d spine[j] / dx_i</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobalParameters.html#a82df8c67f58e78a236fb6a0cc8bf8284">spine_function</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; x, </div>
<div class="line">                     Vector&lt;double&gt;&amp; spine, </div>
<div class="line">                     Vector&lt; Vector&lt;double&gt; &gt;&amp; dspine)</div>
<div class="line"> {</div>
<div class="line">  <span class="comment"></span></div>
<div class="line"><span class="comment">  /// Spines (and derivatives)  are independent of x[0] and rotate </span></div>
<div class="line"><span class="comment">  /// in the x[1]-direction</span></div>
<div class="line"><span class="comment"></span>  spine[0]=0.0;</div>
<div class="line">  dspine[0][0]=0.0; </div>
<div class="line">  dspine[1][0]=0.0; </div>
<div class="line">  </div>
<div class="line">  spine[1]=cos(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*x[1]); </div>
<div class="line">  dspine[0][1]=0.0;                                   </div>
<div class="line">  dspine[1][1]=-sin(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*x[1])</div>
<div class="line">   *(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>);            </div>
<div class="line">  </div>
<div class="line">  spine[2]=sin(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*x[1]);</div>
<div class="line">  dspine[0][2]=0.0;                                  </div>
<div class="line">  dspine[1][2]=cos(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*x[1]) </div>
<div class="line">   *(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>);            </div>
<div class="line"> </div>
<div class="line"> } <span class="comment">// End spine function</span></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a19d04a02b0b5ef5c72e9c30d822e4dc7"><div class="ttname"><a href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">GlobalParameters::Alpha_max</a></div><div class="ttdeci">double Alpha_max</div><div class="ttdoc">Max. spine angle against horizontal plane.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00099">barrel.cc:99</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a82df8c67f58e78a236fb6a0cc8bf8284"><div class="ttname"><a href="namespaceGlobalParameters.html#a82df8c67f58e78a236fb6a0cc8bf8284">GlobalParameters::spine_function</a></div><div class="ttdeci">void spine_function(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;spine, Vector&lt; Vector&lt; double &gt; &gt; &amp;dspine)</div><div class="ttdoc">Spine: The spine vector field as a function of the two coordinates x_1 and x_2, and its derivatives w...</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00104">barrel.cc:104</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ae8fa7610a34b7a2a8223eade99a5c22f"><div class="ttname"><a href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">GlobalParameters::Alpha_min</a></div><div class="ttdeci">double Alpha_min</div><div class="ttdoc">Min. spine angle against horizontal plane.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00096">barrel.cc:96</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h2><a class="anchor" id="main"></a>
The driver code</h2>
<p>We start by preparing an output directory and open a trace file to record the control displacement, and the computed and exact values of the interface curvature <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/>.</p>
 <div class="fragment"><div class="line"><span class="comment">//===================start_of_main========================================</span></div>
<div class="line"><span class="comment">/// Driver code</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="barrel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create label for output</span></div>
<div class="line"> DocInfo doc_info;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set output directory</span></div>
<div class="line"> doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Open a trace file</span></div>
<div class="line"> ofstream trace_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"> trace_file.open(filename);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Write kappa, exact kappa and height values</span></div>
<div class="line"> trace_file</div>
<div class="line">  &lt;&lt; <span class="stringliteral">&quot;VARIABLES=\&quot;&lt;GREEK&gt;k&lt;/GREEK&gt;\&quot;,\&quot;&lt;GREEK&gt;k&lt;/GREEK&gt;_{ex}\&quot;,\&quot;h\&quot;&quot;</span> </div>
<div class="line">  &lt;&lt; std::endl;</div>
<div class="line"> trace_file &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="ttc" id="abarrel_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="barrel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver code.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00321">barrel.cc:321</a></div></div>
</div><!-- fragment --><p> Next we build the problem object and document the initial configuration: a flat meniscus.</p>
<div class="fragment"><div class="line">  </div>
<div class="line"> <span class="comment">// Create the problem</span></div>
<div class="line"> <span class="comment">//-------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create the problem with 2D nine-node elements from the</span></div>
<div class="line"> <span class="comment">// QYoungLaplaceElement family. </span></div>
<div class="line"> <a class="code" href="classYoungLaplaceProblem.html">YoungLaplaceProblem&lt;QYoungLaplaceElement&lt;3&gt;</a> &gt; problem;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Output the solution</span></div>
<div class="line"> problem.<a class="code" href="classYoungLaplaceProblem.html#a16f10e66457718eca76d1335dbed8f12">doc_solution</a>(doc_info,trace_file);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Increment counter for solutions </span></div>
<div class="line"> doc_info.number()++;</div>
<div class="ttc" id="aclassYoungLaplaceProblem_html"><div class="ttname"><a href="classYoungLaplaceProblem.html">YoungLaplaceProblem</a></div><div class="ttdoc">2D YoungLaplace problem on rectangular domain, discretised with 2D QYoungLaplace elements....</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00139">barrel.cc:140</a></div></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_a16f10e66457718eca76d1335dbed8f12"><div class="ttname"><a href="classYoungLaplaceProblem.html#a16f10e66457718eca76d1335dbed8f12">YoungLaplaceProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info, ofstream &amp;trace_file)</div><div class="ttdoc">Doc the solution. DocInfo object stores flags/labels for where the output gets written to and the tra...</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00291">barrel.cc:291</a></div></div>
</div><!-- fragment --><p> Finally, we perform a parameter study by increasing the control displacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parameter incrementation</span></div>
<div class="line"> <span class="comment">//------------------------- </span></div>
<div class="line"> <span class="keywordtype">double</span> increment=0.1;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over steps</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nstep=2; <span class="comment">// 10;</span></div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line">  {</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Increment prescribed height value</span></div>
<div class="line">   <a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a>+=increment;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Solve the problem</span></div>
<div class="line">   problem.newton_solve();</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Output the solution</span></div>
<div class="line">   problem.<a class="code" href="classYoungLaplaceProblem.html#a16f10e66457718eca76d1335dbed8f12">doc_solution</a>(doc_info,trace_file);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Increment counter for solutions </span></div>
<div class="line">   doc_info.number()++;</div>
<div class="line">   </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Close output file</span></div>
<div class="line"> trace_file.close();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of main</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h2><a class="anchor" id="class"></a>
The problem class</h2>
<p>The problem class has the usual member functions. (Ignore the lines in <code>actions_before_newton_solve()</code> as they are irrelevant in the current context. They are discussed in one of the exercises in <a class="el" href="index.html#comm_ex">Comments and Exercises</a>.) The problem's private member data include a pointer to the node at which the meniscus displacement is controlled by the displacement control element, and a pointer to the <code>Data</code> object whose one-and-only value contains the unknown interface curvature, <img class="formulaInl" alt="$ \kappa. $" src="form_77.png" width="10" height="6"/></p>
 <div class="fragment"><div class="line"><span class="comment">//====== start_of_problem_class=======================================</span></div>
<div class="line"><span class="comment">/// 2D YoungLaplace problem on rectangular domain, discretised with</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// 2D QYoungLaplace elements. The specific type of element is</span></div>
<div class="line"><span class="comment"></span><span class="comment">/// specified via the template parameter.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt; </div>
<div class="line"><span class="keyword">class </span><a class="code" href="classYoungLaplaceProblem.html">YoungLaplaceProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor: </span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classYoungLaplaceProblem.html#a4ea552f351994849e9ab597ef2da797a">YoungLaplaceProblem</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classYoungLaplaceProblem.html#aa3482606bfd86a3db9d2dec86ba75f14">~YoungLaplaceProblem</a>(){}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update the problem before solve </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classYoungLaplaceProblem.html#a93dd45313d28c3b9b0b51e34d14ebd24">actions_before_newton_solve</a>()</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// This only has an effect if displacement control is disabled</span></div>
<div class="line">   <span class="keywordtype">double</span> new_kappa=<a class="code" href="classYoungLaplaceProblem.html#a78d1ae3b73777674003b2c9794ea9b43">Kappa_pt</a>-&gt;value(0)-0.5;</div>
<div class="line">   <a class="code" href="classYoungLaplaceProblem.html#a78d1ae3b73777674003b2c9794ea9b43">Kappa_pt</a>-&gt;set_value(0,new_kappa);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update the problem after solve: Empty</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classYoungLaplaceProblem.html#a8eed49ad1c6247cc293a584ab9262efc">actions_after_newton_solve</a>(){}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Doc the solution. DocInfo object stores flags/labels for where the</span></div>
<div class="line"><span class="comment"> /// output gets written to and the trace file</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classYoungLaplaceProblem.html#a16f10e66457718eca76d1335dbed8f12">doc_solution</a>(DocInfo&amp; doc_info, ofstream&amp; trace_file);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Node at which the height (displacement along spine) is controlled/doced</span></div>
<div class="line"><span class="comment"></span> Node* <a class="code" href="classYoungLaplaceProblem.html#a1d659f1b2d73140a5d52889f9581d12f">Control_node_pt</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to Data object that stores the prescribed curvature</span></div>
<div class="line"><span class="comment"></span> Data* <a class="code" href="classYoungLaplaceProblem.html#a78d1ae3b73777674003b2c9794ea9b43">Kappa_pt</a>;</div>
<div class="line"> </div>
<div class="line">}; <span class="comment">// end of problem class</span></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_a1d659f1b2d73140a5d52889f9581d12f"><div class="ttname"><a href="classYoungLaplaceProblem.html#a1d659f1b2d73140a5d52889f9581d12f">YoungLaplaceProblem::Control_node_pt</a></div><div class="ttdeci">Node * Control_node_pt</div><div class="ttdoc">Node at which the height (displacement along spine) is controlled/doced.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00168">barrel.cc:168</a></div></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_a4ea552f351994849e9ab597ef2da797a"><div class="ttname"><a href="classYoungLaplaceProblem.html#a4ea552f351994849e9ab597ef2da797a">YoungLaplaceProblem::YoungLaplaceProblem</a></div><div class="ttdeci">YoungLaplaceProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00180">barrel.cc:180</a></div></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_a78d1ae3b73777674003b2c9794ea9b43"><div class="ttname"><a href="classYoungLaplaceProblem.html#a78d1ae3b73777674003b2c9794ea9b43">YoungLaplaceProblem::Kappa_pt</a></div><div class="ttdeci">Data * Kappa_pt</div><div class="ttdoc">Pointer to Data object that stores the prescribed curvature.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00171">barrel.cc:171</a></div></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_a8eed49ad1c6247cc293a584ab9262efc"><div class="ttname"><a href="classYoungLaplaceProblem.html#a8eed49ad1c6247cc293a584ab9262efc">YoungLaplaceProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem after solve: Empty.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00159">barrel.cc:159</a></div></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_a93dd45313d28c3b9b0b51e34d14ebd24"><div class="ttname"><a href="classYoungLaplaceProblem.html#a93dd45313d28c3b9b0b51e34d14ebd24">YoungLaplaceProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem before solve.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00151">barrel.cc:151</a></div></div>
<div class="ttc" id="aclassYoungLaplaceProblem_html_aa3482606bfd86a3db9d2dec86ba75f14"><div class="ttname"><a href="classYoungLaplaceProblem.html#aa3482606bfd86a3db9d2dec86ba75f14">YoungLaplaceProblem::~YoungLaplaceProblem</a></div><div class="ttdeci">~YoungLaplaceProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00148">barrel.cc:148</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h2><a class="anchor" id="constr"></a>
The problem constructor</h2>
<p>We start by building the mesh, discretising the two-dimensional parameter space <img class="formulaInl" alt="$ (\zeta_1,\zeta_2) \in [0,1] \times [0,1]$" src="form_78.png" width="116" height="14"/> with 8x8 elements.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====start_of_constructor===============================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Constructor for YoungLaplace problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a class="code" href="classYoungLaplaceProblem.html#a4ea552f351994849e9ab597ef2da797a">YoungLaplaceProblem&lt;ELEMENT&gt;::YoungLaplaceProblem</a>()</div>
<div class="line">{ </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup mesh</span></div>
<div class="line"> <span class="comment">//-----------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// # of elements in x-direction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_x=8;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// # of elements in y-direction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_y=8;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Domain length in x-direction</span></div>
<div class="line"> <span class="keywordtype">double</span> l_x=1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Domain length in y-direction</span></div>
<div class="line"> <span class="keywordtype">double</span> l_y=1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build and assign mesh</span></div>
<div class="line"> Problem::mesh_pt()=<span class="keyword">new</span> SimpleRectangularQuadMesh&lt;ELEMENT&gt;(n_x,n_y,l_x,l_y);</div>
</div><!-- fragment --><p> Next, we choose the central node in the mesh as the node whose displacement is imposed by the displacement control method.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Check that we&#39;ve got an even number of elements otherwise</span></div>
<div class="line"> <span class="comment">// out counting doesn&#39;t work...</span></div>
<div class="line"> <span class="keywordflow">if</span> ((n_x%2!=0)||(n_y%2!=0))</div>
<div class="line">  {</div>
<div class="line">   cout &lt;&lt; <span class="stringliteral">&quot;n_x n_y should be even&quot;</span> &lt;&lt; endl;</div>
<div class="line">   abort();</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line"> <span class="comment">//  This is the element that contains the central node:</span></div>
<div class="line"> ELEMENT* prescribed_height_element_pt= <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">  mesh_pt()-&gt;element_pt(n_y*n_x/2+n_x/2));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// The central node is node 0 in that element</span></div>
<div class="line"> Control_node_pt= <span class="keyword">static_cast&lt;</span>Node*<span class="keyword">&gt;</span>(prescribed_height_element_pt-&gt;node_pt(0));</div>
<div class="line"> </div>
<div class="line"> std::cout &lt;&lt; <span class="stringliteral">&quot;Controlling height at (x,y) : (&quot;</span> &lt;&lt; Control_node_pt-&gt;x(0) </div>
<div class="line">           &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; Control_node_pt-&gt;x(1)  &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; endl;</div>
</div><!-- fragment --><p> We pass the pointer to that node and the pointer to the double that specifies the imposed displacement to the constructor of the displacement control element. The constructor automatically creates a <code>Data</code> object whose one-and-only value stores the unknown curvature, <img class="formulaInl" alt="$ \kappa. $" src="form_77.png" width="10" height="6"/> We store the pointer to this <code>Data</code> object in the private member data to facilitate its output.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create a height control element</span></div>
<div class="line"> HeightControlElement* height_control_element_pt=<span class="keyword">new</span> HeightControlElement(</div>
<div class="line">  Control_node_pt,&amp;<a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Store pointer to kappa data</span></div>
<div class="line"> <a class="code" href="namespaceGlobalParameters.html#ac6234184cce40ab2c6bec92b37e4ae41">Kappa_pt</a>=height_control_element_pt-&gt;kappa_pt();</div>
<div class="ttc" id="anamespaceGlobalParameters_html_ac6234184cce40ab2c6bec92b37e4ae41"><div class="ttname"><a href="namespaceGlobalParameters.html#ac6234184cce40ab2c6bec92b37e4ae41">GlobalParameters::Kappa_pt</a></div><div class="ttdeci">Data * Kappa_pt</div><div class="ttdoc">Pointer to Data object that stores the prescribed curvature.</div><div class="ttdef"><b>Definition:</b> <a href="common__young__laplace__stuff_8h_source.html#l00064">common_young_laplace_stuff.h:64</a></div></div>
</div><!-- fragment --><p> The meniscus is pinned along mesh boundaries 0 and 2:</p>
<div class="fragment"><div class="line"> <span class="comment">// Boundary conditions</span></div>
<div class="line"> <span class="comment">//--------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set the boundary conditions for this problem: All nodes are</span></div>
<div class="line"> <span class="comment">// free by default -- only need to pin the ones that have Dirichlet conditions</span></div>
<div class="line"> <span class="comment">// here. </span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_bound = mesh_pt()-&gt;nboundary(); </div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;n_bound;b++)</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Pin meniscus displacement at all nodes boundaries  0 and 2</span></div>
<div class="line">   <span class="keywordflow">if</span> ((b==0)||(b==2))</div>
<div class="line">    {</div>
<div class="line">     <span class="keywordtype">unsigned</span> n_node = mesh_pt()-&gt;nboundary_node(b);</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line">      {</div>
<div class="line">       mesh_pt()-&gt;boundary_node_pt(b,n)-&gt;pin(0); </div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  } <span class="comment">// end bc</span></div>
</div><!-- fragment --><p> We complete the build of the Young Laplace elements by passing the pointer to the spine functions, and the prescribed curvature.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Complete build of elements</span></div>
<div class="line"> <span class="comment">//---------------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete the build of all elements so they are fully functional </span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nelement = mesh_pt()-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nelement;i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Upcast from GeneralsedElement to YoungLaplace element</span></div>
<div class="line">   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(mesh_pt()-&gt;element_pt(i));</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set the spine function pointers</span></div>
<div class="line">   el_pt-&gt;spine_base_fct_pt() = <a class="code" href="namespaceGlobalParameters.html#ac81daf87f8d3f075d9fd108427e70c4f">GlobalParameters::spine_base_function</a>;</div>
<div class="line">   el_pt-&gt;spine_fct_pt() =  <a class="code" href="namespaceGlobalParameters.html#a82df8c67f58e78a236fb6a0cc8bf8284">GlobalParameters::spine_function</a>;</div>
<div class="line">  </div>
<div class="line">   <span class="comment">// Set the curvature data for the element</span></div>
<div class="line">   el_pt-&gt;set_kappa(<a class="code" href="namespaceGlobalParameters.html#ac6234184cce40ab2c6bec92b37e4ae41">Kappa_pt</a>); </div>
<div class="line">  }</div>
</div><!-- fragment --><p> Finally, we add the displacement control element to the mesh and assign the equation numbers.</p>
<div class="fragment"><div class="line"> </div>
<div class="line"> <span class="comment">// Add the height control element to mesh (comment this out</span></div>
<div class="line"> <span class="comment">// if you&#39;re not using displacement control)</span></div>
<div class="line"> mesh_pt()-&gt;add_element_pt(height_control_element_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"> cout &lt;&lt;<span class="stringliteral">&quot;\nNumber of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; endl; </div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of constructor</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h2><a class="anchor" id="post"></a>
Postprocessing</h2>
<p>We document the exact and computed meniscus curvatures in the trace file and output the meniscus shape.</p>
<div class="fragment"><div class="line"><span class="comment">//===============start_of_doc=============================================</span></div>
<div class="line"><span class="comment">/// Doc the solution: doc_info contains labels/output directory etc.</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classYoungLaplaceProblem.html#a16f10e66457718eca76d1335dbed8f12">YoungLaplaceProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info,</div>
<div class="line">                                                ofstream&amp; trace_file)</div>
<div class="line">{ </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output kappa vs height of the apex </span></div>
<div class="line"> <span class="comment">//------------------------------------</span></div>
<div class="line"> trace_file &lt;&lt; -1.0*<a class="code" href="namespaceGlobalParameters.html#ac6234184cce40ab2c6bec92b37e4ae41">Kappa_pt</a>-&gt;value(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"> trace_file &lt;&lt; <a class="code" href="namespaceGlobalParameters.html#a4571d41514b16946dd31d075d44c5593">GlobalParameters::get_exact_kappa</a>()  &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"> trace_file &lt;&lt; Control_node_pt-&gt;value(0) ;</div>
<div class="line"> trace_file &lt;&lt; endl; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points: npts x npts</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> npts=5;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output full solution </span></div>
<div class="line"> <span class="comment">//---------------------</span></div>
<div class="line"> ofstream some_file;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line">         doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> mesh_pt()-&gt;output(some_file,npts);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of doc</span></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="comm_ex"></a>
Comments and Exercises</h1>
<ol type="1">
<li><b>Choice of spines:</b> <br  />
<br  />
 We discussed earlier that the spine basis and the spines themselves must be chosen such that the mapping from <img class="formulaInl" alt="$(\zeta_1,\zeta_2)$" src="form_46.png" width="36" height="14"/> to <img class="formulaInl" alt="${\bf R}(\zeta_1,\zeta_2)$" src="form_47.png" width="49" height="14"/> is one-to-one, at least for the meniscus shapes of interest. This requires some prior knowledge of the expected interface shapes. <br  />
 <br  />
 The spine basis and the spines must be defined via function pointers that are passed to the Young Laplace elements. If the function pointers are not specified, the Young-Laplace elements revert to a cartesian formulation. <br  />
<br  />
 Experiment with different spine orientations and explore the interface shapes that are obtained if no spines are specified (by commenting out the lines in the constructor that pass the relevant function pointers to the Young Laplace elements). <br  />
 <br  />
<br  />
</li>
<li><b>Natural boundary conditions:</b> <br  />
<br  />
 As usual in any finite-element computation, we only enforced the essential boundary conditions by pinning the meniscus displacement along the "pinned contact lines" at <img class="formulaInl" alt="$ y=0 $" src="form_62.png" width="30" height="11"/> and <img class="formulaInl" alt="$ y=1. $" src="form_79.png" width="34" height="11"/> No constraints were applied along the two other domain boundaries (at <img class="formulaInl" alt="$ x=0 $" src="form_64.png" width="31" height="9"/> and <img class="formulaInl" alt="$ x=1 $" src="form_80.png" width="30" height="9"/>), indicating that these boundaries are controlled by implied, "natural" boundary conditions. The variational principle (1) shows what these are: since we neglected the boundary integral on the right hand side of equation (1), the meniscus shape must satisfy <img class="formulaInl" alt="$ {\bf T}_n \cdot \delta {\bf R} = \delta u \ {\bf T}_n \cdot {\bf S} = 0, $" src="form_81.png" width="138" height="13"/> implying that outer unit normal to the meniscus boundary, <img class="formulaInl" alt="$ {\bf T}_n, $" src="form_82.png" width="21" height="11"/> must be orthogonal to the direction of the spines. Since the spines do not have an <img class="formulaInl" alt="$ x $" src="form_83.png" width="8" height="6"/> - component, the meniscus must therefore have zero slope in that direction &ndash; just what we need for our problem. <br  />
<br  />
 To convince yourself that the this argument is correct, rotate the spines in the <img class="formulaInl" alt="$ x $" src="form_83.png" width="8" height="6"/> -direction, e.g. by changing their definition to <p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf S}(\zeta_1,\zeta_2) = \left( \begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \]" src="form_84.png" width="171" height="46"/>
</p>
 The natural boundary condition will still force the meniscus to be normal to the spines along the "free" contact line, resulting in interface shapes similar to the one shown in the figure below. <div class="image">
<img src="funky_meniscus.gif" alt=""/>
<div class="caption">
Meniscus shape created by the natural boundary conditions when the spines (shown as vectors) are rotated in the x-direction. </div></div>
  This demonstrates yet again that the orientation of spines must reflect the relevant features of the problem. We refer to <a href="../../contact_angle/html/index.html">another tutorial</a> for a more detailed discussion of the boundary condition and its relation to contact angles. <br  />
<br  />
</li>
<li><b>Displacement control:</b> <br  />
<br  />
 Explore what happens if you disable displacement control and prescribe the pressure drop (i.e. <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/>) directly. The relevant code is already contained in the driver code. You'll have to comment out the lines in the problem constructor that create the displacement control element and the line that adds it to the problem's mesh. Replace them by the lines <br  />
<br  />
  <div class="fragment"><div class="line"> <span class="comment">// Comment out the previous two commands and uncomment the following two</span></div>
<div class="line"> <span class="comment">// to prescribe the pressure drop (the curvature) directly</span></div>
<div class="line"> <span class="comment">//Kappa_pt=new Data(1);</span></div>
<div class="line"> <span class="comment">//Kappa_pt-&gt;pin(0);</span></div>
</div><!-- fragment --> <br  />
<br  />
 which create the <code>Data</code> object that stores the prescribed curvature. (Note that the value of <img class="formulaInl" alt="$ \kappa $" src="form_8.png" width="8" height="6"/> is already incremented in <code>actions_before_newton_step()</code>. With displacement control this step has no real effect as the Newton method will overwrite this assignment). Check what happens if the prescribed curvature exceeds the maximum possible curvature of the meniscus. <br  />
<br  />
</li>
<li><b>Inefficient implementation:</b> <br  />
<br  />
 Note that the current implementation of the Young Laplace elements <br  />
 is inefficient as the elemental Jacobian matrices are computed by finite-differencing. You are invited to implement the analytical computation of the Jacobian matrix as an exercise. <br  />
<br  />
</li>
<li><b>Other problems:</b> <br  />
<br  />
 We provide a number of additional demo driver codes that demonstrate the solution of other, related problems. <br  />
<br  />
<ul>
<li>The code <br  />
<br  />
 <center> <a href="../../../../demo_drivers/young_laplace/young_laplace.cc">demo_drivers/young_laplace/young_laplace.cc </a> </center> <br  />
<br  />
 and its adaptive counterpart <br  />
<br  />
 <center> <a href="../../../../demo_drivers/young_laplace/refineable_young_laplace.cc">demo_drivers/young_laplace/refineable_young_laplace.cc </a> </center> <br  />
<br  />
 demonstrate the solution of three problems: (i) the barrel-shaped meniscus problem already discussed above; (ii) the deformation of a meniscus that is pinned at all four edges of a square tube; and (iii) the solution of a problem with contact-angle boundary conditions. The latter one is discussed in a <a href="../../contact_angle/html/index.html">separate tutorial.</a> <br  />
 <br  />
<br  />
</li>
<li>The spherical meniscus that emanates from a circular tube, shown in the animation at the beginning of current document, was computed with: <br  />
<br  />
 <center> <a href="../../../../demo_drivers/young_laplace/spherical_cap_in_cylinder.cc">demo_drivers/young_laplace/spherical_cap_in_cylinder.cc </a> </center> <br  />
<br  />
</li>
</ul>
</li>
</ol>
<hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
 <center> <a href="../../../../demo_drivers/young_laplace/">demo_drivers/young_laplace/ </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
 <center> <a href="../../../../demo_drivers/young_laplace/barrel.cc">demo_drivers/young_laplace/barrel.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:36:51
        </div>
      </div>
    </footer>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: refineable_t_junction.cc Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ddb094a380b94394dbbcf95a63b535e6.html">demo_drivers</a></li><li class="navelem"><a class="el" href="dir_14efc42db69fc9f754b8ef0f22a19e8b.html">young_laplace</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">refineable_t_junction.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="refineable__t__junction_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//LIC// Copyright (C) 2006-2021 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//LIC// </span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//LIC//====================================================================</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//Driver for refineable Young Laplace problem</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//Generic routines</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">// The YoungLaplace equations</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;young_laplace.h&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// The mesh</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;meshes/rectangular_quadmesh.h&quot;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">// Namespaces</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">using namespace </span>std;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">using namespace </span>oomph;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//======start_of_namespace========================================</span><span class="comment"></span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/// Namespace for &quot;global&quot; problem parameters</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGlobalParameters.html">GlobalParameters</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> /// Cos of contact angle </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#ae982fcb894e82c683d07d3c2fbbead3d">Cos_gamma</a>=cos(MathematicalConstants::Pi/6.0);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> /// Height control value for displacement control</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">Controlled_height</a> = 0.0;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> /// Length of domain</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a36ebf514fdd1e78fff69907b39e25af6">L_x</a> = 1.0; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> /// Width of domain</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a> = 5.0; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; <span class="comment">// Spine basis</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; <span class="comment">//------------</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> /// \short Spine basis: The position vector to the basis of the spine</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> /// as a function of the two coordinates x_1 and x_2, and its</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> /// derivatives w.r.t. to these coordinates. </span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> /// dspine_B[i][j] = d spine_B[j] / dx_i</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> /// Spines start in the (x_1,x_2) plane at (x_1,x_2).</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobalParameters.html#ac81daf87f8d3f075d9fd108427e70c4f">spine_base_function</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>, </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                          Vector&lt;double&gt;&amp; spine_B, </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                          Vector&lt; Vector&lt;double&gt; &gt;&amp; dspine_B)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">// Bspines and derivatives </span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  spine_B[0]     = <a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>[0];</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  spine_B[1]     = <a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>[1];</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  spine_B[2]     = 0.0 ;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  dspine_B[0][0] = 1.0 ;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  dspine_B[1][0] = 0.0 ;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  dspine_B[0][1] = 0.0 ; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  dspine_B[1][1] = 1.0 ;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  dspine_B[0][2] = 0.0 ;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  dspine_B[1][2] = 0.0 ;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; } <span class="comment">// End of bspine functions</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; <span class="comment">// Spines rotate in the y-direction</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; <span class="comment">//---------------------------------</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> /// Min. spine angle against horizontal plane</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a> = MathematicalConstants::Pi/2.0*1.5;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> /// Max. spine angle against horizontal plane</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a> = MathematicalConstants::Pi/2.0*0.5;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> /// \short Spine: The spine vector field as a function of the two </span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> /// coordinates x_1 and x_2, and its derivatives w.r.t. to these coordinates:</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> /// dspine[i][j] = d spine[j] / dx_i</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobalParameters.html#a82df8c67f58e78a236fb6a0cc8bf8284">spine_function</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; <a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>, </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                     Vector&lt;double&gt;&amp; spine, </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                     Vector&lt; Vector&lt;double&gt; &gt;&amp; dspine)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; {</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment"></span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">  /// Spines (and derivatives)  are independent of x[0] and rotate </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">  /// in the x[1]-direction</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"></span>  spine[0]=0.0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  dspine[0][0]=0.0; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  dspine[1][0]=0.0; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  spine[1]=cos(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*<a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>[1]/<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a>); </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  dspine[0][1]=0.0;                                   </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  dspine[1][1]=-sin(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*<a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>[1]/<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a>)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;   *(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)/<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a>;            </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  spine[2]=sin(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*<a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>[1]/<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  dspine[0][2]=0.0;                                  </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  dspine[1][2]=cos(<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>+(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)*<a class="code" href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a>[1]/<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a>) </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;   *(<a class="code" href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">Alpha_max</a>-<a class="code" href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">Alpha_min</a>)/<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">L_y</a>;            </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; } <span class="comment">// End spine function</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;} <span class="comment">// end of namespace</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">//====== start_of_problem_class=======================================</span><span class="comment"></span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">/// 2D RefineableYoungLaplace problem on rectangular domain, discretised with</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">/// 2D QRefineableYoungLaplace elements. The specific type of element is</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/// specified via the template parameter.</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span><span class="comment">//====================================================================</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt; </div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html">  138</a></span>&#160;<span class="keyword">class </span><a class="code" href="classRefineableYoungLaplaceProblem.html">RefineableYoungLaplaceProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> /// Constructor: </span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> <a class="code" href="classRefineableYoungLaplaceProblem.html">RefineableYoungLaplaceProblem</a>();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> /// Destructor (empty)</span></div>
<div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a24b45d5ecdd1d7dbb678e7f74777bf41">  147</a></span>&#160;<span class="comment"></span> <a class="code" href="classRefineableYoungLaplaceProblem.html#a24b45d5ecdd1d7dbb678e7f74777bf41">~RefineableYoungLaplaceProblem</a>(){};</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> /// Update the problem specs before solve: Empty</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a2807bb8cddbfa553df9f5dd170c8645d">  150</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#a2807bb8cddbfa553df9f5dd170c8645d">actions_before_newton_solve</a>(){};</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> /// Update the problem after solve: Empty</span></div>
<div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a0791c90a16016372e09faf3f5721ecbe">  153</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#a0791c90a16016372e09faf3f5721ecbe">actions_after_newton_solve</a>(){};</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> /// Actions before adapt: Wipe the mesh of contact angle elements</span></div>
<div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#ab64eb0b58beb3bb096ecc81b1a3f8a4f">  156</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#ab64eb0b58beb3bb096ecc81b1a3f8a4f">actions_before_adapt</a>()</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   <span class="comment">// Kill the contact angle elements and wipe contact angle mesh</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keywordflow">if</span> (Contact_angle_mesh_pt!=0) delete_contact_angle_elements();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;   <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;   rebuild_global_mesh();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> ///  Actions after adapt: Rebuild the mesh of contact angle elements</span></div>
<div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#aa2eab8da1b83091df804ede7c60fac87">  167</a></span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#aa2eab8da1b83091df804ede7c60fac87">actions_after_adapt</a>()</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;   create_contact_angle_elements(1);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;   create_contact_angle_elements(3);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;   </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;   <span class="comment">// Set function pointers for contact-angle elements</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;   <span class="keywordtype">unsigned</span> nel=Contact_angle_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    {</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;     <span class="comment">// Upcast from GeneralisedElement to YoungLaplace contact angle</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;     <span class="comment">// element</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;     YoungLaplaceContactAngleElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keyword">dynamic_cast&lt;</span>YoungLaplaceContactAngleElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;       Contact_angle_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;     </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;     <span class="comment">// Set the pointer to the prescribed contact angle</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;     el_pt-&gt;prescribed_cos_gamma_pt() = &amp;<a class="code" href="namespaceGlobalParameters.html#ae982fcb894e82c683d07d3c2fbbead3d">GlobalParameters::Cos_gamma</a>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;   </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;   <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;   rebuild_global_mesh();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;   </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> /// \short Doc the solution. DocInfo object stores flags/labels for where the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> /// output gets written to and the trace file</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> doc_solution(DocInfo&amp; doc_info, ofstream&amp; trace_file);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="keyword">private</span>:</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> /// \short Create YoungLaplace contact angle elements on the </span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> /// b-th boundary of the bulk mesh and add them to contact angle mesh</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> create_contact_angle_elements(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; b);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; <span class="comment"></span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> /// Delete contact angle elements </span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> <span class="keywordtype">void</span> delete_contact_angle_elements();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> /// Pointer to the &quot;bulk&quot; mesh</span></div>
<div class="line"><a name="l00205"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a251d9473d70dea7bfb36d9f0b4bb412d">  205</a></span>&#160;<span class="comment"></span> RefineableRectangularQuadMesh&lt;ELEMENT&gt;* <a class="code" href="classRefineableYoungLaplaceProblem.html#a251d9473d70dea7bfb36d9f0b4bb412d">Bulk_mesh_pt</a>;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> /// Pointer to the contact angle mesh</span></div>
<div class="line"><a name="l00208"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a36f5dc0f7071ac15fd63c7c477f77fb0">  208</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classRefineableYoungLaplaceProblem.html#a36f5dc0f7071ac15fd63c7c477f77fb0">Contact_angle_mesh_pt</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> /// Pointer to mesh containing the height control element</span></div>
<div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#ae2ae72b9b685c052b6a86892f64c2d85">  211</a></span>&#160;<span class="comment"></span> Mesh* <a class="code" href="classRefineableYoungLaplaceProblem.html#ae2ae72b9b685c052b6a86892f64c2d85">Height_control_mesh_pt</a>;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> /// Node at which the height (displacement along spine) is controlled/doced</span></div>
<div class="line"><a name="l00214"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#af14d838e5d4a1b9df2595bb08fa5e99d">  214</a></span>&#160;<span class="comment"></span> Node* <a class="code" href="classRefineableYoungLaplaceProblem.html#af14d838e5d4a1b9df2595bb08fa5e99d">Control_node_pt</a>;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> /// Pointer to Data object that stores the prescribed curvature</span></div>
<div class="line"><a name="l00217"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a0d667f8f0c41048740c5344619e27584">  217</a></span>&#160;<span class="comment"></span> Data* <a class="code" href="classRefineableYoungLaplaceProblem.html#a0d667f8f0c41048740c5344619e27584">Kappa_pt</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;}; <span class="comment">// end of problem class</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">//=====start_of_constructor===============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">/// Constructor for RefineableYoungLaplace problem</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00226"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a78f77a299f2770a82378fcccf86a0b71">  226</a></span>&#160;<a class="code" href="classRefineableYoungLaplaceProblem.html#a78f77a299f2770a82378fcccf86a0b71">RefineableYoungLaplaceProblem&lt;ELEMENT&gt;::RefineableYoungLaplaceProblem</a>()</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;{ </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; <span class="comment">// Setup bulk mesh</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; <span class="comment">//----------------</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; <span class="comment">// # of elements in x-direction</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; <span class="keywordtype">unsigned</span> n_x=8;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; <span class="comment">// # of elements in y-direction</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; <span class="keywordtype">unsigned</span> n_y=8;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; <span class="comment">// Domain length in x-direction</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; <span class="keywordtype">double</span> l_x=<a class="code" href="namespaceGlobalParameters.html#a36ebf514fdd1e78fff69907b39e25af6">GlobalParameters::L_x</a>;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; <span class="comment">// Domain length in y-direction</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; <span class="keywordtype">double</span> l_y=<a class="code" href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">GlobalParameters::L_y</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; <span class="comment">// Build and assign mesh</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; Bulk_mesh_pt=<span class="keyword">new</span> RefineableRectangularQuadMesh&lt;ELEMENT&gt;(n_x,n_y,l_x,l_y);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; <span class="comment">// Create/set error estimator</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; Bulk_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; <span class="comment">// Set targets for spatial adaptivity</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; Bulk_mesh_pt-&gt;max_permitted_error()=1.0e-4;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; Bulk_mesh_pt-&gt;min_permitted_error()=1.0e-6;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; <span class="comment">// Check that we&#39;ve got an even number of elements otherwise</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; <span class="comment">// out counting doesn&#39;t work...</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; <span class="keywordflow">if</span> ((n_x%2!=0)||(n_y%2!=0))</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;n_x n_y should be even&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;   abort();</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160; <span class="comment">//  This is the element that contains the central node:</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; ELEMENT* prescribed_height_element_pt= <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  Bulk_mesh_pt-&gt;element_pt(n_y*n_x/2+n_x/2));</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; <span class="comment">// The central node is node 0 in that element</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; Control_node_pt= <span class="keyword">static_cast&lt;</span>Node*<span class="keyword">&gt;</span>(prescribed_height_element_pt-&gt;node_pt(0));</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; std::cout &lt;&lt; <span class="stringliteral">&quot;Controlling height at (x,y) : (&quot;</span> &lt;&lt; Control_node_pt-&gt;x(0) </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;           &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; Control_node_pt-&gt;x(1)  &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; <span class="comment">// Create a height control element and store the</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; <span class="comment">// pointer to the Kappa Data created by this object</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; HeightControlElement* height_control_element_pt=<span class="keyword">new</span> HeightControlElement(</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  Control_node_pt,&amp;<a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; <span class="comment">// Add to mesh</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; Height_control_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; Height_control_mesh_pt-&gt;add_element_pt(height_control_element_pt);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; <span class="comment">// Store curvature data</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; <a class="code" href="young__laplace_8txt.html#ad085028866de0dfb37173803eabff340">Kappa_pt</a>=height_control_element_pt-&gt;kappa_pt();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; </div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <span class="comment">// Contact angle elements</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; <span class="comment">// Create prescribed-contact-angle elements from all elements that are </span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="comment">// adjacent to boundary 1 and 3 and add them to their own mesh</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; <span class="comment">// set up new mesh</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; Contact_angle_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; <span class="comment">// creation of contact angle elements</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; create_contact_angle_elements(1);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160; create_contact_angle_elements(3);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; <span class="comment">// Add various meshes and build the global mesh</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; <span class="comment">//----------------------------------------------</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; add_sub_mesh(Bulk_mesh_pt);</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; add_sub_mesh(Height_control_mesh_pt);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; add_sub_mesh(Contact_angle_mesh_pt);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; build_global_mesh();</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; <span class="comment">// Boundary conditions</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; <span class="comment">//--------------------</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; <span class="comment">// Set the boundary conditions for this problem: All nodes are</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160; <span class="comment">// free by default -- only need to pin the ones that have Dirichlet conditions</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; <span class="comment">// here. </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; <span class="keywordtype">unsigned</span> n_bound = Bulk_mesh_pt-&gt;nboundary(); </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> b=0;b&lt;n_bound;b++)</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   <span class="comment">// Pin all boundaries for three cases and only boundaries</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="comment">// 0 and 2 in all others:</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="keywordflow">if</span> ((b==0)||(b==2))</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     <span class="keywordtype">unsigned</span> n_node = Bulk_mesh_pt-&gt;nboundary_node(b);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> n=0;n&lt;n_node;n++)</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;       Bulk_mesh_pt-&gt;boundary_node_pt(b,n)-&gt;pin(0); </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;      }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  } <span class="comment">// end bcs</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; <span class="comment">// Complete build of elements</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; <span class="comment">//---------------------------</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; <span class="comment">// Complete the build of all elements so they are fully functional </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; <span class="keywordtype">unsigned</span> n_bulk=Bulk_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_bulk;i++)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;   <span class="comment">// Upcast from GeneralsedElement to the present element</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;   ELEMENT *el_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(Bulk_mesh_pt-&gt;element_pt(i));</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="comment">//Set the spine function pointers</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   el_pt-&gt;spine_base_fct_pt() = <a class="code" href="namespaceGlobalParameters.html#ac81daf87f8d3f075d9fd108427e70c4f">GlobalParameters::spine_base_function</a>;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   el_pt-&gt;spine_fct_pt() =  <a class="code" href="namespaceGlobalParameters.html#a82df8c67f58e78a236fb6a0cc8bf8284">GlobalParameters::spine_function</a>;</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="comment">// Set the curvature data for the element</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   el_pt-&gt;set_kappa(<a class="code" href="young__laplace_8txt.html#ad085028866de0dfb37173803eabff340">Kappa_pt</a>); </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  }</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; <span class="comment">// Set function pointers for contact-angle elements</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; <span class="keywordtype">unsigned</span> nel=Contact_angle_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to YoungLaplace contact angle </span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;   <span class="comment">// element</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;   YoungLaplaceContactAngleElement&lt;ELEMENT&gt; *el_pt = </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>YoungLaplaceContactAngleElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;     Contact_angle_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;   </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;   <span class="comment">// Set the pointer to the prescribed contact angle</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;   el_pt-&gt;prescribed_cos_gamma_pt() = &amp;<a class="code" href="namespaceGlobalParameters.html#ae982fcb894e82c683d07d3c2fbbead3d">GlobalParameters::Cos_gamma</a>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; <span class="comment">// Setup equation numbering scheme</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; cout &lt;&lt;<span class="stringliteral">&quot;\nNumber of equations: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; endl; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; cout &lt;&lt; <span class="stringliteral">&quot;\n********************************************\n&quot;</span> &lt;&lt;  endl;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;} <span class="comment">// end of constructor</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">//============start_of_create_contact_angle_elements=====================</span><span class="comment"></span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">/// Create YoungLaplace contact angle elements on the b-th boundary of the </span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">/// bulk mesh and add them to the contact angle mesh</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a00d1304e030120e76d9f316dd4053116">  373</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#a00d1304e030120e76d9f316dd4053116">RefineableYoungLaplaceProblem&lt;ELEMENT&gt;::create_contact_angle_elements</a>(</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; <span class="keyword">const</span> <span class="keywordtype">unsigned</span> &amp;b)</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; <span class="keywordtype">unsigned</span> n_element = Bulk_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;   ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    Bulk_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   <span class="comment">// What is the index of the face of the bulk element at the boundary</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   <span class="keywordtype">int</span> face_index = Bulk_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;   </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;   <span class="comment">// Build the corresponding contact angle element</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;   YoungLaplaceContactAngleElement&lt;ELEMENT&gt;* contact_angle_element_pt = <span class="keyword">new</span> </div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;   YoungLaplaceContactAngleElement&lt;ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;   <span class="comment">//Add the contact angle element to the contact angle mesh</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;   Contact_angle_mesh_pt-&gt;add_element_pt(contact_angle_element_pt);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  } <span class="comment">//end of loop over bulk elements adjacent to boundary b</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;} <span class="comment">// end of create_contact_angle_elements</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment">//============start_of_delete_contact_angle_elements=====================</span><span class="comment"></span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">/// Delete YoungLaplace contact angle elements</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00405"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#aaa270ba8da395897a5a99d052f076e0c">  405</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#aaa270ba8da395897a5a99d052f076e0c">RefineableYoungLaplaceProblem&lt;ELEMENT&gt;::delete_contact_angle_elements</a>()</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;{</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; <span class="comment">// How many contact angle elements are there?</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; <span class="keywordtype">unsigned</span> n_element = Contact_angle_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; <span class="comment">// Loop over the surface elements</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;   <span class="comment">// Kill surface element</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;   <span class="keyword">delete</span> Contact_angle_mesh_pt-&gt;element_pt(e);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; <span class="comment">// Wipe the mesh</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; Contact_angle_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;} <span class="comment">// end of delete_contact_angle_elements</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">//===============start_of_doc=============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">/// Doc the solution: doc_info contains labels/output directory etc.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="keyword">template</span>&lt;<span class="keyword">class</span> ELEMENT&gt;</div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classRefineableYoungLaplaceProblem.html#a4ec7313c8e4015b0c2af0bbef789e70f">  430</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classRefineableYoungLaplaceProblem.html#a4ec7313c8e4015b0c2af0bbef789e70f">RefineableYoungLaplaceProblem&lt;ELEMENT&gt;::doc_solution</a>(DocInfo&amp; doc_info,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                              ofstream&amp; trace_file)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;{ </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160; <span class="comment">// Output kappa vs height</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; <span class="comment">//-----------------------</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; trace_file &lt;&lt; -1.0*<a class="code" href="young__laplace_8txt.html#ad085028866de0dfb37173803eabff340">Kappa_pt</a>-&gt;value(0) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; trace_file &lt;&lt; Control_node_pt-&gt;value(0) ;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; trace_file &lt;&lt; endl;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;  </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; <span class="comment">// Number of plot points: npts x npts</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; <span class="keywordtype">unsigned</span> npts=5;</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; <span class="comment">// Output full solution </span></div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; <span class="comment">//---------------------</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; ofstream some_file;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; <span class="comment">//YoungLaplaceEquations::Output_meniscus_and_spines=false;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/soln%i.dat&quot;</span>,doc_info.directory().c_str(),</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; some_file.open(filename);</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; Bulk_mesh_pt-&gt;output(some_file,npts);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; some_file.close();</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; <span class="comment">// Output contact angle </span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; <span class="comment">//---------------------</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160; ofstream tangent_file;</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/tangent_to_contact_line%i.dat&quot;</span>,</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         doc_info.directory().c_str(),</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; tangent_file.open(filename);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; ofstream normal_file;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/normal_to_contact_line%i.dat&quot;</span>,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;         doc_info.directory().c_str(),</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; normal_file.open(filename);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; ofstream contact_angle_file;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/contact_angle%i.dat&quot;</span>,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         doc_info.directory().c_str(),</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;         doc_info.number());</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; contact_angle_file.open(filename);</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; <span class="comment">// Tangent and normal vectors to contact line</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; Vector&lt;double&gt; tangent(3);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; Vector&lt;double&gt; normal(3);</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; Vector&lt;double&gt; r_contact(3);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; <span class="comment">// How many contact angle elements are there?</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; <span class="keywordtype">unsigned</span> n_element = Contact_angle_mesh_pt-&gt;nelement();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; <span class="comment">// Loop over the surface elements</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   </div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   tangent_file &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   normal_file &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   contact_angle_file &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;   </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;   <span class="comment">// Upcast from GeneralisedElement to YoungLaplace contact angle element</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   YoungLaplaceContactAngleElement&lt;ELEMENT&gt;* el_pt = </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keyword">dynamic_cast&lt;</span>YoungLaplaceContactAngleElement&lt;ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;     Contact_angle_mesh_pt-&gt;element_pt(e));</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;   <span class="comment">// Loop over a few points in the contact angle element</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;   Vector&lt;double&gt; s(1);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;npts;i++)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;     s[0]=-1.0+2.0*double(i)/double(npts-1);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;     </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     <span class="keyword">dynamic_cast&lt;</span>ELEMENT*<span class="keyword">&gt;</span>(el_pt-&gt;bulk_element_pt())-&gt;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;      position(el_pt-&gt;local_coordinate_in_bulk(s),r_contact);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;     </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;     el_pt-&gt;contact_line_vectors(s,tangent,normal);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;     tangent_file &lt;&lt; r_contact[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                  &lt;&lt; r_contact[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                  &lt;&lt; r_contact[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                  &lt;&lt; tangent[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                  &lt;&lt; tangent[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                  &lt;&lt; tangent[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;     </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;     normal_file &lt;&lt; r_contact[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                 &lt;&lt; r_contact[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                 &lt;&lt; r_contact[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                 &lt;&lt; normal[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                 &lt;&lt; normal[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                 &lt;&lt; normal[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;     </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;     contact_angle_file &lt;&lt; r_contact[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                        &lt;&lt; el_pt-&gt;actual_cos_contact_angle(s)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                        &lt;&lt; std::endl;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;  } <span class="comment">// end of loop over both boundaries</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; tangent_file.close();</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; normal_file.close();</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; contact_angle_file.close();</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;cout &lt;&lt; <span class="stringliteral">&quot;\n********************************************&quot;</span> &lt;&lt; endl &lt;&lt;  endl;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160; </div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;} <span class="comment">// end of doc</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">//===============start_of_main============================================</span><span class="comment"></span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">/// Drive code</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><a name="l00543"></a><span class="lineno"><a class="line" href="refineable__t__junction_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">  543</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="refineable__t__junction_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;{</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; <span class="comment">// Create label for output</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; DocInfo doc_info;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; <span class="comment">// Trace file</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; ofstream trace_file;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; <span class="comment">// Set output directory</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; doc_info.set_directory(<span class="stringliteral">&quot;RESLT&quot;</span>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; <span class="comment">// Open a trace file</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; <span class="keywordtype">char</span> filename[100];</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,doc_info.directory().c_str());</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; trace_file.open(filename);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; <span class="comment">// Tecplot header for trace file: kappa and height value</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; trace_file &lt;&lt; <span class="stringliteral">&quot;VARIABLES=\&quot;&lt;GREEK&gt;k&lt;/GREEK&gt;\&quot;,\&quot;h\&quot;&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; trace_file &lt;&lt; <span class="stringliteral">&quot;ZONE&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; <span class="comment">//Set up the problem</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; <span class="comment">//------------------</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; <span class="comment">// Create the problem with 2D nine-node elements from the</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; <span class="comment">// RefineableQYoungLaplaceElement family. </span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; <a class="code" href="classRefineableYoungLaplaceProblem.html">RefineableYoungLaplaceProblem&lt;RefineableQYoungLaplaceElement&lt;3&gt;</a> &gt; <a class="code" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>;</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; <span class="comment">// Perform one uniform refinement</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; <a class="code" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>.refine_uniformly();</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; <span class="comment">//Output the solution</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; <a class="code" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>.doc_solution(doc_info,trace_file);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; <span class="comment">//Increment counter for solutions </span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; doc_info.number()++;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; <span class="comment">// Parameter incrementation</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; <span class="comment">//------------------------- </span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; <span class="keywordtype">double</span> increment=0.1;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; <span class="comment">// Loop over steps</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; <span class="keywordtype">unsigned</span> nstep=2; <span class="comment">// 10;</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> istep=0;istep&lt;nstep;istep++)</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <a class="code" href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a>+=increment;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="comment">// Solve the problem  </span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="keywordtype">unsigned</span> max_adapt=1;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <a class="code" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>.newton_solve(max_adapt);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <span class="comment">//Output the solution</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   <a class="code" href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a>.doc_solution(doc_info,trace_file);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;   </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   <span class="comment">//Increment counter for solutions </span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;   doc_info.number()++;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; <span class="comment">// Close output file</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; trace_file.close();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;} <span class="comment">//end of main</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_aaa270ba8da395897a5a99d052f076e0c"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#aaa270ba8da395897a5a99d052f076e0c">RefineableYoungLaplaceProblem::delete_contact_angle_elements</a></div><div class="ttdeci">void delete_contact_angle_elements()</div><div class="ttdoc">Delete contact angle elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00405">refineable_t_junction.cc:405</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a2807bb8cddbfa553df9f5dd170c8645d"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a2807bb8cddbfa553df9f5dd170c8645d">RefineableYoungLaplaceProblem::actions_before_newton_solve</a></div><div class="ttdeci">void actions_before_newton_solve()</div><div class="ttdoc">Update the problem specs before solve: Empty.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00150">refineable_t_junction.cc:150</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ae982fcb894e82c683d07d3c2fbbead3d"><div class="ttname"><a href="namespaceGlobalParameters.html#ae982fcb894e82c683d07d3c2fbbead3d">GlobalParameters::Cos_gamma</a></div><div class="ttdeci">double Cos_gamma</div><div class="ttdoc">Cos of contact angle.</div><div class="ttdef"><b>Definition:</b> <a href="common__young__laplace__stuff_8h_source.html#l00061">common_young_laplace_stuff.h:61</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html"><div class="ttname"><a href="namespaceGlobalParameters.html">GlobalParameters</a></div><div class="ttdoc">Namespace for &quot;global&quot; problem parameters.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00044">barrel.cc:44</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a78f77a299f2770a82378fcccf86a0b71"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a78f77a299f2770a82378fcccf86a0b71">RefineableYoungLaplaceProblem::RefineableYoungLaplaceProblem</a></div><div class="ttdeci">RefineableYoungLaplaceProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00226">refineable_t_junction.cc:226</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a4ec7313c8e4015b0c2af0bbef789e70f"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a4ec7313c8e4015b0c2af0bbef789e70f">RefineableYoungLaplaceProblem::doc_solution</a></div><div class="ttdeci">void doc_solution(DocInfo &amp;doc_info, ofstream &amp;trace_file)</div><div class="ttdoc">Doc the solution. DocInfo object stores flags/labels for where the output gets written to and the tra...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00430">refineable_t_junction.cc:430</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a24b45d5ecdd1d7dbb678e7f74777bf41"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a24b45d5ecdd1d7dbb678e7f74777bf41">RefineableYoungLaplaceProblem::~RefineableYoungLaplaceProblem</a></div><div class="ttdeci">~RefineableYoungLaplaceProblem()</div><div class="ttdoc">Destructor (empty)</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00147">refineable_t_junction.cc:147</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ac8774b3418c4551091d64ec72c169b2e"><div class="ttname"><a href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">GlobalParameters::L_y</a></div><div class="ttdeci">double L_y</div><div class="ttdoc">Width of domain.</div><div class="ttdef"><b>Definition:</b> <a href="common__young__laplace__stuff_8h_source.html#l00097">common_young_laplace_stuff.h:97</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a972796dc0dbb3f5b13cbc503572d2a26"><div class="ttname"><a href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.The mathematical problem may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an interface shape of the required mean curvature \f$ \kappa \f$ that satisfies the boundary conditions along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the interface above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the interface, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The principle of virtual displacementsThe interface shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\delta \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \delta {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \cdot\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the interface, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact line, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, \f$ \delta {\bf R}={\bf 0} \f$, and the line integral vanishes.The variational formulation of the problem is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the interface cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where \f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain boundary, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\zeta_1,\zeta_2) \ \bigg|\(\zeta_1,\zeta_2)=\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the principle of virtual displacements as\f[\int_S \left(\frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2=\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection spines The method of spinesIn the current form, the variational principle cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrisethe same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus' displacement along the spines \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight line corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the spines themselves must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ isone-to-one, at least for the meniscus shapesof interest. Pinned boundary conditions of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the spines and spine basisis one that returns the problem to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model problem shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the interface shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics problems, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid interface is pinned at the edges ofthe slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) curvature of the air-liquid interface is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum curvature of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry(natural) boundary conditions were applied along the lines \f$ x=0 \f$ and \f $x=1;\f$ see \ref comm_ex for further details on the natural boundary conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum curvature when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above problem with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the problem parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean curvature of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, y) \f$-plane,\until bspine functionsand rotate the spines in the \f$ y \f$ direction by setting\f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the spines are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the y-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection main The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the interface curvature \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the problem object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.\until end of main&lt; HR &gt;&lt; HR &gt;\subsection class The problem classThe problem class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in one of the exercises in \ref comm_ex.) The problem 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose one-and-only value contains the unknowninterface curvature, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of problem&lt; HR &gt;&lt; HR &gt;\subsection constr The problem constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\zeta_1,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; x(1) We pass the pointer to that node and the pointer to the double that specifies the imposed displacement to the const ructor of the displacement control element. The const ructor automatically creates a \c Data object whose one-and-only value stores the unknown curvature</div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_ab64eb0b58beb3bb096ecc81b1a3f8a4f"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#ab64eb0b58beb3bb096ecc81b1a3f8a4f">RefineableYoungLaplaceProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of contact angle elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00156">refineable_t_junction.cc:156</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a8044b62475f8b6be7b371532bab17017"><div class="ttname"><a href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00006">young_laplace.txt:6</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html">RefineableYoungLaplaceProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00138">refineable_t_junction.cc:138</a></div></div>
<div class="ttc" id="arefineable__t__junction_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="refineable__t__junction_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Drive code.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00543">refineable_t_junction.cc:543</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a36f5dc0f7071ac15fd63c7c477f77fb0"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a36f5dc0f7071ac15fd63c7c477f77fb0">RefineableYoungLaplaceProblem::Contact_angle_mesh_pt</a></div><div class="ttdeci">Mesh * Contact_angle_mesh_pt</div><div class="ttdoc">Pointer to the contact angle mesh.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00208">refineable_t_junction.cc:208</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a19d04a02b0b5ef5c72e9c30d822e4dc7"><div class="ttname"><a href="namespaceGlobalParameters.html#a19d04a02b0b5ef5c72e9c30d822e4dc7">GlobalParameters::Alpha_max</a></div><div class="ttdeci">double Alpha_max</div><div class="ttdoc">Max. spine angle against horizontal plane.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00099">barrel.cc:99</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_aa2eab8da1b83091df804ede7c60fac87"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#aa2eab8da1b83091df804ede7c60fac87">RefineableYoungLaplaceProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of contact angle elements.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00167">refineable_t_junction.cc:167</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_af14d838e5d4a1b9df2595bb08fa5e99d"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#af14d838e5d4a1b9df2595bb08fa5e99d">RefineableYoungLaplaceProblem::Control_node_pt</a></div><div class="ttdeci">Node * Control_node_pt</div><div class="ttdoc">Node at which the height (displacement along spine) is controlled/doced.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00214">refineable_t_junction.cc:214</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ad085028866de0dfb37173803eabff340"><div class="ttname"><a href="young__laplace_8txt.html#ad085028866de0dfb37173803eabff340">Kappa_pt</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.The mathematical problem may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an interface shape of the required mean curvature \f$ \kappa \f$ that satisfies the boundary conditions along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the interface above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the interface, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The principle of virtual displacementsThe interface shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\delta \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \delta {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \cdot\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the interface, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact line, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, \f$ \delta {\bf R}={\bf 0} \f$, and the line integral vanishes.The variational formulation of the problem is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the interface cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where \f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain boundary, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\zeta_1,\zeta_2) \ \bigg|\(\zeta_1,\zeta_2)=\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the principle of virtual displacements as\f[\int_S \left(\frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2=\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection spines The method of spinesIn the current form, the variational principle cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrisethe same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus' displacement along the spines \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight line corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the spines themselves must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ isone-to-one, at least for the meniscus shapesof interest. Pinned boundary conditions of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the spines and spine basisis one that returns the problem to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model problem shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the interface shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics problems, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid interface is pinned at the edges ofthe slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) curvature of the air-liquid interface is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum curvature of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry(natural) boundary conditions were applied along the lines \f$ x=0 \f$ and \f $x=1;\f$ see \ref comm_ex for further details on the natural boundary conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum curvature when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above problem with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the problem parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean curvature of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, y) \f$-plane,\until bspine functionsand rotate the spines in the \f$ y \f$ direction by setting\f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the spines are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the y-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection main The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the interface curvature \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the problem object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.\until end of main&lt; HR &gt;&lt; HR &gt;\subsection class The problem classThe problem class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in one of the exercises in \ref comm_ex.) The problem 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose one-and-only value contains the unknowninterface curvature, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of problem&lt; HR &gt;&lt; HR &gt;\subsection constr The problem constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\zeta_1,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; f kappa f We store the pointer to this c Data object in the private member data to facilitate its output until Kappa_pt</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00419">young_laplace.txt:419</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ac81daf87f8d3f075d9fd108427e70c4f"><div class="ttname"><a href="namespaceGlobalParameters.html#ac81daf87f8d3f075d9fd108427e70c4f">GlobalParameters::spine_base_function</a></div><div class="ttdeci">void spine_base_function(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;spine_B, Vector&lt; Vector&lt; double &gt; &gt; &amp;dspine_B)</div><div class="ttdoc">Spine basis: The position vector to the basis of the spine as a function of the two coordinates x_1 a...</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00072">barrel.cc:72</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a36ebf514fdd1e78fff69907b39e25af6"><div class="ttname"><a href="namespaceGlobalParameters.html#a36ebf514fdd1e78fff69907b39e25af6">GlobalParameters::L_x</a></div><div class="ttdeci">double L_x</div><div class="ttdoc">Length and width of the domain.</div><div class="ttdef"><b>Definition:</b> <a href="common__young__laplace__stuff_8h_source.html#l00096">common_young_laplace_stuff.h:96</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_ae2ae72b9b685c052b6a86892f64c2d85"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#ae2ae72b9b685c052b6a86892f64c2d85">RefineableYoungLaplaceProblem::Height_control_mesh_pt</a></div><div class="ttdeci">Mesh * Height_control_mesh_pt</div><div class="ttdoc">Pointer to mesh containing the height control element.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00211">refineable_t_junction.cc:211</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a00d1304e030120e76d9f316dd4053116"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a00d1304e030120e76d9f316dd4053116">RefineableYoungLaplaceProblem::create_contact_angle_elements</a></div><div class="ttdeci">void create_contact_angle_elements(const unsigned &amp;b)</div><div class="ttdoc">Create YoungLaplace contact angle elements on the b-th boundary of the bulk mesh and add them to cont...</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00373">refineable_t_junction.cc:373</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a0d667f8f0c41048740c5344619e27584"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a0d667f8f0c41048740c5344619e27584">RefineableYoungLaplaceProblem::Kappa_pt</a></div><div class="ttdeci">Data * Kappa_pt</div><div class="ttdoc">Pointer to Data object that stores the prescribed curvature.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00217">refineable_t_junction.cc:217</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a251d9473d70dea7bfb36d9f0b4bb412d"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a251d9473d70dea7bfb36d9f0b4bb412d">RefineableYoungLaplaceProblem::Bulk_mesh_pt</a></div><div class="ttdeci">RefineableRectangularQuadMesh&lt; ELEMENT &gt; * Bulk_mesh_pt</div><div class="ttdoc">Pointer to the &quot;bulk&quot; mesh.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00205">refineable_t_junction.cc:205</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a3731f24a02ce4f306d65a9a488f85c96"><div class="ttname"><a href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a></div><div class="ttdeci">double Controlled_height</div><div class="ttdoc">Height control value.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00051">barrel.cc:51</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a82df8c67f58e78a236fb6a0cc8bf8284"><div class="ttname"><a href="namespaceGlobalParameters.html#a82df8c67f58e78a236fb6a0cc8bf8284">GlobalParameters::spine_function</a></div><div class="ttdeci">void spine_function(const Vector&lt; double &gt; &amp;x, Vector&lt; double &gt; &amp;spine, Vector&lt; Vector&lt; double &gt; &gt; &amp;dspine)</div><div class="ttdoc">Spine: The spine vector field as a function of the two coordinates x_1 and x_2, and its derivatives w...</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00104">barrel.cc:104</a></div></div>
<div class="ttc" id="aclassRefineableYoungLaplaceProblem_html_a0791c90a16016372e09faf3f5721ecbe"><div class="ttname"><a href="classRefineableYoungLaplaceProblem.html#a0791c90a16016372e09faf3f5721ecbe">RefineableYoungLaplaceProblem::actions_after_newton_solve</a></div><div class="ttdeci">void actions_after_newton_solve()</div><div class="ttdoc">Update the problem after solve: Empty.</div><div class="ttdef"><b>Definition:</b> <a href="refineable__t__junction_8cc_source.html#l00153">refineable_t_junction.cc:153</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ae8fa7610a34b7a2a8223eade99a5c22f"><div class="ttname"><a href="namespaceGlobalParameters.html#ae8fa7610a34b7a2a8223eade99a5c22f">GlobalParameters::Alpha_min</a></div><div class="ttdeci">double Alpha_min</div><div class="ttdoc">Min. spine angle against horizontal plane.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00096">barrel.cc:96</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 19:40:30
        </div>
      </div>
    </footer>
</body>
</html>

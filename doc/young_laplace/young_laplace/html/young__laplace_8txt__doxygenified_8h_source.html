<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: young_laplace.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">young_laplace.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="young__laplace_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: The Young Laplace equation</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">This document discusses the finite-element-based solution of the </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">&lt;A HREF=&quot;http://en.wikipedia.org/wiki/Young-Laplace_equation&quot;&gt;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">Young Laplace equation&lt;/A&gt;, a nonlinear PDE that determines the </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">static equilibrium shapes of droplets or bubbles. We start by </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">reviewing the relevant theory and then present the solution of a </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">simple model problem.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;TABLE BORDER=1, WIDTH=500px&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">&lt;B&gt;Acknowledgement:&lt;/B&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">This tutorial and the associated driver codes were developed jointly</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">with Cedric Ody (Ecole Polytechnique, Paris; now Rennes).</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">\section theory Theory</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">The figure below illustrates a representative problem: A small </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">droplet is extruded slowly from the outlet of a cylindrical tube. The </span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">air-liquid interface is pinned at the end of the tube. We assume that the </span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">size of the droplet and the rate of extrusion are so small that</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">gravitational, viscous and inertial forces may be neglected compared</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">to the interfacial forces acting at the air-liquid interface.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">\image html spherical_cap.gif &quot;A typical problem: The extrusion of a small droplet from a cylindrical tube. &quot; </span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\image latex spherical_cap.eps &quot;A typical problem: The extrusion of a small droplet from a cylindrical tube. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">The shape of the air-liquid interface (the meniscus) is then determined</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">by  Laplace&#39;s law which expresses the balance between the (spatially</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">constant) pressure </span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">drop across the meniscus, \f$ \Delta p^* \f$, and the surface </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">tension forces acting at the air-liquid interface,</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment">\Delta p^* = \sigma \kappa^*,</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">where  \f$ \kappa^* \f$ is the mean curvature</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">and \f$ \sigma \f$ the surface tension.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">Non-dimensionalising all lengths on some problem-specific lengthscale</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\f$ {\cal L} \f$ (e.g. the radius of the cylindrical tube) and </span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">scaling the pressure on the associated capillary scale, </span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment">\f$ \Delta p^* = \sigma/{\cal L} \ \Delta p \f$, yields </span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">the non-dimensional form of the Young-Laplace equation </span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\Delta p =  \kappa.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">This must be augmented by suitable boundary conditions, to be applied</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">at the contact line -- the line along which the meniscus</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">meets the solid surface. We can either &quot;pin&quot; the position of the </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">contact line (as in the above example), or prescribe the  </span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">&lt;A HREF=&quot;http://en.wikipedia.org/wiki/Contact_angle&quot;&gt;contact</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">The mathematical problem may be interpreted as follows: </span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">Given the prescribed pressure drop \f$ \Delta p \f$ (and thus </span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\f$ \kappa \f$),  we wish to determine an interface shape of </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">the required mean curvature \f$ \kappa \f$ that satisfies the </span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">boundary conditions along the contact line.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\subsection cartesian Cartesian PDE-based formulation</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">Expressing the (non-dimensional) height </span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">of the interface above the \f$ (x_1, x_2) \f$-plane as </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the </span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">Young-Laplace equation:</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">\Delta p =  \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">Given the imposed pressure drop across the interface, this equation </span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possible</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">if the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">\subsection pvd The principle of virtual displacements</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">The interface shape can also be determined</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">from the &lt;A HREF=&quot;http://en.wikipedia.org/wiki/Virtual_displacement&quot;&gt; </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">principle of virtual displacements&lt;/A&gt;</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">\delta \left( \int_S  \mathit{\, d} s \right)= \int_S \Delta p {\bf N}</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">\cdot \delta {\bf N} \mathit{\, d} s + \oint_{L} \ \ {\bf T}_n \cdot</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\f]  </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">which may be derived from energetic considerations. Here the </span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the </span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">position vector to the interface, and the vector \f$ {\bf N}</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">\f$ is the unit normal to the meniscus. The left</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">hand side of this equation represents the variation of the interfacial energy </span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">during a virtual displacement, and \f$ ds \f$ </span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">is an infinitesimal element of the meniscus surface, \f$S\f$. </span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">The terms on the right hand side represent the</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">virtual work done by the pressure and the virtual work done by the</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">surface tension forces acting at the free contact line, respectively. </span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">\f$ dl \f$ is the length of an element of the contact line</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">\f$L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interface</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">and normal to the contact line. Note that, if the contact line is </span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">pinned, the variation of its position is zero, \f$ \delta {\bf R} = </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">{\bf 0} \f$, and the line integral vanishes.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">The variational formulation of the problem is particularly </span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">convenient for a finite-element-based solution; see, e.g. the</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">&lt;a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">Solid Mechanics Theory document&lt;/a&gt; for a discussion of how</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">to discretise variational principles with finite elements. The</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">variational and PDE-based formulations are, of course, related to each</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">other: The Young-Laplace equation is the Euler-Lagrange equation of the</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">variational principle.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">\subsection intrinsic Parametric representation </span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">To deal with cases in which the interface cannot be projected </span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">onto the  \f$ (x_1, x_2) \f$-plane, we parametrise the meniscus </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">by two intrinsic coordinates as </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where </span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$.  Furthermore, </span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">we parametrise the domain boundary, \f$\partial D\f$, by a </span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">scalar coordinate \f$\xi\f$ so that, </span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">{\partial D} = \bigg\{ (\zeta_1,\zeta_2) \ \bigg| \ </span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> (\zeta_1,\zeta_2) = \left( \zeta_1^{[\partial D]}(\xi), \ </span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\zeta_2^{[\partial D]}(\xi) \right) \bigg\}. </span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">The normal to the meniscus is then given by </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">{\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} }</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">{\mathcal{A}^{1/2}}, </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">where the commas denote partial differentiation with respect to the</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">intrinsic coordinates, and </span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">\f$ \mathcal{A}^{1/2}= |{\bf R}_{,1} \times {\bf R}_{,2}| \f$ </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">is the square root of the surface metric tensor.</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">The area and length differentials required in variational principle</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">are</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">and </span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">d l=\left| \frac{d {\bf R}\left( \zeta_1^{[\partial D]}(\xi), \ </span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">\zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi,</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">allowing us to write the principle of virtual displacements as</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">\int_S \left( \frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2 =</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ </span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">\left| \frac{d {\bf R}\left( \zeta_1^{[\partial D]}(\xi), \ </span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">\zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right| d \xi.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">\subsection spines The method of spines</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">In the current form, the variational principle cannot yield</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">a unique solution because there are infinitely many </span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">vector fields  \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrise</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">the same interface shape. To remove this ambiguity, and to </span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">allow for interface shapes that cannot be projected onto the</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">\f$ (x_1,x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">This method was originally proposed by Kistler and Scriven</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">for the computation of free surface flows. We decompose </span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">the vector \f$ {\bf R} \f$ into two parts by writing it as </span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">{\bf R}(\zeta_1,\zeta_2) = {\bf B}(\zeta_1,\zeta_2) + </span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). </span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f$</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vector</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">fields that must be chosen by the user. Using this</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">decomposition, the meniscus shape is determined by the scalar function</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus&#39; displacement </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">along the spines \f${\bf S}\f$.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">The idea is illustrated in the simple 2D sketch below: the spine</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">basis vectors, \f$ {\bf B}(\zeta), \f$  parametrise the straight line </span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">corresponding to a flat meniscus. Positive values of \f$ u \f$</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$ (the red </span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">vectors), whose orientation allows the representation  of meniscus </span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">shapes that cannot be represented in cartesian form as </span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">\f$ x_2 = u(x_1). \f$</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">\image html spine_sketch.gif &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot; </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">\image latex spine_sketch.eps &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot; width=0.35\textwidth</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">The spine basis and the spines themselves must be chosen such that the </span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ is</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">one-to-one, at least for the meniscus shapes</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">of interest. Pinned boundary conditions of the form</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">\f$ \left. {\bf R}\right|_{\partial D} = {\bf R}_{\rm pinned} \f$</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">are most easily imposed by choosing the spine basis such that \f$ \left. {\bf</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">B}\right|_{\partial D} = {\bf R}_{\rm pinned}, \f$ implying</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">that \f$ \left. u\right|_{\partial D} = 0. \f$ </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">The simplest possible choice for the spines and spine basis</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">is one that returns the problem to its original cartesian formulation.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2) = </span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">(\zeta_1,\zeta_2,0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2) = (0,0,1)^T. \f$</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">\subsection displ Displacement Control</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">The Young-Laplace equation is a highly nonlinear PDE. We therefore </span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">require a good initial guess for the solution in order to ensure the</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">convergence of the Newton iteration. In many cases good initial guesses can be</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">provided by a simple, physically motivated continuation method.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">For instance in the model problem shown above, the computation was</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">started by computing the solution for \f$ \Delta p = \kappa = 0 \f$ --</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">a flat interface. This solution was then used as the initial guess for </span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">the solution at a small positive value of \f$ \Delta p \f$. This process</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">was continued, allowing us to compute strongly deformed</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">meniscus shapes. This method works well, provided small increments in </span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">the control parameter \f$ \Delta p \f$ (or equivalently, \f$ \kappa \f$)</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">create small changes in the interface shape. This is not always</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">the case, however, as we shall see in the example below. In </span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">such cases it is often possible to re-formulate the problem, using the </span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">displacement control method discussed in the</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">&lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">mechanics tutorials&lt;/a&gt;. Rather than prescribing the pressure </span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">drop \f$ \Delta p \f$ we prescribe the displacement of a control </span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">point on the meniscus and</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">regard the pressure drop required to achieve this displacement</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">as an unknown. Since the implementation of the method is very similar</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">to that used for solid mechanics problems, we shall not</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">discuss it in detail here but refer to the appropriate </span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">&lt;a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">tutorial.&lt;/a&gt;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">\section barrel An example problem: A barrel-shaped meniscus</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">As an example, we consider the following problem: Fluid is extruded</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">from an infinitely long, parallel-sided slot of width \f$ 2a \f$.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">If we assume that the air-liquid interface is pinned at the edges of</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment">the slot, as shown in the sketch below, the problem has an </span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">obvious exact solution. The air-liquid interface </span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">must have constant mean curvature, so, assuming that its shape does </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">not vary along the slot, the meniscus must be a circular</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">cylinder. If we characterise the meniscus&#39; shape by its vertical</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">displacement along the centreline, \f$ H \f$, the (dimensional) </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment">curvature of the air-liquid interface is given by</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\kappa^*  = \frac{2/a}{H/a + a/H}.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment">The plot of this function, shown in the right half of the figure</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">below, may be interpreted as a &quot;load-displacement</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">diagram&quot; as it shows the deflection of the meniscus as a function </span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment">of the imposed non-dimensional pressure drop across the air-liquid interface, </span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\f$ \Delta p = a \kappa^*. \f$</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">\image html meniscus_sketch_and_limit_point.gif &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot; </span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">\image latex meniscus_sketch_and_limit_point.eps &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">The plot shows that the load-displacement curve is </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">not single-valued. Furthermore, the presence of a limit point </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment">at \f$ a \kappa^* = 1 \f$ indicates that the maximum curvature of </span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment">the meniscus is given by \f$ \kappa_{max}^* = 1/a. \f$ This implies </span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">that the maximum (dimensional) pressure that the meniscus can</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">withstand is given by \f$ \Delta p^*_{max} = \sigma \kappa_{max}^* = </span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment">\sigma/a \f$.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">The presence of the limit point makes it impossible to compute the entire </span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">solution curve by simply increasing \f$ \kappa \f$ in small increments. </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">However, use of a displacement control approach, by prescribing </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">\f$ H \f$ while regarding \f$ \Delta p \f$ (and </span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">thus \f$\kappa\f$) as an unknown, yields a single-valued function </span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">that can be computed by a straightforward continuation method in </span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">which \f$ H \f$ is increased in small increments. </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">This approach was employed to compute the meniscus shapes shown </span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">in the plot below. The initial, zero-curvature configuration</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">of the meniscus (corresponding to a vanishing pressure drop across the </span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">air-liquid interface) is the unit square. The meniscus is pinned along </span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment">the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry (natural) </span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">boundary conditions were applied along the lines \f$ x=0 \f$ and \f$</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">x=1; \f$ see \ref comm_ex for further details on the natural </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">boundary conditions.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">As the pressure drop increases, the meniscus is deflected upwards</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">until it reaches the configuration of maximum curvature when </span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">\f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reduced</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">to compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\image html barrel.gif &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot; </span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">\image latex barrel.eps &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">The comparison of the computed &quot;load-displacement curve&quot; </span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">against the exact solution, shown below, indicates that the two agree</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">to within plotting accuracy. </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment">\image html trace.gif &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot; </span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">\image latex trace.eps &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">&lt;HR&gt; </span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">\section impl Implementation</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">We shall now discuss the solution of the above problem with</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment">\c oomph-lib&#39;s  Young Laplace elements.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">\subsection namespace The global namespace</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment">As usual we define the problem parameters in a global namespace.</span></div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment">The key parameter is the value of the prescribed control displacement</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">which we initialise to zero.  The function \c get_exact_kappa()</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">returns the exact solution for the mean curvature of the meniscus.</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">We will use this function for the validation of our results.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">\dontinclude barrel.cc</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">\until end exact kappa </span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">Next we define the orientation of the spines. Anticipating the shape</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">of the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">(\zeta_1,\zeta_2,0) \f$ so that \f$ u=0 \f$ corresponds to a flat</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">meniscus in the \f$ (x,y) \f$-plane,</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\until bspine functions</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">and rotate the spines in the \f$ y \f$ direction by setting</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">\f[ </span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">{\bf S}(\zeta_1,\zeta_2) = </span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment">0 \\</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">-\sin\big(\alpha(\zeta_2)\big) \\</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">\ \ \cos\big(\alpha(\zeta_2)\big) \\</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\right)</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">where \f$ \alpha(\zeta_2) = \alpha_{min} + (\alpha_{max}-\alpha_{min})</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment">\zeta_2 \f$. With this choice, the spines are unit vectors that</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment">form an angle \f$ \alpha \f$ (varying between \f$ \alpha_{min} \f$ and</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">\f$ \alpha_{max} \f$) with the y-axis.</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">\until spine function</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">\subsection main The driver code</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">We start by preparing an output directory and open a trace file to </span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">record the control displacement, and the computed and</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">exact values of the interface curvature \f$ \kappa \f$. </span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment">\dontinclude barrel.cc</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment">\skipline start_of_main </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">\until ZONE</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">Next we build the problem object and document the initial</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">configuration: a flat meniscus. </span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">\until doc_info.number()++;</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">Finally, we perform a parameter study by increasing the control</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">displacement in small increments and re-computing the </span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">meniscus shapes and the associated interface curvatures.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">\subsection class The problem class</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment">The problem class has the usual member functions. (Ignore the lines</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">in \c actions_before_newton_solve() as they are irrelevant in the</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment">current context. They are discussed in one of the exercises in </span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">\ref comm_ex.) The problem&#39;s private member</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">data include a pointer to the node at which the meniscus displacement</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment">is controlled by the displacement control element, and a pointer to </span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">the \c Data object whose one-and-only value contains the unknown</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment">interface curvature, \f$ \kappa. \f$</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">\dontinclude barrel.cc</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">\until end of problem</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment">\subsection constr The problem constructor</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">We start by building the mesh, discretising the two-dimensional</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">parameter space \f$ (\zeta_1,\zeta_2) \in [0,1] \times [0,1]\f$ </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">with 8x8 elements.</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment">\until mesh_pt()</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment">Next, we choose the central node in the mesh as the node whose</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">displacement is imposed by the displacement control method. </span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">\until Control_node_pt-&gt;x(1)</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">We pass the pointer to that node and the pointer to the double</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">that specifies the imposed displacement to the constructor</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment">of the displacement control element. The constructor automatically creates</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">a \c Data object whose one-and-only value stores the unknown</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment">curvature, \f$ \kappa. \f$ We store the pointer to this \c Data</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">object in the private member data to facilitate its output.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">\until Kappa_pt=</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment">The meniscus is pinned along mesh boundaries 0 and 2:</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\skipline Boundary conditions</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment">\until end bc</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">We complete the build of the Young Laplace elements by passing the</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">pointer to the spine functions, and the prescribed curvature. </span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">Finally, we add the displacement control element to the mesh</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">and assign the equation numbers.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">\subsection post Postprocessing</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">We document the exact and computed meniscus curvatures in the</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">trace file and output the meniscus shape.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">\skipline start_of_doc</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">\until end of doc</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">\section comm_ex Comments and Exercises</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment">-# &lt;b&gt;Choice of spines:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">   We discussed earlier that the spine basis and the spines themselves </span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment">   must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">   to \f${\bf R}(\zeta_1,\zeta_2)\f$ is one-to-one, at least for </span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment">   the meniscus shapes of interest. This requires some prior knowledge</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">   of the expected interface shapes.  \n \n</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">   The spine basis and the spines must be defined via function pointers</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">   that are passed to the Young Laplace elements. If the function</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">   pointers are not specified, the Young-Laplace elements revert to </span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">   a cartesian formulation. \n\n </span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">   Experiment with different spine orientations and explore the</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">   interface shapes that are obtained if no spines are specified (by commenting</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">   out the lines in the constructor that pass the relevant function</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">   pointers to the Young Laplace elements).  </span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">-# &lt;b&gt;Natural boundary conditions:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">   As usual in any finite-element computation, we only enforced the </span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">   essential boundary conditions by pinning the meniscus displacement</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">   along the &quot;pinned contact lines&quot; at \f$ y=0 \f$ and  \f$ y=1. \f$</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">   No constraints were applied along the two other domain boundaries</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment">   (at \f$ x=0 \f$ and  \f$ x=1 \f$), indicating that these boundaries</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment">   are controlled by implied, &quot;natural&quot; boundary conditions. The</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">   variational principle (1) shows what these are: since</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">   we neglected the boundary integral on the right hand side of</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">   equation (1), </span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">   the meniscus shape must satisfy </span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">   \f$ {\bf T}_n \cdot \delta {\bf R} = \delta u \ {\bf T}_n \cdot</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">   {\bf S} = 0, \f$</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">   implying that outer unit normal to the meniscus boundary, </span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">   \f$ {\bf T}_n, \f$ must be orthogonal to the direction of the spines.</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">   Since the spines do not have an</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">   \f$ x \f$ - component, the meniscus must therefore have</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">   zero slope in that direction -- just what we need for our problem. </span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">   To convince yourself that the this argument is correct, rotate </span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">   the spines in the  \f$ x \f$ -direction, e.g. by changing</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">   their definition to</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">   \f[ </span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">   {\bf S}(\zeta_1,\zeta_2) = </span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">   \left(</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment">   \begin{array}{c}</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment">   1/2 \\</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">   -\sin\big(\alpha(\zeta_2)\big) \\</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment">   \ \ \cos\big(\alpha(\zeta_2)\big) \\</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">   \end{array}</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">   \right).</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">   The natural boundary condition will still force the meniscus to be </span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">   normal to the spines along the &quot;free&quot; contact line, resulting in </span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">   interface shapes similar to the one shown in the figure below.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">\image html funky_meniscus.gif &quot;Meniscus shape created by the natural boundary conditions when the spines (shown as vectors) are rotated in the x-direction. &quot; </span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">\image latex funky_meniscus.eps &quot;Meniscus shape created by the natural boundary conditions when the spines (shown as vectors) are rotated in the x-direction. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">   This demonstrates yet again that the orientation of spines must </span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">   reflect the relevant features of the problem. </span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">   We refer to &lt;a href=&quot;../../contact_angle/html/index.html&quot;&gt;another</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">   tutorial&lt;/a&gt; for a more detailed discussion </span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">   of the boundary condition and its relation to contact angles.</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">-# &lt;b&gt;Displacement control:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">   Explore what happens if you disable displacement control and</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">   prescribe the pressure drop (i.e. \f$ \kappa \f$) directly. </span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">   The relevant code is already contained in the driver code.</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">   You&#39;ll have to comment out the lines in the problem constructor </span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">   that create the displacement control element and the line that adds </span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">   it to the problem&#39;s mesh.  Replace them by the lines</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">   \dontinclude barrel.cc</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">   \skipline Comment out the pre</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">   \until pin(0);</span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">   which create the \c Data object that stores the prescribed curvature. </span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">   (Note that the value of \f$ \kappa \f$ is already incremented in \c</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">   actions_before_newton_step(). With displacement control this </span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">   step has no real effect as the Newton method will overwrite this</span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">   assignment). Check what happens if the prescribed</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">   curvature exceeds the maximum possible curvature of the meniscus. </span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">-# &lt;b&gt;Inefficient implementation:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">   Note that the current implementation of the Young Laplace elements   </span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">   is inefficient as the elemental Jacobian matrices are computed by</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment">   finite-differencing. You are invited to implement the analytical</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">   computation of the Jacobian matrix as an exercise.</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">-# &lt;b&gt;Other problems:&lt;/b&gt; \n\n</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">   We provide a number of additional demo driver codes that</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">   demonstrate the solution of other, related problems.</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">   \n\n </span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">   - The code \n\n</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">     &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">     &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/young_laplace.cc&quot;&gt;</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">     demo_drivers/young_laplace/young_laplace.cc</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">     &lt;/A&gt;</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">     &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">     and its adaptive counterpart</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment">     &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">     &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/refineable_young_laplace.cc&quot;&gt;</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">     demo_drivers/young_laplace/refineable_young_laplace.cc</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">     &lt;/A&gt;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">     &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">     demonstrate the solution of three problems: (i) the barrel-shaped meniscus</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">     problem already discussed above; (ii) the deformation of a meniscus that </span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">     is pinned at all four edges of a square tube; and (iii) the solution of</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">     a problem with contact-angle boundary conditions. The latter one</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">     is discussed in a &lt;a href=&quot;../../contact_angle/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">     separate tutorial.&lt;/a&gt;     </span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">   - The spherical meniscus that emanates from a circular tube, shown </span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">     in the animation at the beginning of current document, was computed with:</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">      \n\n</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">     &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">     &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/spherical_cap_in_cylinder.cc&quot;&gt;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">     demo_drivers/young_laplace/spherical_cap_in_cylinder.cc</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">     &lt;/A&gt;</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">     &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment">     \n\n</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">   .</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">  &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/&quot;&gt;</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="comment">  demo_drivers/young_laplace/</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">  &lt;/A&gt;</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="comment">  &lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="comment">  &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/barrel.cc&quot;&gt;</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="comment">  demo_drivers/young_laplace/barrel.cc</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="comment">  &lt;/A&gt;</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="comment">  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ayoung__laplace_8txt_html_a4f31063aa2581a1197266c00f4746b2f"><div class="ttname"><a href="young__laplace_8txt.html#a4f31063aa2581a1197266c00f4746b2f">component</a></div><div class="ttdeci">_n cdot f implying that outer unit normal to the meniscus f must be orthogonal to the direction of the spines Since the spines do not have an f x f component</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00484">young_laplace.txt:484</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_aeca3fbb0467bbb9f89ebed58aa1c7ffa"><div class="ttname"><a href="young__laplace_8txt.html#aeca3fbb0467bbb9f89ebed58aa1c7ffa">spines</a></div><div class="ttdeci">_n cdot f implying that outer unit normal to the meniscus f must be orthogonal to the direction of the spines Since the spines do not have an f x f the meniscus must therefore have zero slope in that direction just what we need for our problem n n To convince yourself that the this argument is rotate the spines in the f x f e g by changing their definition to f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \f] The natural boundary condition will still force the meniscus to be normal to the spines along the free contact resulting in interface shapes similar to the one shown in the figure below I w textwidth funky_meniscus Meniscus shape created by the natural boundary conditions when the spines(shown as vectors) are rotated in the x-direction. &quot; This demonstrates yet again that the orientation of spines must reflect the relevant features of the problem. We refer to &lt;a href</div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_aa6158a81e827ec1ab33df40a25ea88b4"><div class="ttname"><a href="young__laplace_8txt.html#aa6158a81e827ec1ab33df40a25ea88b4">correct</a></div><div class="ttdeci">_n cdot f implying that outer unit normal to the meniscus f must be orthogonal to the direction of the spines Since the spines do not have an f x f the meniscus must therefore have zero slope in that direction just what we need for our problem n n To convince yourself that the this argument is correct</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00487">young_laplace.txt:487</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a1c89605709bfb613fd19c9f098dd6eda"><div class="ttname"><a href="young__laplace_8txt.html#a1c89605709bfb613fd19c9f098dd6eda">boundary</a></div><div class="ttdeci">_n cdot f implying that outer unit normal to the meniscus boundary</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00481">young_laplace.txt:481</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_afc17068882c18acc92fa19f13ba24670"><div class="ttname"><a href="young__laplace_8txt.html#afc17068882c18acc92fa19f13ba24670">line</a></div><div class="ttdeci">_n cdot f implying that outer unit normal to the meniscus f must be orthogonal to the direction of the spines Since the spines do not have an f x f the meniscus must therefore have zero slope in that direction just what we need for our problem n n To convince yourself that the this argument is rotate the spines in the f x f e g by changing their definition to f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c} 1/2 \\ -\sin\big(\alpha(\zeta_2)\big) \\ \ \ \cos\big(\alpha(\zeta_2)\big) \\ \end{array} \right). \f] The natural boundary condition will still force the meniscus to be normal to the spines along the free contact line</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00501">young_laplace.txt:501</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a89176c66757d666599a5b244526ae379"><div class="ttname"><a href="young__laplace_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a></div><div class="ttdeci">zeta_1</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00456">young_laplace.txt:456</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a1b792a58562211eb74439f1222d226a4"><div class="ttname"><a href="young__laplace_8txt.html#a1b792a58562211eb74439f1222d226a4">y</a></div><div class="ttdeci">zeta_2 f is one to at least for the meniscus shapes of interest This requires some prior knowledge of the expected interface shapes n n The spine basis and the spines must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the interface shapes that are obtained if no spines are we only enforced the essential boundary conditions by pinning the meniscus displacement along the pinned contact lines at f y</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00471">young_laplace.txt:471</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a972796dc0dbb3f5b13cbc503572d2a26"><div class="ttname"><a href="young__laplace_8txt.html#a972796dc0dbb3f5b13cbc503572d2a26">x</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.The mathematical problem may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an interface shape of the required mean curvature \f$ \kappa \f$ that satisfies the boundary conditions along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the interface above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the interface, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The principle of virtual displacementsThe interface shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\delta \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \delta {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \cdot\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the interface, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact line, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, \f$ \delta {\bf R}={\bf 0} \f$, and the line integral vanishes.The variational formulation of the problem is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the interface cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where \f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain boundary, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\zeta_1,\zeta_2) \ \bigg|\(\zeta_1,\zeta_2)=\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the principle of virtual displacements as\f[\int_S \left(\frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2=\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection spines The method of spinesIn the current form, the variational principle cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrisethe same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus' displacement along the spines \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight line corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the spines themselves must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ isone-to-one, at least for the meniscus shapesof interest. Pinned boundary conditions of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the spines and spine basisis one that returns the problem to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model problem shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the interface shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics problems, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid interface is pinned at the edges ofthe slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) curvature of the air-liquid interface is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum curvature of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry(natural) boundary conditions were applied along the lines \f$ x=0 \f$ and \f $x=1;\f$ see \ref comm_ex for further details on the natural boundary conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum curvature when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above problem with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the problem parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean curvature of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, y) \f$-plane,\until bspine functionsand rotate the spines in the \f$ y \f$ direction by setting\f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the spines are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the y-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection main The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the interface curvature \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the problem object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.\until end of main&lt; HR &gt;&lt; HR &gt;\subsection class The problem classThe problem class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in one of the exercises in \ref comm_ex.) The problem 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose one-and-only value contains the unknowninterface curvature, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of problem&lt; HR &gt;&lt; HR &gt;\subsection constr The problem constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\zeta_1,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; x(1) We pass the pointer to that node and the pointer to the double that specifies the imposed displacement to the const ructor of the displacement control element. The const ructor automatically creates a \c Data object whose one-and-only value stores the unknown curvature</div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a1ed379f41acee082a02b9ce12b741bd6"><div class="ttname"><a href="young__laplace_8txt.html#a1ed379f41acee082a02b9ce12b741bd6">direction</a></div><div class="ttdeci">_n cdot f implying that outer unit normal to the meniscus f must be orthogonal to the direction of the spines Since the spines do not have an f x f the meniscus must therefore have zero slope in that direction just what we need for our problem n n To convince yourself that the this argument is rotate the spines in the f x f direction</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00488">young_laplace.txt:488</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a8044b62475f8b6be7b371532bab17017"><div class="ttname"><a href="young__laplace_8txt.html#a8044b62475f8b6be7b371532bab17017">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00006">young_laplace.txt:6</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a4571d41514b16946dd31d075d44c5593"><div class="ttname"><a href="namespaceGlobalParameters.html#a4571d41514b16946dd31d075d44c5593">GlobalParameters::get_exact_kappa</a></div><div class="ttdeci">double get_exact_kappa()</div><div class="ttdoc">Exact kappa.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00054">barrel.cc:54</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a0cc3d24c53996627ec3a5cd70d7d0eb7"><div class="ttname"><a href="young__laplace_8txt.html#a0cc3d24c53996627ec3a5cd70d7d0eb7">one</a></div><div class="ttdeci">zeta_2 f is one to one</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00456">young_laplace.txt:456</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_aae6b72bddd98a5f24915877f818e1f68"><div class="ttname"><a href="young__laplace_8txt.html#aae6b72bddd98a5f24915877f818e1f68">Paris</a></div><div class="ttdeci">mainpage Example a nonlinear PDE that determines static the equilibrium shapes of droplets or bubbles We start by reviewing the relevant theory and then present the solution of a simple model problem&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00020">young_laplace.txt:20</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a4919b2fccf0613c276d0ca7bfbf41441"><div class="ttname"><a href="young__laplace_8txt.html#a4919b2fccf0613c276d0ca7bfbf41441">principle</a></div><div class="ttdeci">zeta_2 f is one to at least for the meniscus shapes of interest This requires some prior knowledge of the expected interface shapes n n The spine basis and the spines must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the interface shapes that are obtained if no spines are we only enforced the essential boundary conditions by pinning the meniscus displacement along the pinned contact lines at f indicating that these boundaries are controlled by natural boundary conditions The variational principle(@R[var_prin]@) shows what these are</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00475">young_laplace.txt:475</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a14f05f6bec57fb9eea1f1e04f934c4b5"><div class="ttname"><a href="young__laplace_8txt.html#a14f05f6bec57fb9eea1f1e04f934c4b5">f</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p * f</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00042">young_laplace.txt:42</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a5ea2ccd2302f3ef85d1dc917d935b659"><div class="ttname"><a href="young__laplace_8txt.html#a5ea2ccd2302f3ef85d1dc917d935b659">interface</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid interface</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00043">young_laplace.txt:43</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ab527d223c14587f4aebca609ce74db8a"><div class="ttname"><a href="young__laplace_8txt.html#ab527d223c14587f4aebca609ce74db8a">delta</a></div><div class="ttdeci">_n cdot delta</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00479">young_laplace.txt:479</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ab4bbbf540e3048bad7f837fd75b71184"><div class="ttname"><a href="young__laplace_8txt.html#ab4bbbf540e3048bad7f837fd75b71184">tube</a></div><div class="ttdeci">ii the deformation of a meniscus that is pinned at all four edges of a square tube</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00556">young_laplace.txt:556</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a7f08e15ca2e78d4f74694e3111124596"><div class="ttname"><a href="young__laplace_8txt.html#a7f08e15ca2e78d4f74694e3111124596">conditions</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary conditions</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00053">young_laplace.txt:53</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a51614c86b63eafc713e24089a1463975"><div class="ttname"><a href="young__laplace_8txt.html#a51614c86b63eafc713e24089a1463975">implied</a></div><div class="ttdeci">zeta_2 f is one to at least for the meniscus shapes of interest This requires some prior knowledge of the expected interface shapes n n The spine basis and the spines must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not the Young Laplace elements revert to a cartesian formulation n n Experiment with different spine orientations and explore the interface shapes that are obtained if no spines are we only enforced the essential boundary conditions by pinning the meniscus displacement along the pinned contact lines at f indicating that these boundaries are controlled by implied</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00474">young_laplace.txt:474</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ad085028866de0dfb37173803eabff340"><div class="ttname"><a href="young__laplace_8txt.html#ad085028866de0dfb37173803eabff340">Kappa_pt</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.The mathematical problem may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an interface shape of the required mean curvature \f$ \kappa \f$ that satisfies the boundary conditions along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the interface above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the interface, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The principle of virtual displacementsThe interface shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\delta \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \delta {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \cdot\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the interface, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact line, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, \f$ \delta {\bf R}={\bf 0} \f$, and the line integral vanishes.The variational formulation of the problem is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the interface cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where \f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain boundary, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\zeta_1,\zeta_2) \ \bigg|\(\zeta_1,\zeta_2)=\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the principle of virtual displacements as\f[\int_S \left(\frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2=\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection spines The method of spinesIn the current form, the variational principle cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrisethe same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus' displacement along the spines \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight line corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the spines themselves must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ isone-to-one, at least for the meniscus shapesof interest. Pinned boundary conditions of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the spines and spine basisis one that returns the problem to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model problem shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the interface shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics problems, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid interface is pinned at the edges ofthe slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) curvature of the air-liquid interface is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum curvature of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry(natural) boundary conditions were applied along the lines \f$ x=0 \f$ and \f $x=1;\f$ see \ref comm_ex for further details on the natural boundary conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum curvature when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above problem with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the problem parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean curvature of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, y) \f$-plane,\until bspine functionsand rotate the spines in the \f$ y \f$ direction by setting\f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the spines are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the y-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection main The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the interface curvature \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the problem object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.\until end of main&lt; HR &gt;&lt; HR &gt;\subsection class The problem classThe problem class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in one of the exercises in \ref comm_ex.) The problem 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose one-and-only value contains the unknowninterface curvature, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of problem&lt; HR &gt;&lt; HR &gt;\subsection constr The problem constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\zeta_1,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; f kappa f We store the pointer to this c Data object in the private member data to facilitate its output until Kappa_pt</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00419">young_laplace.txt:419</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_afd7bfc074226d266df4e6c70265af3c9"><div class="ttname"><a href="young__laplace_8txt.html#afd7bfc074226d266df4e6c70265af3c9">Finally</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; section theory Theory The figure below illustrates a representative viscous and inertial forces may be neglected compared to the interfacial forces acting at the air liquid interface I w textwidth spherical_cap A typical f Delta p and the surface tension forces acting at the air liquid f[\Delta p^ *=\sigma \kappa^ *,\f] where f kappa *f is the mean curvature and f sigma f the surface tension Non dimensionalising all lengths on some problem specific lengthscale f Delta p yields the non dimensional form of the Young Laplace equation f[\Delta p=\kappa.\f] This must be augmented by suitable boundary to be applied at the contact line the line along which the meniscus meets the solid surface We can either pin the position of the contact or prescribe the&lt; A HREF=&quot;http:angle&lt;/A&gt; at which the air-liquid interface meets the solid surface.The mathematical problem may be interpreted as follows: Given the prescribed pressure drop \f$ \Delta p \f$ (and thus \f$ \kappa \f$), we wish to determine an interface shape of the required mean curvature \f$ \kappa \f$ that satisfies the boundary conditions along the contact line.\subsection cartesian Cartesian PDE-based formulationExpressing the (non-dimensional) height of the interface above the \f$ (x_1, x_2) \f$-plane as \f$ x_3 = u(x_1,x_2) \f$ yields the cartesian form of the Young-Laplace equation:\f[\Delta p = \kappa = - \nabla \cdot \frac{\nabla u}{\sqrt{1+|\nabla u|^2}},\f]where \f$ \nabla = (\partial/\partial x_1,\partial/\partial x_2)^T \f$Given the imposed pressure drop across the interface, this equation must be solved for \f$ u(x_1, x_2) \f$. Note that this is only possibleif the interface can be projected onto the \f$ (x_1, x_2) \f$-plane. \subsection pvd The principle of virtual displacementsThe interface shape can also be determinedfrom the &lt;A HREF=&quot;http:principle of virtual displacements&lt;/A &gt;\f[\delta \left(\int_S \mathit{\, d} s \right)=\int_S \Delta p {\bf N}\cdot \delta {\bf N} \mathit{\, d} s+\oint_{L} \ \ {\bf T}_n \cdot\delta {\bf R } \mathit{\, d} l \ \ \ \ \ \ \ \ \ \ \ \ @E[var_prin]@\f] which may be derived from energetic considerations. Here the symbol \f$ \delta \f$ denotes a variation, \f$ {\bf R } \f$ is the position vector to the interface, and the vector \f$ {\bf N}\f$ is the unit normal to the meniscus. The lefthand side of this equation represents the variation of the interfacial energy during a virtual displacement, and \f$ ds \f$ is an infinitesimal element of the meniscus surface, \f $S\f$. The terms on the right hand side represent thevirtual work done by the pressure and the virtual work done by thesurface tension forces acting at the free contact line, respectively. \f$ dl \f$ is the length of an element of the contact line\f $L\f$, and \f$ {\bf T}_n \f$ is the vector tangent to the interfaceand normal to the contact line. Note that, if the contact line is pinned, the variation of its position is zero, \f$ \delta {\bf R}={\bf 0} \f$, and the line integral vanishes.The variational formulation of the problem is particularly convenient for a finite-element-based solution;see, e.g. the&lt; a href=&quot;../../../solid/solid_theory/html/index.html#CartesianLagrangian&quot;&gt;Solid Mechanics Theory document&lt;/a &gt; for a discussion of howto discretise variational principles with finite elements. Thevariational and PDE-based formulations are, of course, related to eachother:The Young-Laplace equation is the Euler-Lagrange equation of thevariational principle.\subsection intrinsic Parametric representation To deal with cases in which the interface cannot be projected onto the \f$(x_1, x_2) \f$-plane, we parametrise the meniscus by two intrinsic coordinates as \f$ {\bf R}(\zeta_1,\zeta_2) \in { R}^3\f$, where \f$(\zeta_1,\zeta_2) \in D \in { R}^2\f$. Furthermore, we parametrise the domain boundary, \f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that, \f[{\partial D}=\bigg\{(\zeta_1,\zeta_2) \ \bigg|\(\zeta_1,\zeta_2)=\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right) \bigg\}. \f] The normal to the meniscus is then given by \f[{\bf N}=\frac{{\bf R}_{, 1} \times {\bf R}_{, 2} }{\mathcal{A}^{1/2}}, \f] where the commas denote partial differentiation with respect to theintrinsic coordinates, and \f$ \mathcal{A}^{1/2}=|{\bf R}_{, 1} \times {\bf R}_{, 2}|\f$ is the square root of the surface metric tensor.The area and length differentials required in variational principleare\f[d s=\mathcal{A}^{1/2} d \zeta_1 d \zeta_2 \f] and \f[d l=\left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi,\f] allowing us to write the principle of virtual displacements as\f[\int_S \left(\frac{\delta \mathcal{A}^{1/2}}{\mathcal{A}^{1/2}} -\kappa \ {\bf N} \cdot \delta {\bf R} \right) \mathcal{A}^{1/2} d \zeta_1 d \zeta_2=\oint_{L} {\bf T}_n \cdot \delta {\bf R} \ \left|\frac{d {\bf R}\left(\zeta_1^{[\partial D]}(\xi), \ \zeta_2^{[\partial D]}(\xi) \right)}{d \xi} \right|d \xi.\f]\subsection spines The method of spinesIn the current form, the variational principle cannot yielda unique solution because there are infinitely many vector fields \f$ {\bf R}(\zeta_1,\zeta_2) \f$ that parametrisethe same interface shape. To remove this ambiguity, and to allow for interface shapes that cannot be projected onto the\f$(x_1, x_2) \f$-plane, we employ the so-called &quot;Method of Spines&quot;.This method was originally proposed by Kistler and Scrivenfor the computation of free surface flows. We decompose the vector \f$ {\bf R} \f$ into two parts by writing it as \f[{\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+\mathit{u}(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2). \f] Here the &quot;spine basis&quot; \f${\bf B}(\zeta_1,\zeta_2)\f $and the &quot;spines&quot; \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined vectorfields that must be chosen by the user. Using thisdecomposition, the meniscus shape is determined by the scalar function\f$\mathit{u}(\zeta_1,\zeta_2)\f$ which represents the meniscus' displacement along the spines \f${\bf S}\f$.The idea is illustrated in the simple 2D sketch below:the spinebasis vectors, \f$ {\bf B}(\zeta), \f$ parametrise the straight line corresponding to a flat meniscus. Positive values of \f$ u \f $displace the meniscus along the spines, \f$ {\bf S}(\zeta) \f$(the red vectors), whose orientation allows the representation of meniscus shapes that cannot be represented in cartesian form as \f$ x_2=u(x_1). \f$ @I w 0.35\textwidth spine_sketch &quot;Sketch illustrating the parametrisation of the meniscus by the Method of Spines. &quot;The spine basis and the spines themselves must be chosen such that the mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$ isone-to-one, at least for the meniscus shapesof interest. Pinned boundary conditions of the form\f$ \left. {\bf R}\right|_{\partial D}={\bf R}_{\rm pinned} \f $are most easily imposed by choosing the spine basis such that \f$ \left. {\bfB}\right|_{\partial D}={\bf R}_{\rm pinned}, \f$ implyingthat \f$ \left. u\right|_{\partial D}=0. \f$ The simplest possible choice for the spines and spine basisis one that returns the problem to its original cartesian formulation.This is achieved by setting \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T \f$ and \f$ {\bf S}(\zeta_1,\zeta_2)=(0, 0, 1)^T. \f$\subsection displ Displacement ControlThe Young-Laplace equation is a highly nonlinear PDE. We therefore require a good initial guess for the solution in order to ensure theconvergence of the Newton iteration. In many cases good initial guesses can beprovided by a simple, physically motivated continuation method.For instance in the model problem shown above, the computation wasstarted by computing the solution for \f$ \Delta p=\kappa=0 \f$ --a flat interface. This solution was then used as the initial guess for the solution at a small positive value of \f$ \Delta p \f$. This processwas continued, allowing us to compute strongly deformedmeniscus shapes. This method works well, provided small increments in the control parameter \f$ \Delta p \f$(or equivalently, \f$ \kappa \f$) create small changes in the interface shape. This is not alwaysthe case, however, as we shall see in the example below. In such cases it is often possible to re-formulate the problem, using the displacement control method discussed in the&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solidmechanics tutorials&lt;/a &gt;. Rather than prescribing the pressure drop \f$ \Delta p \f$ we prescribe the displacement of a control point on the meniscus andregard the pressure drop required to achieve this displacementas an unknown. Since the implementation of the method is very similarto that used for solid mechanics problems, we shall notdiscuss it in detail here but refer to the appropriate&lt; a href=&quot;../../../beam/steady_ring/html/index.html&quot;&gt;solid mechanics tutorial.&lt;/a &gt;&lt; HR &gt;&lt; HR &gt;\section barrel An example problem:A barrel-shaped meniscusAs an example, we consider the following problem:Fluid is extrudedfrom an infinitely long, parallel-sided slot of width \f$ 2a \f$.If we assume that the air-liquid interface is pinned at the edges ofthe slot, as shown in the sketch below, the problem has an obvious exact solution. The air-liquid interface must have constant mean curvature, so, assuming that its shape does not vary along the slot, the meniscus must be a circularcylinder. If we characterise the meniscus' shape by its verticaldisplacement along the centreline, \f$ H \f$, the(dimensional) curvature of the air-liquid interface is given by\f[\kappa^ *=\frac{2/a}{H/a+a/H}.\f] The plot of this function, shown in the right half of the figurebelow, may be interpreted as a &quot;load-displacementdiagram&quot; as it shows the deflection of the meniscus as a function of the imposed non-dimensional pressure drop across the air-liquid interface, \f$ \Delta p=a \kappa^ *. \f$ @I w 0.75\textwidth meniscus_sketch_and_limit_point &quot;Sketch of the meniscus above a slot of width 2a. The figure on the right illustrates the relation between the meniscus curvature and its vertical displacement along the centreline. &quot;The plot shows that the load-displacement curve is not single-valued. Furthermore, the presence of a limit point at \f$ a \kappa^ *=1 \f$ indicates that the maximum curvature of the meniscus is given by \f$ \kappa_{max}^ *=1/a. \f$ This implies that the maximum(dimensional) pressure that the meniscus canwithstand is given by \f$ \Delta p^ *_{max}=\sigma \kappa_{max}^ *=\sigma/a \f$.The presence of the limit point makes it impossible to compute the entire solution curve by simply increasing \f$ \kappa \f$ in small increments. However, use of a displacement control approach, by prescribing \f$ H \f$ while regarding \f$ \Delta p \f$(and thus \f$\kappa\f$) as an unknown, yields a single-valued function that can be computed by a straightforward continuation method in which \f$ H \f$ is increased in small increments. This approach was employed to compute the meniscus shapes shown in the plot below. The initial, zero-curvature configurationof the meniscus(corresponding to a vanishing pressure drop across the air-liquid interface) is the unit square. The meniscus is pinned along the lines \f$ y=0 \f$ and \f$ y=1 \f$, and symmetry(natural) boundary conditions were applied along the lines \f$ x=0 \f$ and \f $x=1;\f$ see \ref comm_ex for further details on the natural boundary conditions.As the pressure drop increases, the meniscus is deflected upwardsuntil it reaches the configuration of maximum curvature when \f$ H/a=1 \f$. Beyond this point, the pressure drop has to be reducedto compute the &quot;bulging&quot; meniscus shapes obtained for \f$ H/a &gt; 1. \f$ @I w 0.75\textwidth barrel &quot;Deformation of a meniscus that is pinned along the lines y=0 and y=1. &quot;The comparison of the computed &quot;load-displacement curve&quot; against the exact solution, shown below, indicates that the two agreeto within plotting accuracy. @I w 0.75\textwidth trace &quot;Load-displacement diagram for a meniscus that is pinned along the lines y=0 and y=1. &quot;&lt; HR &gt;&lt; HR &gt; \section impl ImplementationWe shall now discuss the solution of the above problem with\c oomph-lib 's Young Laplace elements.\subsection namespace The global namespaceAs usual we define the problem parameters in a global namespace.The key parameter is the value of the prescribed control displacementwhich we initialise to zero. The function \c get_exact_kappa() returns the exact solution for the mean curvature of the meniscus.We will use this function for the validation of our results.\dontinclude barrel.cc\skipline start_of_namespace\until end exact kappa Next we define the orientation of the spines. Anticipating the shapeof the meniscus, we set \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0) \f$ so that \f$ u=0 \f$ corresponds to a flatmeniscus in the \f$(x, y) \f$-plane,\until bspine functionsand rotate the spines in the \f$ y \f$ direction by setting\f[{\bf S}(\zeta_1,\zeta_2)=\left(\begin{array}{c}0 \\-\sin\big(\alpha(\zeta_2)\big) \\\ \ \cos\big(\alpha(\zeta_2)\big) \\\end{array}\right)\f]where \f$ \alpha(\zeta_2)=\alpha_{min}+(\alpha_{max}-\alpha_{min})\zeta_2 \f$. With this choice, the spines are unit vectors thatform an angle \f$ \alpha \f$(varying between \f$ \alpha_{min} \f$ and\f$ \alpha_{max} \f$) with the y-axis.\until spine function&lt; HR &gt;&lt; HR &gt;\subsection main The driver codeWe start by preparing an output directory and open a trace file to record the control displacement, and the computed andexact values of the interface curvature \f$ \kappa \f$. \dontinclude barrel.cc\skipline start_of_main \until ZONENext we build the problem object and document the initialconfiguration:a flat meniscus. \until doc_info.number()++;Finally, we perform a parameter study by increasing the controldisplacement in small increments and re-computing the meniscus shapes and the associated interface curvatures.\until end of main&lt; HR &gt;&lt; HR &gt;\subsection class The problem classThe problem class has the usual member functions.(Ignore the linesin \c actions_before_newton_solve() as they are irrelevant in thecurrent context. They are discussed in one of the exercises in \ref comm_ex.) The problem 's private memberdata include a pointer to the node at which the meniscus displacementis controlled by the displacement control element, and a pointer to the \c Data object whose one-and-only value contains the unknowninterface curvature, \f$ \kappa. \f$\dontinclude barrel.cc\skipline start_of_problem_class\until end of problem&lt; HR &gt;&lt; HR &gt;\subsection constr The problem constructorWe start by building the mesh, discretising the two-dimensionalparameter space \f$(\zeta_1,\zeta_2) \in[0, 1] \times[0, 1]\f$ with 8x8 elements.\until mesh_pt() Next, we choose the central node in the mesh as the node whosedisplacement is imposed by the displacement control method. \until Control_node_pt-&gt; f kappa f We store the pointer to this c Data object in the private member data to facilitate its output until and the prescribed curvature until Finally</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00431">young_laplace.txt:431</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a236055ccdca33d638feffb2f38f635da"><div class="ttname"><a href="young__laplace_8txt.html#a236055ccdca33d638feffb2f38f635da">specified</a></div><div class="ttdeci">zeta_2 f is one to at least for the meniscus shapes of interest This requires some prior knowledge of the expected interface shapes n n The spine basis and the spines must be defined via function pointers that are passed to the Young Laplace elements If the function pointers are not specified</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00461">young_laplace.txt:461</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_ae8d86658dc1ec3aa7122edd47ef4124e"><div class="ttname"><a href="young__laplace_8txt.html#ae8d86658dc1ec3aa7122edd47ef4124e">problems</a></div><div class="ttdeci">n n which create the c Data object that stores the prescribed related problems n n The code n n&lt; CENTER &gt;&lt; A HREF=&quot;../../../../demo_drivers/young_laplace/young_laplace.cc&quot;&gt; demo_drivers young_laplace young_laplace cc&lt;/A &gt;&lt;/CENTER &gt; n n and its adaptive counterpart n n&lt; CENTER &gt;&lt; A HREF=&quot;../../../../demo_drivers/young_laplace/refineable_young_laplace.cc&quot;&gt; demo_drivers young_laplace refineable_young_laplace cc&lt;/A &gt;&lt;/CENTER &gt; n n demonstrate the solution of three problems</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00555">young_laplace.txt:555</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_afe7bec3a49f1760b75ce56ebe6721643"><div class="ttname"><a href="young__laplace_8txt.html#afe7bec3a49f1760b75ce56ebe6721643">Acknowledgement</a></div><div class="ttdeci">mainpage Example a nonlinear PDE that determines static the equilibrium shapes of droplets or bubbles We start by reviewing the relevant theory and then present the solution of a simple model problem&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Acknowledgement</div><div class="ttdef"><b>Definition:</b> <a href="young__laplace_8txt_source.html#l00020">young_laplace.txt:20</a></div></div>
<div class="ttc" id="abarrel_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="barrel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver code.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00321">barrel.cc:321</a></div></div>
<div class="ttc" id="ayoung__laplace_8txt_html_a6a63e58ac8fc8170c7517d6c91561372"><div class="ttname"><a href="young__laplace_8txt.html#a6a63e58ac8fc8170c7517d6c91561372">curvature</a></div><div class="ttdeci">n n which create the c Data object that stores the prescribed curvature(Note that the value of \f$ \kappa \f$ is already incremented in \c actions_before_newton_step(). With displacement control this step has no real effect as the Newton method will overwrite this assignment). Check what happens if the prescribed curvature exceeds the maximum possible curvature of the meniscus. \n\n - Note that the current implementation of the Young Laplace elements is inefficient as the elemental Jacobian matrices are computed by finite-differencing. You are invited to implement the analytical computation of the Jacobian matrix as an exercise. \n\n - We provide a number of additional demo driver codes that demonstrate the solution of other</div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Jul 9 2021 00:55:03
        </div>
      </div>
    </footer>
</body>
</html>

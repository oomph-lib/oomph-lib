<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: contact_angle.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">contact_angle.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="contact__angle_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: The Young Laplace equation with contact angle boundary conditions</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">In this document we demonstrate the adaptive solution of the Young</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">Laplace equation with contact angle boundary conditions. We </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">start by reviewing the physical background in the context of </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">a representative model problem, and then discuss the spine-based </span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">representation of free contact lines and the implementation of </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">the contact angle boundary condition along such lines.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;TABLE BORDER=1, WIDTH=500px&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">&lt;TR&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">&lt;TD bgcolor=&quot;cornsilk&quot;&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">&lt;B&gt;Acknowledgement:&lt;/B&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">This tutorial and the associated driver codes were developed jointly</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">with Cedric Ody (Ecole Polytechnique, Paris; now Rennes).</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">&lt;/TABLE&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">\section model A model problem</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">The figure below shows a sketch of a T-junction in a microchannel </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">with a rectangular cross-section. (The front wall has been removed for</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">clarity). Fluid is being pushed quasi-steadily along the (vertical)</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">main channel and is in the process of entering the T-junction. </span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">We assume that the air-liquid interface (shown in red) remains </span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">pinned at the two sharp edges (at \f$ y=const.\f$) where the channels meet,</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">while the meniscus forms a quasi-static contact angle, \f$ \gamma \f$, </span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">with the smooth front and back walls.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">\image html t_junction_contact_angle_sketch.gif &quot;A typical problem: Fluid propagates quasi-steadily through a T-junction that connects two channels of rectangular cross-section. &quot; </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">\image latex t_junction_contact_angle_sketch.eps &quot;A typical problem: Fluid propagates quasi-steadily through a T-junction that connects two channels of rectangular cross-section. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">It is of interest to determine the maximum pressure that the meniscus </span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">can withstand: if the driving pressure is less than that </span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">value, the fluid will not be able to propagate past the T-junction.</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\section theory Theory and implementation</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">\subsection spine Spine-based representation of the meniscus</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">&lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;Recall&lt;/a&gt; </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">that we parametrised the meniscus by two intrinsic coordinates</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">as \f$ {\bf R}(\zeta_1,\zeta_2) \in {R}^3 \f$, where </span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">\f$(\zeta_1,\zeta_2) \in D \in {R}^2\f$. Furthermore,</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">we parametrised the domain boundary,</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">\f$\partial D\f$, by a scalar coordinate \f$\xi\f$ so that,</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment">{\partial D} =  \bigg\{ (\zeta_1,\zeta_2) \ \bigg| \ (\zeta_1,\zeta_2) =</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\left( \zeta_1^{[\partial D]}(\xi), \ </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\zeta_2^{[\partial D]}(\xi) \right) \bigg\}.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">The normal to the meniscus is then given by</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">{\bf N} = \frac{{\bf R}_{,1} \times {\bf R}_{,2} }</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment">{|{\bf R}_{,1} \times {\bf R}_{,2}|},</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">where a comma denotes partial differentiation with respect to one of the</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">intrinsic coordinates, \f$ (\zeta_1, \zeta_2). \f$</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">Along the contact line we define two unit vectors, \f${\bf T}_t\f$ </span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">and \f${\bf T}_n\f$, that are tangential to the meniscus.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\f${\bf T}_t\f$ is tangent to the contact line </span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">while \f${\bf T}_n\f$ is normal to it and points away from the</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">meniscus, as shown in the sketch below.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">We split the domain boundary \f$ \partial D \f$ so that \f$ \partial D = </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">\partial D_{\rm pinned} \cup \partial D_{\rm angle} \f$ and </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">assume that along  \f$\partial D_{\rm pinned}\f$ the meniscus is</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">pinned, </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">\left. {\bf R} \right|_{\partial D_{\rm pinned}} = {\bf R}_{\rm pinned}(\xi),</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">where \f${\bf R}_{\rm pinned}(\xi) \f$ is given.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">On \f$\partial D_{\rm  angle}\f$ the meniscus meets the wall at a prescribed</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">contact angle \f$\gamma\f$ so that</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">\left. \left( ({\bf T}_t \times {\bf N}_{\rm wall}) \cdot {\bf T}_n\right) </span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">\right|_{\partial D_{angle}} = \cos \gamma,</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">where \f${\bf N}_{\rm wall}\f$ is the outer unit normal to the wall</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">as shown in this sketch:</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment">\image html contact_angle_sketch.gif &quot;Sketch of the meniscus, the contact line along which it meets the wall, and the spine-based representation of the meniscus. &quot; </span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">\image latex contact_angle_sketch.eps &quot;Sketch of the meniscus, the contact line along which it meets the wall, and the spine-based representation of the meniscus. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">The figure also illustrates the spine-based representation of the meniscus </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">in the form</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">{\bf R}(\zeta_1,\zeta_2) = </span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">{\bf B}(\zeta_1,\zeta_2) +</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">u(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">where the spine basis \f${\bf R}(\zeta_1,\zeta_2)\f$ and</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">spines \f${\bf S}(\zeta_1,\zeta_2)\f$ are pre-determined </span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment">vector fields, chosen such that</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment">\n</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">- The mapping from \f$(\zeta_1,\zeta_2)\f$ to \f${\bf R}(\zeta_1,\zeta_2)\f$  </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">  is one-to-one, at least for the meniscus shapes of interest.</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">- Along the parts of the boundary where the contact line is</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">  pinned we have</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">  \f[</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">  \left. {\bf B}\right|_{\partial D_{\rm pinned}} = {\bf R}_{\rm pinned}</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">  \f]</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">  so that the pinned boundary condition may be enforced by</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  setting \f$ u|_{\partial D_{\rm pinned}} = 0.\f$</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">  \n\n</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">\subsection contact_angle_term Computation of the contact-angle term in the variational principle</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">&lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;Recall&lt;/a&gt; </span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">that the variational principle that determines the shape of the</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment">meniscus contained the line term</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">\delta \Pi_{\rm contact \ line} = </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">\oint_{\partial D } {\bf T}_n \cdot \delta {\bf R} </span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">\left| \frac{\partial {\bf R}} {\partial \xi}\right| \ d\xi.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">Along \f$ \partial D_{pinned} \f$ the line integral vanishes </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">because \f$ \delta {\bf R}\big|_{ \partial D_{pinned} } ={\bf 0} \f$. </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">The line integral can therefore be written as</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">\delta \Pi_{\rm contact \ line} = </span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment">\int_{\partial D_{\rm angle}} {\bf T}_n \cdot \delta {\bf R} </span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">\left| \frac{\partial {\bf R}}{\partial \xi}\right| \ d\xi,</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">or, using the spine-based representation of the meniscus, (2),</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment">\delta \Pi_{\rm contact\ line} = </span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">\int_{\partial D_{\rm angle}} {\bf T}_n \cdot  {\bf S} \ \delta u </span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">\left| \frac{\partial {\bf R}}{\partial \xi}\right| \ d\xi.</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">We shall now demonstrate that the integrand in this expression can be expressed</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">in terms of the contact angle boundary</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">condition (1). We start with several observations:</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">-# \f${\bf T}_t\f$ is tangential to the wall.</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">-# Since \f${\bf N}_{\rm wall}\f$ is normal to the wall, </span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">   \f${\bf T}_t \times {\bf N}_{\rm wall}\f$ is tangential to the wall</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">   and orthogonal to \f${\bf T}_t\f$.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">-# \f${\bf S}\f$ is tangential to the wall and can therefore</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">   be decomposed into its components parallel to \f$ {\bf T}_t \f$</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">   and  \f${\bf T}_t \times {\bf N}_{\rm wall} \f$ as</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">   {\bf S} = \alpha {\bf T}_t + \beta ( {\bf T}_t \times {\bf N}_{\rm</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">   wall} )</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \   (3)</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment">   for some values of \f$\alpha\f$ and \f$\beta\f$. In fact,</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">   \beta = {\bf S}</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment">   \cdot ( {\bf T}_t \times {\bf N}_{\rm wall} )</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">-# During the computation it is most convenient to perform all</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">   calculations in terms of quantities that are easily obtained from</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">   the parametrisation of the meniscus as this avoids having to </span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">   specify \f${\bf N}_{\rm wall}\f$ explicitly. For this purpose we</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">   exploit that  \f${\bf T}_t\f$ and  \f${\bf S}\f$ are tangential</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">   to the wall and not parallel to each other (unless the</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">   parametrisation of the meniscus by (2) is no longer </span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">   one-to-one). Therefore \f${\bf N}_{\rm wall}\f$ can be obtained </span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">   from quantities that are intrinsic to the meniscus representation</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">   via</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">   {\bf N}_{\rm wall} = \frac{ {\bf S} \times {\bf T}_t } </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">   {|{\bf S} \times {\bf T}_t|}</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">   and thus</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">   \beta = {\bf S}</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">   \cdot \left( {\bf T}_t \times  </span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">   \frac{ {\bf S} \times {\bf T}_t } </span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment">   {|{\bf S} \times {\bf T}_t|} \right)</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (4)</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">-# Given (3) and the fact that \f${\bf T}_t \cdot {\bf</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">   T}_n =0\f$, we have</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">   {\bf S} \cdot {\bf T}_n =  \beta ( {\bf T}_t \times {\bf N}_{\rm wall}</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">   ) \cdot {\bf T}_n</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">   and with (1):</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">   {\bf S} \cdot {\bf T}_n =  \beta \cos \gamma.</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">   Hence, the line integral may be written as</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">   \f[</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">   \delta \Pi_{\rm contact\ line} = </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">   \int_{\partial D_{\rm angle}} \beta \cos \gamma \ \delta u </span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">   \left| \frac{\partial {\bf R}}{\partial \xi}\right| \ d\xi,</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">   \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (5)</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">   \f]</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">   where \f$ \beta \f$ is given by (4).</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment">Equation (5) is easily discretised</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment">by finite elements. Within \c oomph-lib, the line integral</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment">is decomposed into \c FaceElements that are attached to the</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment">&quot;bulk&quot; Young-Laplace elements that are adjacent to the</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">contact line. The imposition of the contact angle boundary condition</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">for the Young Laplace equation is therefore as easy as the application</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment">of Neumann boundary conditions for a Poisson equation, say.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">\section results Results</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">The animation below illustrates the variation in the quasi-steady meniscus</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">shape as the fluid enters the T-junction. </span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">\image html t_junction_meniscus.gif &quot;Animation of the meniscus shapes. &quot; </span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">\image latex t_junction_meniscus.eps &quot;Animation of the meniscus shapes. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">The computation was performed with full spatial adaptivity. The plot </span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">below illustrates how the automatic mesh adaptation has strongly </span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">refined the mesh towards the corners of the domain where</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">the meniscus shape has a singularity. (The singularity develops</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">because in the corners of the domain the contact angle boundary</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">condition along the side walls is inconsistent with the \f$ 90^o \f$</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">contact angle enforced by the pinned boundary condition along the</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">sharp edges.)</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment">\image html t_junction_meniscus_adapt.gif &quot;Illustration of the adaptive mesh refinement. &quot; </span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment">\image latex t_junction_meniscus_adapt.eps &quot;Illustration of the adaptive mesh refinement. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="comment">Finally, here is a plot of the &quot;load-displacement diagram&quot;, i.e. a plot</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="comment">of the meniscus deflection as a function of its curvature (i.e. the </span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="comment">applied pressure drop). The limit point indicates the maximum</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="comment">pressure that can be withstood by the static meniscus.</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">\image html t_junction_trace.gif &quot;The load-displacement diagram for the meniscus. &quot; </span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment">\image latex t_junction_trace.eps &quot;The load-displacement diagram for the meniscus. &quot; width=0.6\textwidth</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment">\section code The driver code</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment">The modifications to the driver code required to impose the contact</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment">angle boundary conditions are very similar to those used in other driver</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment">codes for problems with Neumann-type boundary conditions. We attach </span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">\c FaceElements to the appropriate faces of the &quot;bulk&quot; Young-Laplace</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment">elements detach/re-attach them before and after any spatial </span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment">adaptation of the &quot;bulk&quot; mesh. </span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment">\subsection namespace The global namespace</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="comment">The namespace that defines the problem parameters is very similar</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment">to that used in the </span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">&lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;previous example&lt;/a&gt; </span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment">without contact angle boundary</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment">conditions. We provide storage for the cosine of the contact angle,</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">and the prescribed meniscus height that is used by the displacement</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">control method. </span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">\dontinclude refineable_t_junction.cc</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment">\until Controlled_height</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">&lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;As before&lt;/a&gt;, we </span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">use the spine basis </span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">\f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2,0)^T, \f$ to</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">establish a reference configuration in which</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment">the flat meniscus is located in the plane \f$ z=0 \f$ and occupies the domain </span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment">\f$ (x,y) \in [0,L_x] \times [0,L_y]. \f$ </span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">\until End of bspine functions</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment">As in the &lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;previous</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment">example&lt;/a&gt;, we rotate the spines in the \f$ y \f$ -direction to </span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment">allow the representation of meniscus shapes that cannot be </span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment">projected onto the \f$ (x,y) \f$ -plane. </span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">\until end of namespace</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment">\subsection main The driver code</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment">We start by defining the output directory and open a trace file</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment">to record the load-displacement curve.</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment">\dontinclude refineable_t_junction.cc</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment">\until ZONE</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment">Next, we create the problem object, refine the mesh uniformly</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">and output the initial guess for the solution: a flat interface</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment">which, unlike the &lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;previous </span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">case&lt;/a&gt;, is not a solution of the problem</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment">because it does not satisfy the contact-angle boundary condition;</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">see the section \ref comm_ex for a more detailed discussion of this</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment">issue.</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment">\until number()++;</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment">Finally, we perform a parameter study by slowly incrementing</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment">the control displacement and recomputing the meniscus shape.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment">\subsection class The problem class</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">The problem class contains the usual member functions. The functions</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;<span class="comment">\c actions_before_adapt() and \c actions_after_adapt() </span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">are used to detach and re-attach (and rebuild) the contact angle</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="comment">elements on the appropriate boundaries of the &quot;bulk&quot; mesh. </span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;<span class="comment">\dontinclude refineable_t_junction.cc</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;<span class="comment">\until doc_solution(</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="comment">Two private helper functions are provided to create and delete </span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="comment">the contact angle elements. The class also provides storage for </span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="comment">the pointers to the various meshes, to the node at which the meniscus </span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="comment">displacement is prescribed by the displacement control method, and to </span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="comment">the \c Data object whose one-and-only value stores the (unknown) meniscus</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="comment">curvature.</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment">\subsection constr The problem constructor</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="comment">We start by creating the &quot;bulk&quot; mesh of refineable Young Laplace</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="comment">elements and specify the error estimator. </span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="comment">\until min_permitted_error()</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">We identify the node (in the centre of the mesh)</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment">at which we apply displacement control. We pass a pointer to </span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment">this node to the constructor of the displacement control element </span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment">and store that element in its own mesh. </span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment">\until kappa_pt()</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment">Next we create the mesh that stores the contact-angle elements.</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="comment">We attach these elements to boundaries 1 and 3 of the &quot;bulk&quot; mesh.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="comment">\until contact_angle_elements(3);</span></div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;<span class="comment">The various sub-meshes are now added to the problem and the global mesh</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="comment">is built.</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;<span class="comment">\until build_global_mesh();</span></div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="comment">As usual, we enforce only the essential boundary conditions directly by </span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;<span class="comment">pinning the meniscus displacement along mesh boundaries 0 and 2:</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="comment">\until end bcs</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="comment">The build of the &quot;bulk&quot; Young Laplace elements is completed</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;<span class="comment">by specifying the function pointers to the spine functions and</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="comment">the pointer to the \c Data object that stores the</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="comment">curvature.</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">Finally, we complete the build of the contact line elements </span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="comment">by passing the pointer to the double that stores the</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;<span class="comment">cosine of the contact angle. </span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;<span class="comment">\until }</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">All that&#39;s now left to do is to assign the equation numbers:</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment">\subsection create Creating the contact angle elements</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment">The function \c  create_contact_angle_elements() attaches</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">the \c FaceElements that apply the contact angle boundary condition</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment">to the specified boundary of the &quot;bulk&quot; mesh. Pointers</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment">to the newly-created \c FaceElements are stored in a separate mesh.</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment">\skipline start_of_create_contact_angle_elements</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="comment">\until end of create_contact_angle_elements</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="comment">\subsection delete Deleting the contact angle elements</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;<span class="comment">The function \c delete_contact_angle_elements() deletes the</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="comment">contact angle elements and flushes the associated mesh.</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="comment">\skipline start_of_delete_contact_angle_elements</span></div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;<span class="comment">\until // end of delete_contact_angle_elements</span></div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment">\subsection doc Post-processing</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">We output the load-displacement data, the meniscus shape,</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment">and various contact line quantities. </span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment">\skipline start_of_doc</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment">\until end of doc</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment">\section comm_ex Comments and Exercises</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment">\subsection ic How to generate a good initial guess for the solution</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="comment">We already commented on the need to provide a &quot;good&quot; initial</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="comment">guess for the solution in order to ensure the convergence of the Newton</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;<span class="comment">iteration. In the &lt;a href=&quot;../../young_laplace/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;<span class="comment">previous example&lt;/a&gt; this was easy because the flat meniscus</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="comment">(clearly a solution of the Young-Laplace equations for</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="comment">zero curvature) also satisfied the boundary conditions. In the</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="comment">present example, and in many others, this is not the case. In such</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="comment">problems it may be difficult to generate initial guesses for the meniscus</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="comment">shape that are sufficiently close to actual solution. </span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="comment">In such cases it may be necessary to compute the initial solution </span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="comment">to the problem whose behaviour we wish to investigate during the</span></div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="comment">actual parameter study via a preliminary auxiliary continuation procedure that</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="comment">transforms an easier-solve-problem (for which a good initial guess</span></div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="comment">can be found) into the actual problem. </span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="comment">Explore this approach in the present problem by implementing the</span></div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="comment">following steps:</span></div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="comment">-# Set the contact angle to \f$ 90^o \f$  and solve the problem, using</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="comment">   the &quot;flat&quot; meniscus as the initial guess. The &quot;flat&quot; meniscus </span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="comment">   is, of course, the exact solution for zero control displacement and/or zero</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="comment">   curvature.</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="comment">-# Now start a preliminary continuation procedure in which the contact angle</span></div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="comment">   is adjusted in small steps until it reaches the desired value. Keep</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="comment">   the prescribed control displacement (or the meniscus curvature)</span></div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="comment">   constant during this procedure.</span></div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="comment">   \n\n</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="comment">-# The solution for the desired contact angle may now be used </span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="comment">   as the initial guess for the actual parameter study in which</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="comment">   the control displacement (or the meniscus curvature) are increased</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="comment">   while the contact angle is kept fixed.</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="comment">\subsection lim Limitations of the current approach -- suggestions for improvement</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">One of the main disadvantages of the approach adopted here</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment">is that the spine vector fields \f$ {\bf B} \f$</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment">and \f$ {\bf S} \f$ must be specified &lt;em&gt;a priori&lt;/em&gt;. For sufficiently</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment">complicated meniscus shapes (or for menisci that undergo </span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment">large changes in shape as their curvature is varied) the choice</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment">of suitable spines may be very difficult.</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment">One (possible) solution to this problem could be (we haven&#39;t tried</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment">it!) to occasionally update the spine representation. For instance, </span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment">assume that we have computed a meniscus shape in the form</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment">\widehat{\bf R} = {\bf R}(\zeta_1,\zeta_2) = </span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment">{\bf B}(\zeta_1,\zeta_2) +</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment">u(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2)</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;<span class="comment">with an associated normal vector \f$ \widehat{\bf N} \f$.</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">We can reparametrise this shape by setting</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;<span class="comment">{\bf B} :=  \widehat{\bf R},</span></div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="comment">\f]     </span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;<span class="comment">{\bf S} :=  \widehat{\bf N},</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;<span class="comment">\f]    </span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;<span class="comment">and  </span></div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="comment">u := 0</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">\f] </span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="comment">before continuing the computation. Provided this is done</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="comment">sufficiently frequently, i.e. long before </span></div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;<span class="comment">the displacement along the spines has become so large</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="comment">that the mapping from \f$ (\zeta_1,\zeta_2) \f$ to </span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;<span class="comment">\f$ {\bf R}(\zeta_1,\zeta_2)\f$ is about to become non-one-to-one,</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;<span class="comment">this should allow the computation of arbitrarily large meniscus</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;<span class="comment">deflections. Try it out and let us know how it works!</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;<span class="comment">\n\n</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;<span class="comment">\subsection zero Zero contact angles</span></div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="comment">Our problem formulation suffers from an additional, more</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;<span class="comment">fundamental problem: it cannot be used to solve problems</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">with zero contact angle. This is because for zero contact angles</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">the equilibrium solution is no longer a minimiser of the</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;<span class="comment">variational principle: given a solution at which the</span></div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;<span class="comment">meniscus meets the wall at zero contact angle, it is always</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;<span class="comment">possible to extend the meniscus with an arbitrary-length</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;<span class="comment">&quot;collar&quot; along the wall without changing the overall energy</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;<span class="comment">of the system. As a result, the position of the contact line becomes</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;<span class="comment">increasingly ill-defined as the contact angle \f$ \gamma \f$ is reduced,</span></div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;<span class="comment">causing the Newton method to converge very slowly (and ultimately</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="comment">not at all) as \f$ \gamma \to 0. \f$</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:\n\n</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="comment">  &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/&quot;&gt;</span></div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="comment">  demo_drivers/young_laplace/</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="comment">  &lt;/A&gt;</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="comment">  &lt;/CENTER&gt;\n</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="comment">- The driver code is: \n\n</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="comment">  &lt;CENTER&gt;</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="comment">  &lt;A HREF=&quot;../../../../demo_drivers/young_laplace/refineable_t_junction.cc&quot;&gt;</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="comment">  demo_drivers/young_laplace/refineable_t_junction.cc</span></div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="comment">  &lt;/A&gt;</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="comment">  &lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="acontact__angle_8txt_html_ad1c3b5a5aba86a7883b7915e8bdd7c21"><div class="ttname"><a href="contact__angle_8txt.html#ad1c3b5a5aba86a7883b7915e8bdd7c21">actions_before_adapt</a></div><div class="ttdeci">we perform a parameter study by slowly incrementing the control displacement and recomputing the meniscus shape until end of main&lt; HR &gt;&lt; HR &gt; subsection class The problem class The problem class contains the usual member functions The functions c actions_before_adapt() and \c actions_after_adapt() are used to detach and re-attach(and rebuild) the contact angle elements on the appropriate boundaries of the &quot;bulk&quot; mesh. \dontinclude refineable_t_junction.cc \skipline start_of_problem_class \until doc_solution(Two private helper functions are provided to create and delete the contact angle elements. The class also provides storage for the pointers to the various meshes</div></div>
<div class="ttc" id="acontact__angle_8txt_html_ae2786609a8386ecceef72059fb575617"><div class="ttname"><a href="contact__angle_8txt.html#ae2786609a8386ecceef72059fb575617">D</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section model A model problem The figure below shows a sketch of a T junction in a microchannel with a rectangular cross f where a comma denotes partial differentiation with respect to one of the intrinsic that are tangential to the meniscus as shown in the sketch below We split the domain boundary f partial D f so that f partial D</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00085">contact_angle.txt:85</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a9b2364430fac2e5db377e9b237a3166e"><div class="ttname"><a href="contact__angle_8txt.html#a9b2364430fac2e5db377e9b237a3166e">Acknowledgement</a></div><div class="ttdeci">mainpage Example and then discuss the spine based representation of free contact lines and the implementation of the contact angle boundary condition along such lines&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Acknowledgement</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00020">contact_angle.txt:20</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_ab024b49a3ba20ca1915b695ef9987be2"><div class="ttname"><a href="contact__angle_8txt.html#ab024b49a3ba20ca1915b695ef9987be2">number</a></div><div class="ttdeci">see the section ref comm_ex for a more detailed discussion of this issue until number()++</div></div>
<div class="ttc" id="acontact__angle_8txt_html_a161949e9805c6e0a3505a37f2e2d7950"><div class="ttname"><a href="contact__angle_8txt.html#a161949e9805c6e0a3505a37f2e2d7950">line</a></div><div class="ttdeci">\int_{\partial D_{\rm angle}} {\bf T}_n \cdot {\bf S} \ \delta u \left|\frac{\partial {\bf R}}{\partial \xi}\right|\ d\xi. \f] We shall now demonstrate that the integrand in this expression can be expressed in terms of the contact angle boundary condition( @R[contact_angle_bc]@). We start with several observations:-# \f${\bf T}_t\f$ is tangential to the wall. \n\n -# Since \f${\bf N}_{\rm wall}\f$ is normal to the wall, \f${\bf T}_t \times {\bf N}_{\rm wall}\f$ is tangential to the wall and orthogonal to \f${\bf T}_t\f$. \n\n -# \f${\bf S}\f$ is tangential to the wall and can therefore be decomposed into its components parallel to \f$ {\bf T}_t \f$ and \f${\bf T}_t \times {\bf N}_{\rm wall} \f$ as \f[{\bf S}=\alpha {\bf T}_t+\beta({\bf T}_t \times {\bf N}_{\rm wall}) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @E[S_decomp]@ \f] for some values of \f$\alpha\f$ and \f$\beta\f$. In fact, \f[\beta={\bf S} \cdot({\bf T}_t \times {\bf N}_{\rm wall}) \f] -# During the computation it is most convenient to perform all calculations in terms of quantities that are easily obtained from the parametrisation of the meniscus as this avoids having to specify \f${\bf N}_{\rm wall}\f$ explicitly. For this purpose we exploit that \f${\bf T}_t\f$ and \f${\bf S}\f$ are tangential to the wall and not parallel to each other(unless the parametrisation of the meniscus by( @R[spine]@) is no longer one-to-one). Therefore \f${\bf N}_{\rm wall}\f$ can be obtained from quantities that are intrinsic to the meniscus representation via \n\n \f[{\bf N}_{\rm wall}=\frac{ {\bf S} \times {\bf T}_t } {|{\bf S} \times {\bf T}_t|} \f] and thus \f[\beta={\bf S} \cdot \left({\bf T}_t \times \frac{ {\bf S} \times {\bf T}_t } {|{\bf S} \times {\bf T}_t|} \right) \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @E[beta]@ \f] -# Given( @R[S_decomp]@) and the fact that \f${\bf T}_t \cdot {\bf T}_n=0\f$, we have \n\n \f[{\bf S} \cdot {\bf T}_n=\beta({\bf T}_t \times {\bf N}_{\rm wall}) \cdot {\bf T}_n \f] and with( @R[contact_angle_bc]@):\f[{\bf S} \cdot {\bf T}_n=\beta \cos \gamma. \f] Hence, the line integral may be written as \f[\delta \Pi_{\rm contact\ line}=\int_{\partial D_{\rm angle}} \beta \cos \gamma \ \delta u \left|\frac{\partial {\bf R}}{\partial \xi}\right|\ d\xi, \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ @E[final_eqn]@ \f] where \f$ \beta \f$ is given by( @R[beta]@). . Equation( @R[final_eqn]@) is easily discretised by finite elements. Within \c oomph-lib, the line integral is decomposed into \c FaceElements that are attached to the &quot;bulk&quot; Young-Laplace elements that are adjacent to the contact line. The imposition of the contact angle boundary condition for the Young Laplace equation is therefore as easy as the application of Neumann boundary conditions for a Poisson equation, say.&lt; HR &gt;&lt; HR &gt; \section results Results The animation below illustrates the variation in the quasi-steady meniscus shape as the fluid enters the T-junction. @I w 0.6\textwidth t_junction_meniscus &quot;Animation of the meniscus shapes. &quot; The computation was performed with full spatial adaptivity. The plot below illustrates how the automatic mesh adaptation has strongly refined the mesh towards the corners of the domain where the meniscus shape has a singularity.(The singularity develops because in the corners of the domain the contact angle boundary condition along the side walls is inconsistent with the \f$ 90^o \f$ contact angle enforced by the pinned boundary condition along the sharp edges.) @I w 0.6\textwidth t_junction_meniscus_adapt &quot;Illustration of the adaptive mesh refinement. &quot; Finally, here is a plot of the &quot;load-displacement diagram&quot;, i.e. a plot of the meniscus deflection as a function of its curvature(i.e. the applied pressure drop). The limit point indicates the maximum pressure that can be withstood by the static meniscus. @I w 0.6\textwidth t_junction_trace &quot;The load-displacement diagram for the meniscus. &quot;&lt; HR &gt;&lt; HR &gt; \section code The driver code The modifications to the driver code required to impose the contact angle boundary conditions are very similar to those used in other driver codes for problems with Neumann-type boundary conditions. We attach \c FaceElements to the appropriate faces of the &quot;bulk&quot; Young-Laplace elements detach/re-attach them before and after any spatial adaptation of the &quot;bulk&quot; mesh.&lt; HR &gt;&lt; HR &gt; \subsection namespace The global namespace The namespace that defines the problem parameters is very similar to that used in the&lt; a href=&quot;../../young_laplace/html/index.html&quot;&gt;previous example&lt;/a &gt; without contact angle boundary conditions. We provide storage for the cosine of the contact angle, and the prescribed meniscus height that is used by the displacement control method. \dontinclude refineable_t_junction.cc \skipline start_of_namespace \until Controlled_height&lt; a href=&quot;../../young_laplace/html/index.html&quot;&gt;As before&lt;/a &gt;, we use the spine basis \f$ {\bf B}(\zeta_1,\zeta_2)=(\zeta_1,\zeta_2, 0)^T, \f$ to establish a reference configuration in which the flat meniscus is located in the plane \f$ z=0 \f$ and occupies the domain \f$(x, y) \in[0, L_x] \times[0, L_y]. \f$ \until End of bspine functions As in the&lt; a href=&quot;../../young_laplace/html/index.html&quot;&gt;previous example&lt;/a &gt;, we rotate the spines in the \f$ y \f$ -direction to allow the representation of meniscus shapes that cannot be projected onto the \f$(x, y) \f$ -plane. \until end of namespace&lt; HR &gt;&lt; HR &gt; \subsection main The driver code We start by defining the output directory and open a trace file to record the load-displacement curve. \dontinclude refineable_t_junction.cc \skipline start_of_main \until ZONE Next, we create the problem object, refine the mesh uniformly and output the initial guess for the solution:a flat interface which, unlike the&lt; a href=&quot;../../young_laplace/html/index.html&quot;&gt;previous case&lt;/a &gt;, is not a solution of the problem because it does not satisfy the contact-angle boundary condition line</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00322">contact_angle.txt:322</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_ac5ebdd64750809ad044f7b102ab5a45f"><div class="ttname"><a href="contact__angle_8txt.html#ac5ebdd64750809ad044f7b102ab5a45f">reduced</a></div><div class="ttdeci">zeta_2 f is about to become non one to this should allow the computation of arbitrarily large meniscus deflections Try it out and let us know how it works n n subsection zero Zero contact angles Our problem formulation suffers from an more fundamental it is always possible to extend the meniscus with an arbitrary length collar along the wall without changing the overall energy of the system As a the position of the contact line becomes increasingly ill defined as the contact angle f gamma f is reduced</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00545">contact_angle.txt:545</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a1fb0af87944088494d613bb5065d161e"><div class="ttname"><a href="contact__angle_8txt.html#a1fb0af87944088494d613bb5065d161e">f</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section model A model problem The figure below shows a sketch of a T junction in a microchannel with a rectangular cross f where a comma denotes partial differentiation with respect to one of the intrinsic f</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00079">contact_angle.txt:79</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_ac8774b3418c4551091d64ec72c169b2e"><div class="ttname"><a href="namespaceGlobalParameters.html#ac8774b3418c4551091d64ec72c169b2e">GlobalParameters::L_y</a></div><div class="ttdeci">double L_y</div><div class="ttdoc">Width of domain.</div><div class="ttdef"><b>Definition:</b> <a href="common__young__laplace__stuff_8h_source.html#l00097">common_young_laplace_stuff.h:97</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_acba41ca01e3e7043c5237b77d0e412c9"><div class="ttname"><a href="contact__angle_8txt.html#acba41ca01e3e7043c5237b77d0e412c9">widehat</a></div><div class="ttdeci">f and assume that we have computed a meniscus shape in the form n n f[\widehat{\bf R}={\bf R}(\zeta_1,\zeta_2)={\bf B}(\zeta_1,\zeta_2)+u(\zeta_1,\zeta_2) \ {\bf S}(\zeta_1,\zeta_2)\f] with an associated normal vector f widehat</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00513">contact_angle.txt:513</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a149f6c219caa11cbda5b163177eb28a6"><div class="ttname"><a href="contact__angle_8txt.html#a149f6c219caa11cbda5b163177eb28a6">result</a></div><div class="ttdeci">zeta_2 f is about to become non one to this should allow the computation of arbitrarily large meniscus deflections Try it out and let us know how it works n n subsection zero Zero contact angles Our problem formulation suffers from an more fundamental it is always possible to extend the meniscus with an arbitrary length collar along the wall without changing the overall energy of the system As a result</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00544">contact_angle.txt:544</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_aaa42563ef08c5f0665126884a22dd60b"><div class="ttname"><a href="contact__angle_8txt.html#aaa42563ef08c5f0665126884a22dd60b">coordinates</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section model A model problem The figure below shows a sketch of a T junction in a microchannel with a rectangular cross f where a comma denotes partial differentiation with respect to one of the intrinsic coordinates</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00077">contact_angle.txt:77</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_ad6446204c8469ca2c2afc71ea3d37161"><div class="ttname"><a href="contact__angle_8txt.html#ad6446204c8469ca2c2afc71ea3d37161">one</a></div><div class="ttdeci">zeta_2 f is one to one</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00119">contact_angle.txt:119</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a831d1ad5f0468950f29fbf410fa323b0"><div class="ttname"><a href="contact__angle_8txt.html#a831d1ad5f0468950f29fbf410fa323b0">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00007">contact_angle.txt:7</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a89176c66757d666599a5b244526ae379"><div class="ttname"><a href="contact__angle_8txt.html#a89176c66757d666599a5b244526ae379">zeta_1</a></div><div class="ttdeci">zeta_1</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00118">contact_angle.txt:118</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_afe1463a794a507ff713e1d4421c8ab32"><div class="ttname"><a href="contact__angle_8txt.html#afe1463a794a507ff713e1d4421c8ab32">usual</a></div><div class="ttdeci">As usual</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00390">contact_angle.txt:390</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a8ead20b6901ec2be04162b161f72c27d"><div class="ttname"><a href="contact__angle_8txt.html#a8ead20b6901ec2be04162b161f72c27d">method</a></div><div class="ttdeci">we perform a parameter study by slowly incrementing the control displacement and recomputing the meniscus shape until end of main&lt; HR &gt;&lt; HR &gt; subsection class The problem class The problem class contains the usual member functions The functions c to the node at which the meniscus displacement is prescribed by the displacement control method</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00355">contact_angle.txt:355</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a7f1bd96b0bc99332494bd18ff2911a66"><div class="ttname"><a href="contact__angle_8txt.html#a7f1bd96b0bc99332494bd18ff2911a66">the</a></div><div class="ttdeci">we perform a parameter study by slowly incrementing the control displacement and recomputing the meniscus shape until end of main&lt; HR &gt;&lt; HR &gt; subsection class The problem class The problem class contains the usual member functions The functions c to the node at which the meniscus displacement is prescribed by the displacement control and to the c Data object whose one and only value stores the(unknown) meniscus curvature. \until end of problem class&lt; HR &gt;&lt; HR &gt; \subsection const r The problem const ructor We start by creating the &quot;bulk&quot; mesh of refineable Young Laplace elements and specify the error estimator. \skipline start_of_constructor \until min_permitted_error() We identify the node(in the centre of the mesh) at which we apply displacement control. We pass a pointer to this node to the const ructor of the displacement control element and store that element in its own mesh. \until kappa_pt() Next we create the mesh that stores the contact-angle elements. We attach these elements to boundaries 1 and 3 of the &quot;bulk&quot; mesh. \until contact_angle_elements(3)</div></div>
<div class="ttc" id="acontact__angle_8txt_html_a99dbc0cdc09dcffd5db4c4e43097955f"><div class="ttname"><a href="contact__angle_8txt.html#a99dbc0cdc09dcffd5db4c4e43097955f">_</a></div><div class="ttdeci">zeta_2 f is one to at least for the meniscus shapes of interest n n Along the parts of the boundary where the contact line is pinned we have f[\left. {\bf B}\right|_{\partial D_{\rm pinned}}={\bf R}_{\rm pinned} \f] so that the pinned boundary condition may be enforced by setting f u _</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00127">contact_angle.txt:127</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_aea098d41c137bea6b6c09aeeec487c98"><div class="ttname"><a href="contact__angle_8txt.html#aea098d41c137bea6b6c09aeeec487c98">meniscus</a></div><div class="ttdeci">As we enforce only the essential boundary conditions directly by pinning the meniscus displacement along mesh boundaries we complete the build of the contact line elements by passing the pointer to the double that stores the cosine of the contact angle until All that s now left to do is to assign the equation the meniscus and various contact line quantities skipline start_of_doc until end of doc&lt; HR &gt;&lt; HR &gt; section comm_ex Comments and Exercises subsection ic How to generate a good initial guess for the solution We already commented on the need to provide a good initial guess for the solution in order to ensure the convergence of the Newton iteration In the&lt; a href=&quot;../../young_laplace/html/index.html&quot;&gt; previous example&lt;/a &gt; this was easy because the flat meniscus(clearly a solution of the Young-Laplace equations for zero curvature) also satisfied the boundary conditions. In the present example</div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a36ebf514fdd1e78fff69907b39e25af6"><div class="ttname"><a href="namespaceGlobalParameters.html#a36ebf514fdd1e78fff69907b39e25af6">GlobalParameters::L_x</a></div><div class="ttdeci">double L_x</div><div class="ttdoc">Length and width of the domain.</div><div class="ttdef"><b>Definition:</b> <a href="common__young__laplace__stuff_8h_source.html#l00096">common_young_laplace_stuff.h:96</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a770d352b78a60074a229f760bc2e0179"><div class="ttname"><a href="contact__angle_8txt.html#a770d352b78a60074a229f760bc2e0179">build_global_mesh</a></div><div class="ttdeci">The various sub meshes are now added to the problem and the global mesh is built until build_global_mesh()</div></div>
<div class="ttc" id="acontact__angle_8txt_html_a33627a065364ea8dd322b8fb6b115cea"><div class="ttname"><a href="contact__angle_8txt.html#a33627a065364ea8dd322b8fb6b115cea">shape</a></div><div class="ttdeci">As we enforce only the essential boundary conditions directly by pinning the meniscus displacement along mesh boundaries we complete the build of the contact line elements by passing the pointer to the double that stores the cosine of the contact angle until All that s now left to do is to assign the equation the meniscus shape</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00444">contact_angle.txt:444</a></div></div>
<div class="ttc" id="anamespaceGlobalParameters_html_a3731f24a02ce4f306d65a9a488f85c96"><div class="ttname"><a href="namespaceGlobalParameters.html#a3731f24a02ce4f306d65a9a488f85c96">GlobalParameters::Controlled_height</a></div><div class="ttdeci">double Controlled_height</div><div class="ttdoc">Height control value.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00051">barrel.cc:51</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_ad929b1cb755dfec91450fd4b3154900e"><div class="ttname"><a href="contact__angle_8txt.html#ad929b1cb755dfec91450fd4b3154900e">Finally</a></div><div class="ttdeci">Finally</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00328">contact_angle.txt:328</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a65f0eb70d5423dbcc17eb94e608dc1e4"><div class="ttname"><a href="contact__angle_8txt.html#a65f0eb70d5423dbcc17eb94e608dc1e4">and</a></div><div class="ttdeci">As we enforce only the essential boundary conditions directly by pinning the meniscus displacement along mesh boundaries and</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00402">contact_angle.txt:402</a></div></div>
<div class="ttc" id="abarrel_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="barrel_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver code.</div><div class="ttdef"><b>Definition:</b> <a href="barrel_8cc_source.html#l00321">barrel.cc:321</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a702b17a2fe60fde7205a2ed1a0e0aaeb"><div class="ttname"><a href="contact__angle_8txt.html#a702b17a2fe60fde7205a2ed1a0e0aaeb">section</a></div><div class="ttdeci">now Rennes n n&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt;&lt; HR &gt;&lt; HR &gt; section model A model problem The figure below shows a sketch of a T junction in a microchannel with a rectangular cross section(The front wall has been removed for clarity). Fluid is being pushed quasi-steadily along the(vertical) main channel and is in the process of entering the T-junction. We assume that the air-liquid interface(shown in red) remains pinned at the two sharp edges(at \f$ y</div></div>
<div class="ttc" id="acontact__angle_8txt_html_a802f8e271de9fb1ab9bea27c08406a45"><div class="ttname"><a href="contact__angle_8txt.html#a802f8e271de9fb1ab9bea27c08406a45">additional</a></div><div class="ttdeci">zeta_2 f is about to become non one to this should allow the computation of arbitrarily large meniscus deflections Try it out and let us know how it works n n subsection zero Zero contact angles Our problem formulation suffers from an additional</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00536">contact_angle.txt:536</a></div></div>
<div class="ttc" id="acontact__angle_8txt_html_a0dca5b672cf8d7005ba5aead13a49b02"><div class="ttname"><a href="contact__angle_8txt.html#a0dca5b672cf8d7005ba5aead13a49b02">Paris</a></div><div class="ttdeci">mainpage Example and then discuss the spine based representation of free contact lines and the implementation of the contact angle boundary condition along such lines&lt; CENTER &gt;&lt; TABLE BORDER=1, WIDTH=500px &gt;&lt; TR &gt;&lt; TD bgcolor=&quot;cornsilk&quot;&gt;&lt; CENTER &gt;&lt; B &gt; Paris</div><div class="ttdef"><b>Definition:</b> <a href="contact__angle_8txt_source.html#l00020">contact_angle.txt:20</a></div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Fri Aug 27 2021 17:50:22
        </div>
      </div>
    </footer>
</body>
</html>

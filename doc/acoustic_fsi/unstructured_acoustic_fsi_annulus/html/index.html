<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: Time-harmonic acoustic fluid-structure interaction problems on unstructured meshes</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Installation<span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.9.1 -->
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Time-harmonic acoustic fluid-structure interaction problems on unstructured meshes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>In this document we discuss the solution of time-harmonic acoustic fluid-structure interaction problems on unstructured meshes.</p>
<p>The driver code is very similar to the one presented in <a href="../../acoustic_fsi_annulus/html/index.html">another tutorial</a> and we only discuss the changes necessary to deal with the generation of the unstructured mesh for the solid domain and the assignment of different material properties to different parts of the domain.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="test"></a>
A test problem</h1>
<p>The sketch below shows the problem setup: A 2D elastic annulus which is reinforced with two T-ribs is immersed in a compressible fluid and subjected to a time-periodic pressure load of magnitude </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf t} = P ( \exp(\alpha(\varphi-\pi/4)^2) + \exp(\alpha(\varphi-3\pi/4)^2) ) \]" src="form_0.png" width="254" height="16"/>
</p>
<p> (where <img class="formulaInl" alt="$ \varphi $" src="form_1.png" width="8" height="9"/> is the polar angle) along its inner surface. The parameter <img class="formulaInl" alt="$ \alpha $" src="form_2.png" width="8" height="6"/> controls the "sharpness" of the pressure load. For <img class="formulaInl" alt="$ \alpha=0 $" src="form_3.png" width="30" height="9"/> we obtain a uniform, axisymmetric load; the sketch below shows the pressure distribution (red vectors indicating the traction) for <img class="formulaInl" alt="$ \alpha = 200. $" src="form_4.png" width="46" height="9"/></p>
<div class="image">
<img src="setup.gif" alt=""/>
<div class="caption">
Sketch of the problem setup. </div></div>
 <p>The structure is symmetric and we only discretise the right half ( <img class="formulaInl" alt="$ x_1 &gt; 0 $" src="form_5.png" width="36" height="11"/>) of the domain and apply symmetry conditions (zero horizontal displacement) on the <img class="formulaInl" alt="$ x_2-$" src="form_6.png" width="23" height="9"/> axis.</p>
<hr  />
 <hr  />
<h1><a class="anchor" id="results"></a>
Results</h1>
<p>The figure below shows an animation of the structure's time-harmonic oscillation. The blue shaded region shows the shape of the oscillating structure while the pink region shows its initial configuration. The left half of the plot is used to show the (mirror image of the) adaptive unstructured mesh on which the solution was computed:</p>
<div class="image">
<img src="anim.gif" alt=""/>
<div class="caption">
Animation of the time-harmonic deformation. </div></div>
 <p>Here is a plot of the corresponding fluid displacement potential, a measure of the fluid pressure:</p>
<div class="image">
<img src="potential_unstr.gif" alt=""/>
<div class="caption">
The fluid displacement potential, a measure of the fluid pressure. Elevation: real part; contours: imaginary part. </div></div>
 <p>This looks very pretty and shows that we can solve acoustic FSI problems in non-trivial geometries but should you believe the results? Here's an attempt to convince you: If we make the rib much softer than the annulus and set its inertia to zero the rib will not offer much structural resistance and the annular region will deform as if the rib was not present. If we then set <img class="formulaInl" alt="$ \alpha = 0 $" src="form_7.png" width="30" height="9"/> we apply an axisymmetric forcing onto the structure and would expect the resulting displacement field (at least in the annular region) to be axisymmetric.</p>
<p>The animation of the displacement field for this case, shown below, shows that this is indeed the case:</p>
<div class="image">
<img src="anim_alpha0.gif" alt=""/>
<div class="caption">
Animation of the time-harmonic deformation for uniform pressure load and a very soft and inertia-less rib. </div></div>
 <p>Here is a plot of the corresponding fluid displacement potential, a measure of the fluid pressure:</p>
<div class="image">
<img src="potential_unstr_alpha0.gif" alt=""/>
<div class="caption">
The fluid displacement potential, a measure of the fluid pressure for a uniform pressure load and very soft and inertia-less rib. Elevation: real part; contours: imaginary part. </div></div>
 <hr  />
 <hr  />
<h1><a class="anchor" id="num"></a>
The numerical solution</h1>
<p>The driver code for this problem is very similar to the one discussed in <a href="../../acoustic_fsi_annulus/html/index.html">another tutorial</a>. Running <code>sdiff</code> on the two driver codes </p><center> <a href="../../../../demo_drivers/interaction/acoustic_fsi/acoustic_fsi.cc">demo_drivers/interaction/acoustic_fsi/acoustic_fsi.cc </a> </center><p> and </p><center> <a href="../../../../demo_drivers/interaction/acoustic_fsi/unstructured_acoustic_fsi.cc">demo_drivers/interaction/acoustic_fsi/unstructured_acoustic_fsi.cc </a> </center><p> shows you the differences, the most important of which are:</p><ul>
<li>The use of <a href="../../../helmholtz/scattering/html/index.html#ABCs">approximate/absorbing boundary conditions (ABCs)</a> rather than a <a href="../../../helmholtz/scattering/html/index.html#DtN">Dirichlet-to-Neumann mapping</a> for the Helmholtz equation, because the boundary along which the Sommerfeld radiation condition is applied is not a full circle. <br  />
<br  />
</li>
<li>The provision of multiple elasticity tensors and frequency parameters for the two different regions (the rib and the annulus). <br  />
<br  />
</li>
<li>The change of forcing from a prescribed time-harmonic displacement to a pressure load on the inside boundary &ndash; this requires yet another mesh of <code>FaceElements</code>. <br  />
<br  />
</li>
<li>The provision of a helper function <code>complete_problem_setup()</code> which rebuilds the elements (by passing the problem parameters to the elements) following the unstructured mesh adaptation. (The need/rationale for such a function is discussed in <a href="../../../meshes/mesh_from_inline_triangle/html/index.html">another tutorial.</a>) <br  />
<br  />
</li>
<li>The mesh generation &ndash; the specification of the curvilinear boundaries and the geometry of the rib is somewhat tedious. We refer to <a href="../../../meshes/mesh_from_inline_triangle_internal_boundaries/html/index.html">another tutorial</a> for a discussion of how to define the internal mesh boundary that separates the two regions (the rib and the annular region) so that we can assign different material properties to them. <br  />
<br  />
. <br  />
 All of this is reasonably straightforward and provides a powerful code that automatically adapts both meshes while respecting the curvilinear boundaries of the domain. Have a look through the driver code and play with it.</li>
</ul>
<hr  />
 <hr  />
<h1><a class="anchor" id="code"></a>
Code listing</h1>
<p>Here's a listing of the complete driver code:</p>
<div class="fragment"><div class="line"><span class="comment">//LIC// ====================================================================</span></div>
<div class="line"><span class="comment">//LIC// This file forms part of oomph-lib, the object-oriented, </span></div>
<div class="line"><span class="comment">//LIC// multi-physics finite-element library, available </span></div>
<div class="line"><span class="comment">//LIC// at http://www.oomph-lib.org.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// Copyright (C) 2006-2024 Matthias Heil and Andrew Hazel</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is free software; you can redistribute it and/or</span></div>
<div class="line"><span class="comment">//LIC// modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment">//LIC// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// This library is distributed in the hope that it will be useful,</span></div>
<div class="line"><span class="comment">//LIC// but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><span class="comment">//LIC// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span></div>
<div class="line"><span class="comment">//LIC// Lesser General Public License for more details.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment">//LIC// License along with this library; if not, write to the Free Software</span></div>
<div class="line"><span class="comment">//LIC// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA</span></div>
<div class="line"><span class="comment">//LIC// 02110-1301  USA.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC// The authors may be contacted at oomph-lib@maths.man.ac.uk.</span></div>
<div class="line"><span class="comment">//LIC// </span></div>
<div class="line"><span class="comment">//LIC//====================================================================</span></div>
<div class="line"><span class="comment">// Driver for Helmholtz/TimeHarmonicTimeHarmonicLinElast coupling</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//Oomph-lib includes</span></div>
<div class="line"><span class="preprocessor">#include &quot;generic.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;helmholtz.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;time_harmonic_linear_elasticity.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;multi_physics.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">//The meshes</span></div>
<div class="line"><span class="preprocessor">#include &quot;meshes/annular_mesh.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;meshes/triangle_mesh.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>std;</div>
<div class="line"><span class="keyword">using namespace </span>oomph;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span><span class="comment">// Straight line as geometric object</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ////////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=========================================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Straight 1D line in 2D space </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=========================================================================</span></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classMyStraightLine.html">MyStraightLine</a> : <span class="keyword">public</span> GeomObject</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:  Pass start and end points</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(<span class="keyword">const</span> Vector&lt;double&gt;&amp; r_start, <span class="keyword">const</span> Vector&lt;double&gt;&amp; r_end) </div>
<div class="line">  :  GeomObject(1,2), R_start(r_start), R_end(r_end)</div>
<div class="line">  { }</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Broken copy constructor</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(<span class="keyword">const</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>&amp; dummy) </div>
<div class="line">  { </div>
<div class="line">   BrokenCopy::broken_copy(<span class="stringliteral">&quot;MyStraightLine&quot;</span>);</div>
<div class="line">  } </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Broken assignment operator</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> operator=(<span class="keyword">const</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>&amp;) </div>
<div class="line">  {</div>
<div class="line">   BrokenCopy::broken_assign(<span class="stringliteral">&quot;MyStraightLine&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Destructor:  Empty</span></div>
<div class="line"><span class="comment"></span> ~<a class="code" href="classMyStraightLine.html">MyStraightLine</a>(){}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Position Vector at Lagrangian coordinate zeta </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> position(<span class="keyword">const</span> Vector&lt;double&gt;&amp; zeta, Vector&lt;double&gt;&amp; r)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">   <span class="comment">// Position Vector</span></div>
<div class="line">   r[0] = R_start[0]+(R_end[0]-R_start[0])*zeta[0];</div>
<div class="line">   r[1] = R_start[1]+(R_end[1]-R_start[1])*zeta[0];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Start point of line</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; R_start;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// End point of line</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; R_end;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/// ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment">/// ///////////////////////////////////////////////////////////////////</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=======start_namespace==========================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Global variables</span></div>
<div class="line"><span class="comment"></span><span class="comment">//================================================================</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceGlobal__Parameters.html">Global_Parameters</a></div>
<div class="line">{</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Square of wavenumber for the Helmholtz equation</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">K_squared</a>=10.0;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Radius of outer boundary of Helmholtz domain</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Outer_radius</a>=4.0; </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Order of absorbing/appproximate boundary condition</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#ae16eb10039cab2098b02ec7dff946277">ABC_order</a>=3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// FSI parameter</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Q</a>=0.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Non-dim thickness of elastic coating</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#ae3cf8878ede839bffda01f79bbe3e819">H_coating</a>=0.1; </div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Poisson&#39;s ratio</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Nu</a> = 0.3;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Square of non-dim frequency for the two regions -- dependent variable!</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Omega_sq</a>(2,0.0);</div>
<div class="line">  <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Density ratio for the two regions: solid to fluid</span></div>
<div class="line"><span class="comment"></span> Vector&lt;double&gt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Density_ratio</a>(2,0.1);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// The elasticity tensors for the two regions</span></div>
<div class="line"><span class="comment"></span> Vector&lt;TimeHarmonicIsotropicElasticityTensor*&gt; <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">E_pt</a>;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Function to update dependent parameter values</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">update_parameter_values</a>()</div>
<div class="line"> {</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Omega_sq</a>[0]=<a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Density_ratio</a>[0]*<a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Q</a>;</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Omega_sq</a>[1]=<a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Density_ratio</a>[1]*<a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Q</a>;</div>
<div class="line"> }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Uniform pressure</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a> = 0.1;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Peakiness parameter for pressure load</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">double</span> <a class="code" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Alpha</a>=200.0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pressure load (real and imag part)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> <a class="code" href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">pressure_load</a>(<span class="keyword">const</span> Vector&lt;double&gt; &amp;x,</div>
<div class="line">                    <span class="keyword">const</span> Vector&lt;double&gt; &amp;n, </div>
<div class="line">                    Vector&lt;std::complex&lt;double&gt; &gt;&amp;traction)</div>
<div class="line"> {</div>
<div class="line">  <span class="keywordtype">double</span> phi=atan2(x[1],x[0]);</div>
<div class="line">  <span class="keywordtype">double</span> magnitude=exp(-<a class="code" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Alpha</a>*pow(phi-0.25*MathematicalConstants::Pi,2));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> dim = traction.size();</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;dim;i++)</div>
<div class="line">   {</div>
<div class="line">    traction[i] = complex&lt;double&gt;(-magnitude*<a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i],magnitude*<a class="code" href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">P</a>*n[i]);</div>
<div class="line">   }</div>
<div class="line"> } <span class="comment">// end_of_pressure_load</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output directory</span></div>
<div class="line"> <span class="keywordtype">string</span> <a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Directory</a>=<span class="stringliteral">&quot;RESLT&quot;</span>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Multiplier for number of elements</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> <a class="code" href="namespaceGlobal__Parameters.html#a35d5d2ecfff0cec6150a5dc79e5c1ad1">El_multiplier</a>=1;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end namespace</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=============begin_problem============================================ </span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Coated disk FSI</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keyword">class </span><a class="code" href="classCoatedDiskProblem.html">CoatedDiskProblem</a> : <span class="keyword">public</span> Problem</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Constructor:</span></div>
<div class="line"><span class="comment"></span> <a class="code" href="classCoatedDiskProblem.html">CoatedDiskProblem</a>();</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_before_newton_solve() {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Update function (empty)</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_after_newton_solve() {}</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Actions before adapt: Wipe the face meshes</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_before_adapt();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Actions after adapt: Rebuild the face meshes</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> actions_after_adapt();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Doc the solution</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> doc_solution();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> <span class="keywordtype">void</span> complete_problem_setup(); </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create solid traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_solid_traction_elements();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Create FSI traction elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_fsi_traction_elements();</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Create Helmholtz FSI flux elements</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_helmholtz_fsi_flux_elements();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Delete (face) elements in specified mesh </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> delete_face_elements(Mesh* <span class="keyword">const</span> &amp; boundary_mesh_pt);</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Create ABC face elements </span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> create_helmholtz_ABC_elements();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Setup interaction</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">void</span> setup_interaction();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to refineable solid mesh</span></div>
<div class="line"><span class="comment"></span> RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;* Solid_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of solid traction elements</span></div>
<div class="line"><span class="comment"></span> Mesh* Solid_traction_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of FSI traction elements</span></div>
<div class="line"><span class="comment"></span> Mesh* FSI_traction_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span> TreeBasedRefineableMeshBase* Helmholtz_mesh_pt;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Pointer to mesh of Helmholtz FSI flux elements</span></div>
<div class="line"><span class="comment"></span> Mesh* Helmholtz_fsi_flux_mesh_pt;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Pointer to mesh containing the ABC elements</span></div>
<div class="line"><span class="comment"></span> Mesh* Helmholtz_outer_boundary_mesh_pt;</div>
<div class="line"> <span class="comment"></span></div>
<div class="line"><span class="comment"> /// Boundary ID of upper symmetry boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Upper_symmetry_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower symmetry boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Lower_symmetry_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of upper inner boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Upper_inner_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of lower inner boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Lower_inner_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Boundary ID of outer boundary</span></div>
<div class="line"><span class="comment"></span> <span class="keywordtype">unsigned</span> Outer_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Boundary ID of rib divider</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> Rib_divider_boundary_id;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// DocInfo object for output</span></div>
<div class="line"><span class="comment"></span> DocInfo Doc_info;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> /// Trace file</span></div>
<div class="line"><span class="comment"></span> ofstream Trace_file;</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//===========start_of_constructor======================================= </span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Constructor</span></div>
<div class="line"><span class="comment"></span><span class="comment">//====================================================================== </span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a9585ca5b422c72dc2b91cbb3e311b736">CoatedDiskProblem&lt;ELASTICITY_ELEMENT, HELMHOLTZ_ELEMENT&gt;::CoatedDiskProblem</a>() </div>
<div class="line">{</div>
<div class="line"> <span class="comment">// To suppress boundary warnings (to avoid a lot of warnings) uncomment</span></div>
<div class="line"> <span class="comment">// the following code:</span></div>
<div class="line"> <span class="comment">//UnstructuredTwoDMeshGeometryBase::</span></div>
<div class="line"> <span class="comment">// Suppress_warning_about_regions_and_boundaries=true;</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid mesh</span></div>
<div class="line"> <span class="comment">//-----------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Start and end coordinates</span></div>
<div class="line"> Vector&lt;double&gt; r_start(2);</div>
<div class="line"> Vector&lt;double&gt; r_end(2);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Outer radius of hull</span></div>
<div class="line"> <span class="keywordtype">double</span> r_outer = 1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Inner radius of hull</span></div>
<div class="line"> <span class="keywordtype">double</span> r_inner = r_outer-<a class="code" href="namespaceGlobal__Parameters.html#ae3cf8878ede839bffda01f79bbe3e819">Global_Parameters::H_coating</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Thickness of rib</span></div>
<div class="line"> <span class="keywordtype">double</span> rib_thick=0.05;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Depth of rib</span></div>
<div class="line"> <span class="keywordtype">double</span> rib_depth=0.2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Total width of T</span></div>
<div class="line"> <span class="keywordtype">double</span> t_width=0.2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Thickness of T</span></div>
<div class="line"> <span class="keywordtype">double</span> t_thick=0.05;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Half-opening angle of rib</span></div>
<div class="line"> <span class="keywordtype">double</span> half_phi_rib=asin(0.5*rib_thick/r_inner);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Pointer to the closed curve that defines the outer boundary</span></div>
<div class="line"> TriangleMeshClosedCurve* closed_curve_pt=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Provide storage for pointers to the parts of the curvilinear boundary</span></div>
<div class="line"> Vector&lt;TriangleMeshCurveSection*&gt; curvilinear_boundary_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Outer boundary</span></div>
<div class="line"> <span class="comment">//---------------</span></div>
<div class="line"> Ellipse* outer_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_outer,r_outer);</div>
<div class="line"> <span class="keywordtype">double</span> zeta_start=-0.5*MathematicalConstants::Pi;</div>
<div class="line"> <span class="keywordtype">double</span> zeta_end=0.5*MathematicalConstants::Pi;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nsegment=50;</div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   outer_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Outer_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Upper straight line segment on symmetry axis</span></div>
<div class="line"> <span class="comment">//---------------------------------------------</span></div>
<div class="line"> r_start[0]=0.0;</div>
<div class="line"> r_start[1]=r_outer;</div>
<div class="line"> r_end[0]=0.0;</div>
<div class="line"> r_end[1]=r_inner;</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* upper_sym_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   upper_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">                                                        </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Upper_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Upper part of inner boundary</span></div>
<div class="line"> <span class="comment">//-----------------------------</span></div>
<div class="line"> Ellipse* upper_inner_boundary_pt = </div>
<div class="line">  <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line"> zeta_start=0.5*MathematicalConstants::Pi;</div>
<div class="line"> zeta_end=half_phi_rib;</div>
<div class="line"> nsegment=20;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   upper_inner_boundary_pt,</div>
<div class="line">   zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Upper_inner_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Data associated with rib</span></div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* upper_inward_rib_pt=0;</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* lower_inward_rib_pt=0;</div>
<div class="line"> TriangleMeshCurviLine* upper_inward_rib_curviline_pt=0;</div>
<div class="line"> Vector&lt;TriangleMeshOpenCurve*&gt; inner_boundary_pt;</div>
<div class="line"> TriangleMeshCurviLine* lower_inward_rib_curviline_pt=0;</div>
<div class="line"> Vector&lt;double&gt; rib_center(2);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Upper half of inward rib</span></div>
<div class="line"> <span class="comment">//-------------------------</span></div>
<div class="line"> r_start[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_start[1]=r_inner*sin(half_phi_rib);</div>
<div class="line"> r_end[0]=r_start[0]-rib_depth;</div>
<div class="line"> r_end[1]=r_start[1];</div>
<div class="line"> upper_inward_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> upper_inward_rib_curviline_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   upper_inward_rib_pt,zeta_start,zeta_end,nsegment,boundary_id);</div>
<div class="line"> curvilinear_boundary_pt.push_back(upper_inward_rib_curviline_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical upper bit of T</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0];</div>
<div class="line"> r_end[1]=r_start[1]+0.5*(t_width-rib_thick);</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* vertical_upper_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   vertical_upper_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Horizontal upper bit of T</span></div>
<div class="line"> <span class="comment">//-----------==-------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0]-t_thick;</div>
<div class="line"> r_end[1]=r_start[1];</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* horizontal_upper_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   horizontal_upper_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical end of rib end</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0];</div>
<div class="line"> r_end[1]=-r_start[1];</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* inner_vertical_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   inner_vertical_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Horizontal lower bit of T</span></div>
<div class="line"> <span class="comment">//-----------==-------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0]+t_thick;</div>
<div class="line"> r_end[1]=r_start[1];</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* horizontal_lower_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   horizontal_lower_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical lower bit of T</span></div>
<div class="line"> <span class="comment">//------------------------</span></div>
<div class="line"> r_start[0]=r_end[0];</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> r_end[0]=r_start[0];</div>
<div class="line"> r_end[1]=r_start[1]+0.5*(t_width-rib_thick);</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* vertical_lower_t_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   vertical_lower_t_rib_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Lower half of inward rib</span></div>
<div class="line"> <span class="comment">//-------------------------</span></div>
<div class="line"> r_end[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_end[1]=-r_inner*sin(half_phi_rib);</div>
<div class="line"> r_start[0]=r_end[0]-rib_depth;</div>
<div class="line"> r_start[1]=r_end[1];</div>
<div class="line"> lower_inward_rib_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> lower_inward_rib_curviline_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   lower_inward_rib_pt,zeta_start,zeta_end,nsegment,boundary_id);</div>
<div class="line"> curvilinear_boundary_pt.push_back(lower_inward_rib_curviline_pt);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Lower part of inner boundary</span></div>
<div class="line"> <span class="comment">//-----------------------------</span></div>
<div class="line"> Ellipse* lower_inner_boundary_circle_pt = <span class="keyword">new</span> Ellipse(r_inner,r_inner);</div>
<div class="line"> zeta_start=-half_phi_rib;</div>
<div class="line"> zeta_end=-0.5*MathematicalConstants::Pi;</div>
<div class="line"> nsegment=20;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   lower_inner_boundary_circle_pt,zeta_start,zeta_end,nsegment,boundary_id)); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Lower_inner_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Lower straight line segment on symmetry axis</span></div>
<div class="line"> <span class="comment">//---------------------------------------------</span></div>
<div class="line"> r_start[0]=0.0;</div>
<div class="line"> r_start[1]=-r_inner;</div>
<div class="line"> r_end[0]=0.0;</div>
<div class="line"> r_end[1]=-r_outer;</div>
<div class="line"> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>* lower_sym_pt = <span class="keyword">new</span> <a class="code" href="classMyStraightLine.html">MyStraightLine</a>(r_start,r_end);</div>
<div class="line"> zeta_start=0.0;</div>
<div class="line"> zeta_end=1.0;</div>
<div class="line"> nsegment=1;</div>
<div class="line"> boundary_id=curvilinear_boundary_pt.size();</div>
<div class="line"> curvilinear_boundary_pt.push_back(</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshCurviLine(</div>
<div class="line">   lower_sym_pt,zeta_start,zeta_end,nsegment,boundary_id));</div>
<div class="line">      </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Lower_symmetry_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Combine to curvilinear boundary</span></div>
<div class="line"> <span class="comment">//--------------------------------</span></div>
<div class="line"> closed_curve_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshClosedCurve(curvilinear_boundary_pt); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Vertical dividing line across base of T-rib</span></div>
<div class="line"> <span class="comment">//--------------------------------------------</span></div>
<div class="line"> Vector&lt;TriangleMeshCurveSection*&gt; internal_polyline_pt(1);</div>
<div class="line"> r_start[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_start[1]=r_inner*sin(half_phi_rib);</div>
<div class="line"> r_end[0]=r_inner*cos(half_phi_rib);</div>
<div class="line"> r_end[1]=-r_inner*sin(half_phi_rib);</div>
<div class="line"> </div>
<div class="line"> Vector&lt;Vector&lt;double&gt; &gt; boundary_vertices(2);</div>
<div class="line"> boundary_vertices[0]=r_start;</div>
<div class="line"> boundary_vertices[1]=r_end;</div>
<div class="line"> boundary_id=100;</div>
<div class="line"> TriangleMeshPolyLine* rib_divider_pt=</div>
<div class="line">  <span class="keyword">new</span> TriangleMeshPolyLine(boundary_vertices,boundary_id); </div>
<div class="line"> internal_polyline_pt[0]=rib_divider_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Remember it</span></div>
<div class="line"> Rib_divider_boundary_id=boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Make connection</span></div>
<div class="line"> <span class="keywordtype">double</span> s_connect=0.0;</div>
<div class="line"> internal_polyline_pt[0]-&gt;connect_initial_vertex_to_curviline(</div>
<div class="line">  upper_inward_rib_curviline_pt,s_connect);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Make connection</span></div>
<div class="line"> s_connect=1.0;</div>
<div class="line"> internal_polyline_pt[0]-&gt;connect_final_vertex_to_curviline(</div>
<div class="line">  lower_inward_rib_curviline_pt,s_connect);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create open curve that defines internal bondary</span></div>
<div class="line"> inner_boundary_pt.push_back(<span class="keyword">new</span> TriangleMeshOpenCurve(internal_polyline_pt));</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define coordinates of a point inside the rib</span></div>
<div class="line"> rib_center[0]=r_inner-rib_depth;</div>
<div class="line"> rib_center[1]=0.0;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Now build the mesh</span></div>
<div class="line"> <span class="comment">//===================</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Use the TriangleMeshParameters object for helping on the manage of the</span></div>
<div class="line"> <span class="comment">// TriangleMesh parameters. The only parameter that needs to take is the</span></div>
<div class="line"> <span class="comment">// outer boundary.</span></div>
<div class="line"> TriangleMeshParameters triangle_mesh_parameters(closed_curve_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Target area</span></div>
<div class="line"> triangle_mesh_parameters.element_area()=0.2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Specify the internal open boundary</span></div>
<div class="line"> triangle_mesh_parameters.internal_open_curves_pt()=inner_boundary_pt;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define the region</span></div>
<div class="line"> triangle_mesh_parameters.add_region_coordinates(1,rib_center);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build the mesh</span></div>
<div class="line"> Solid_mesh_pt=<span class="keyword">new</span> </div>
<div class="line">  RefineableTriangleMesh&lt;ELASTICITY_ELEMENT&gt;(triangle_mesh_parameters);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Helmholtz mesh</span></div>
<div class="line"> <span class="comment">//---------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of elements in azimuthal direction in Helmholtz mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> ntheta_helmholtz=11*<a class="code" href="namespaceGlobal__Parameters.html#a35d5d2ecfff0cec6150a5dc79e5c1ad1">Global_Parameters::El_multiplier</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of elements in radial direction in Helmholtz mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nr_helmholtz=3*<a class="code" href="namespaceGlobal__Parameters.html#a35d5d2ecfff0cec6150a5dc79e5c1ad1">Global_Parameters::El_multiplier</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Innermost radius of Helmholtz mesh</span></div>
<div class="line"> <span class="keywordtype">double</span> a=1.0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Thickness of Helmholtz mesh</span></div>
<div class="line"> <span class="keywordtype">double</span> h_thick_helmholtz=<a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a>-a;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build mesh</span></div>
<div class="line"> <span class="keywordtype">bool</span> periodic=<span class="keyword">false</span>;</div>
<div class="line"> <span class="keywordtype">double</span> azimuthal_fraction=0.5;</div>
<div class="line"> <span class="keywordtype">double</span> phi=MathematicalConstants::Pi/2.0;</div>
<div class="line"> Helmholtz_mesh_pt = <span class="keyword">new</span> </div>
<div class="line">  RefineableTwoDAnnularMesh&lt;HELMHOLTZ_ELEMENT&gt;</div>
<div class="line">  (periodic,azimuthal_fraction,</div>
<div class="line">   ntheta_helmholtz,nr_helmholtz,a,h_thick_helmholtz,phi);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set error estimators</span></div>
<div class="line"> Solid_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"> Helmholtz_mesh_pt-&gt;spatial_error_estimator_pt()=<span class="keyword">new</span> Z2ErrorEstimator;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Mesh containing the Helmholtz ABC</span></div>
<div class="line"> <span class="comment">// elements. </span></div>
<div class="line"> Helmholtz_outer_boundary_mesh_pt = <span class="keyword">new</span> Mesh;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create elasticity tensors</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>.resize(2);</div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[0]=<span class="keyword">new</span> TimeHarmonicIsotropicElasticityTensor(</div>
<div class="line">    <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>);</div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[1]=<span class="keyword">new</span> TimeHarmonicIsotropicElasticityTensor(</div>
<div class="line">  <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Complete build of solid elements</span></div>
<div class="line"> complete_problem_setup();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Same for Helmholtz mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element =Helmholtz_mesh_pt-&gt;nelement();</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_element;i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//Cast to a solid element</span></div>
<div class="line">   HELMHOLTZ_ELEMENT *el_pt = </div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(Helmholtz_mesh_pt-&gt;element_pt(i));</div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Set the pointer to square of Helmholtz wavenumber</span></div>
<div class="line">   el_pt-&gt;k_squared_pt() = &amp;<a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output meshes and their boundaries so far so we can double </span></div>
<div class="line"> <span class="comment">// check the boundary enumeration</span></div>
<div class="line"> Solid_mesh_pt-&gt;output(<span class="stringliteral">&quot;solid_mesh.dat&quot;</span>);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;output(<span class="stringliteral">&quot;helmholtz_mesh.dat&quot;</span>);</div>
<div class="line"> Solid_mesh_pt-&gt;output_boundaries(<span class="stringliteral">&quot;solid_mesh_boundary.dat&quot;</span>);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;output_boundaries(<span class="stringliteral">&quot;helmholtz_mesh_boundary.dat&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create FaceElement meshes for boundary conditions</span></div>
<div class="line"> <span class="comment">//---------------------------------------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the solid traction element mesh</span></div>
<div class="line"> Solid_traction_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_solid_traction_elements(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the fsi traction element mesh</span></div>
<div class="line"> FSI_traction_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_fsi_traction_elements(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the Helmholtz fsi flux element mesh</span></div>
<div class="line"> Helmholtz_fsi_flux_mesh_pt=<span class="keyword">new</span> Mesh;</div>
<div class="line"> create_helmholtz_fsi_flux_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create ABC elements on outer boundary of Helmholtz mesh</span></div>
<div class="line"> create_helmholtz_ABC_elements();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Combine sub meshes</span></div>
<div class="line"> <span class="comment">//-------------------</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid mesh is first sub-mesh</span></div>
<div class="line"> add_sub_mesh(Solid_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add solid traction sub-mesh</span></div>
<div class="line"> add_sub_mesh(Solid_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add FSI traction sub-mesh</span></div>
<div class="line"> add_sub_mesh(FSI_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add Helmholtz mesh</span></div>
<div class="line"> add_sub_mesh(Helmholtz_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add Helmholtz FSI flux mesh</span></div>
<div class="line"> add_sub_mesh(Helmholtz_fsi_flux_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Add Helmholtz ABC mesh</span></div>
<div class="line"> add_sub_mesh(Helmholtz_outer_boundary_mesh_pt); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Build combined &quot;global&quot; mesh</span></div>
<div class="line"> build_global_mesh();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup fluid-structure interaction</span></div>
<div class="line"> <span class="comment">//----------------------------------</span></div>
<div class="line"> setup_interaction();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Assign equation  numbers</span></div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Number of unknowns: &quot;</span> &lt;&lt; assign_eqn_numbers() &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set output directory</span></div>
<div class="line"> Doc_info.set_directory(<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Open trace file</span></div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/trace.dat&quot;</span>,Doc_info.directory().c_str());</div>
<div class="line"> Trace_file.open(filename);</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end of constructor</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_before_adapt======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Actions before adapt: Wipe the meshes face elements</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a89e972df172b024b1358f0fac7646d6d">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a89e972df172b024b1358f0fac7646d6d">actions_before_adapt</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Kill the solid traction elements and wipe surface mesh</span></div>
<div class="line"> delete_face_elements(Solid_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Kill the fsi traction elements and wipe surface mesh</span></div>
<div class="line"> delete_face_elements(FSI_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Kill Helmholtz FSI flux elements</span></div>
<div class="line"> delete_face_elements(Helmholtz_fsi_flux_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Kill Helmholtz BC elements </span></div>
<div class="line"> delete_face_elements(Helmholtz_outer_boundary_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> rebuild_global_mesh();</div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end of actions_before_adapt</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_actions_after_adapt=======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">///  Actions after adapt: Rebuild the meshes of face elements</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a93f9d34cd24f08ca1ec726ae0057b939">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a93f9d34cd24f08ca1ec726ae0057b939">actions_after_adapt</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Complete problem setup</span></div>
<div class="line"> complete_problem_setup(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Construct the solid traction elements</span></div>
<div class="line"> create_solid_traction_elements(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create fsi traction elements from all elements that are </span></div>
<div class="line"> <span class="comment">// adjacent to FSI boundaries and add them to surface meshes</span></div>
<div class="line"> create_fsi_traction_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create Helmholtz fsi flux elements</span></div>
<div class="line"> create_helmholtz_fsi_flux_elements();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Create ABC elements from all elements that are </span></div>
<div class="line"> <span class="comment">// adjacent to the outer boundary of Helmholtz mesh</span></div>
<div class="line"> create_helmholtz_ABC_elements();</div>
<div class="line">   </div>
<div class="line"> <span class="comment">// Setup interaction</span></div>
<div class="line"> setup_interaction();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Rebuild the Problem&#39;s global mesh from its various sub-meshes</span></div>
<div class="line"> rebuild_global_mesh();</div>
<div class="line"> </div>
<div class="line">}<span class="comment">// end of actions_after_adapt</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_complete_problem_setup=======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Complete problem setup: Apply boundary conditions and set</span></div>
<div class="line"><span class="comment">/// physical properties</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a4d63252d3916bda71f28b637d6590627">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a4d63252d3916bda71f28b637d6590627">complete_problem_setup</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Solid boundary conditions:</span></div>
<div class="line"> <span class="comment">//---------------------------</span></div>
<div class="line"> <span class="comment">// Pin real and imag part of horizontal displacement components </span></div>
<div class="line"> <span class="comment">//-------------------------------------------------------------</span></div>
<div class="line"> <span class="comment">// on vertical boundaries</span></div>
<div class="line"> <span class="comment">//-----------------------</span></div>
<div class="line"> {  </div>
<div class="line">  <span class="comment">//Loop over the nodes to pin and assign boundary displacements on </span></div>
<div class="line">  <span class="comment">//solid boundary</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(Upper_symmetry_boundary_id);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node;i++)</div>
<div class="line">   {</div>
<div class="line">    Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(Upper_symmetry_boundary_id,i);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Real part of x-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(0);</div>
<div class="line">    nod_pt-&gt;set_value(0,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of x-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(2);</div>
<div class="line">    nod_pt-&gt;set_value(2,0.0);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> {</div>
<div class="line">  <span class="comment">//Loop over the nodes to pin and assign boundary displacements on </span></div>
<div class="line">  <span class="comment">//solid boundary</span></div>
<div class="line">  <span class="keywordtype">unsigned</span> n_node = Solid_mesh_pt-&gt;nboundary_node(Lower_symmetry_boundary_id);</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;n_node;i++)</div>
<div class="line">   {</div>
<div class="line">    Node* nod_pt=Solid_mesh_pt-&gt;boundary_node_pt(Lower_symmetry_boundary_id,i);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Real part of x-displacement </span></div>
<div class="line">    nod_pt-&gt;pin(0);</div>
<div class="line">    nod_pt-&gt;set_value(0,0.0);</div>
<div class="line">    </div>
<div class="line">    <span class="comment">// Imag part of x-displacement</span></div>
<div class="line">    nod_pt-&gt;pin(2);</div>
<div class="line">    nod_pt-&gt;set_value(2,0.0);</div>
<div class="line">   }</div>
<div class="line"> }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Assign the physical properties to the elements</span></div>
<div class="line"> <span class="comment">//----------------------------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nreg=Solid_mesh_pt-&gt;nregion();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> r=0;r&lt;nreg;r++)</div>
<div class="line">  {</div>
<div class="line">   <span class="keywordtype">unsigned</span> nel=Solid_mesh_pt-&gt;nregion_element(r);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">    {     </div>
<div class="line">     <span class="comment">//Cast to a solid element</span></div>
<div class="line">     ELASTICITY_ELEMENT *el_pt = </div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(Solid_mesh_pt-&gt;</div>
<div class="line">                                        region_element_pt(r,e));</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Set the constitutive law</span></div>
<div class="line">     el_pt-&gt;elasticity_tensor_pt() = <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[r];</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Square of non-dim frequency</span></div>
<div class="line">     el_pt-&gt;omega_sq_pt()= &amp;<a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[r];</div>
<div class="line">    }</div>
<div class="line">  }    </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_delete_face_elements================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Delete face elements and wipe the mesh</span></div>
<div class="line"><span class="comment"></span><span class="comment">//==========================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a55b4cead41e01ab5fd728b607f62bb74">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a55b4cead41e01ab5fd728b607f62bb74">delete_face_elements</a>(Mesh* <span class="keyword">const</span> &amp; boundary_mesh_pt)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// How many surface elements are in the surface mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = boundary_mesh_pt-&gt;nelement();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the surface elements</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">//   Kill surface element</span></div>
<div class="line">   <span class="keyword">delete</span> boundary_mesh_pt-&gt;element_pt(e);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Wipe the mesh</span></div>
<div class="line"> boundary_mesh_pt-&gt;flush_element_and_node_storage();</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of delete_face_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_solid_traction_elements====================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create solid traction elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a31c3707de78a720e3936e3b34e70b1ba">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a31c3707de78a720e3936e3b34e70b1ba">create_solid_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Loop over pressure loaded boundaries</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=0;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nb=3;</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nb;i++) </div>
<div class="line">  {</div>
<div class="line">   <span class="keywordflow">switch</span>(i)</div>
<div class="line">    {</div>
<div class="line">    <span class="keywordflow">case</span> 0:</div>
<div class="line">     b=Upper_inner_boundary_id;</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">     </div>
<div class="line">    <span class="keywordflow">case</span> 1:</div>
<div class="line">     b=Lower_inner_boundary_id;</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">     </div>
<div class="line">    <span class="keywordflow">case</span> 2:</div>
<div class="line">     b=Rib_divider_boundary_id;</div>
<div class="line">     <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// We&#39;re attaching face elements to region 0</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> r=0;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line">   <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element_in_region(b,r);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line">   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">    {</div>
<div class="line">     <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">     ELASTICITY_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">      Solid_mesh_pt-&gt;boundary_element_in_region_pt(b,r,e));</div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">     <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary_in_region(b,r,e);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Create element</span></div>
<div class="line">     TimeHarmonicLinearElasticityTractionElement&lt;ELASTICITY_ELEMENT&gt;* el_pt=</div>
<div class="line">      <span class="keyword">new</span> TimeHarmonicLinearElasticityTractionElement&lt;ELASTICITY_ELEMENT&gt;</div>
<div class="line">      (bulk_elem_pt,face_index);   </div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Add to mesh</span></div>
<div class="line">     Solid_traction_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">     </div>
<div class="line">     <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">     <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">     el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">     </div>
<div class="line">     <span class="comment">//Set the traction function</span></div>
<div class="line">     el_pt-&gt;traction_fct_pt() = <a class="code" href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">Global_Parameters::pressure_load</a>;  </div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// end of create_traction_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_fsi_traction_elements======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create fsi traction elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a143908e8db74ad6bd8b7efaaa26c78c3">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a143908e8db74ad6bd8b7efaaa26c78c3">create_fsi_traction_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// We&#39;re on the outer boundary of the solid mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=Outer_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Solid_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   ELASTICITY_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>ELASTICITY_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Solid_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Solid_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Create element</span></div>
<div class="line">   TimeHarmonicLinElastLoadedByHelmholtzPressureBCElement</div>
<div class="line">    &lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;* el_pt=</div>
<div class="line">    <span class="keyword">new</span> TimeHarmonicLinElastLoadedByHelmholtzPressureBCElement</div>
<div class="line">    &lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;(bulk_elem_pt,</div>
<div class="line">                                           face_index);   </div>
<div class="line">   <span class="comment">// Add to mesh</span></div>
<div class="line">   FSI_traction_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">   <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">   el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set FSI parameter</span></div>
<div class="line">   el_pt-&gt;q_pt()=&amp;<a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a>;          </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of create_traction_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_helmholtz_fsi_flux_elements================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create Helmholtz fsi flux elements </span></div>
<div class="line"><span class="comment"></span><span class="comment">//=======================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#a34f61c03b152f2ac06e1e771b0dbe09b">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#a34f61c03b152f2ac06e1e771b0dbe09b">create_helmholtz_fsi_flux_elements</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Attach to inner boundary of Helmholtz mesh (0)</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Helmholtz_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   HELMHOLTZ_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Helmholtz_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b</span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Helmholtz_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Create element</span></div>
<div class="line">   HelmholtzFluxFromNormalDisplacementBCElement</div>
<div class="line">    &lt;HELMHOLTZ_ELEMENT,ELASTICITY_ELEMENT&gt;* el_pt=</div>
<div class="line">    <span class="keyword">new</span> HelmholtzFluxFromNormalDisplacementBCElement</div>
<div class="line">    &lt;HELMHOLTZ_ELEMENT,ELASTICITY_ELEMENT&gt;(bulk_elem_pt,</div>
<div class="line">                                           face_index);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Add to mesh</span></div>
<div class="line">   Helmholtz_fsi_flux_mesh_pt-&gt;add_element_pt(el_pt);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Associate element with bulk boundary (to allow it to access</span></div>
<div class="line">   <span class="comment">// the boundary coordinates in the bulk mesh)</span></div>
<div class="line">   el_pt-&gt;set_boundary_number_in_bulk_mesh(b); </div>
<div class="line">  }  </div>
<div class="line">  </div>
<div class="line">} <span class="comment">// end of create_helmholtz_flux_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//============start_of_create_ABC_elements==============================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Create ABC elements on the outer boundary of </span></div>
<div class="line"><span class="comment">/// the Helmholtz mesh</span></div>
<div class="line"><span class="comment"></span><span class="comment">//===========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#ade4e1e8fd2e8b0f7592f26514f3d18cc">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#ade4e1e8fd2e8b0f7592f26514f3d18cc">create_helmholtz_ABC_elements</a>()</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// We&#39;re on boundary 2 of the Helmholtz mesh</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> b=2;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// How many bulk elements are adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_element = Helmholtz_mesh_pt-&gt;nboundary_element(b);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Loop over the bulk elements adjacent to boundary b?</span></div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;n_element;e++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Get pointer to the bulk element that is adjacent to boundary b</span></div>
<div class="line">   HELMHOLTZ_ELEMENT* bulk_elem_pt = <span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">    Helmholtz_mesh_pt-&gt;boundary_element_pt(b,e));</div>
<div class="line">   </div>
<div class="line">   <span class="comment">//Find the index of the face of element e along boundary b </span></div>
<div class="line">   <span class="keywordtype">int</span> face_index = Helmholtz_mesh_pt-&gt;face_index_at_boundary(b,e);</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Build the corresponding ABC element</span></div>
<div class="line">   HelmholtzAbsorbingBCElement&lt;HELMHOLTZ_ELEMENT&gt;* flux_element_pt = <span class="keyword">new</span> </div>
<div class="line">    HelmholtzAbsorbingBCElement&lt;HELMHOLTZ_ELEMENT&gt;(bulk_elem_pt,face_index);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Set pointer to outer radius of artificial boundary</span></div>
<div class="line">   flux_element_pt-&gt;outer_radius_pt()=&amp;<a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a>;</div>
<div class="line">   </div>
<div class="line">   <span class="comment">// Set order of absorbing boundary condition</span></div>
<div class="line">   flux_element_pt-&gt;abc_order_pt()=&amp;<a class="code" href="namespaceGlobal__Parameters.html#ae16eb10039cab2098b02ec7dff946277">Global_Parameters::ABC_order</a>;   </div>
<div class="line"> </div>
<div class="line">   <span class="comment">//Add the flux boundary element to the  helmholtz_outer_boundary_mesh</span></div>
<div class="line">   Helmholtz_outer_boundary_mesh_pt-&gt;add_element_pt(flux_element_pt);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// end of create_helmholtz_ABC_elements</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=====================start_of_setup_interaction======================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Setup interaction between two fields</span></div>
<div class="line"><span class="comment"></span><span class="comment">//========================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#ad24d43389155a6a9f2f66faf4b239c26">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::</a></div>
<div class="line"><a class="code" href="classCoatedDiskProblem.html#ad24d43389155a6a9f2f66faf4b239c26">setup_interaction</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup Helmholtz &quot;pressure&quot; load on traction elements</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_in_helmholtz_mesh=0;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc boundary coordinate for Helmholtz</span></div>
<div class="line"> ofstream the_file;</div>
<div class="line"> the_file.open(<span class="stringliteral">&quot;boundary_coordinate_hh.dat&quot;</span>);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;Mesh::doc_boundary_coordinates&lt;HELMHOLTZ_ELEMENT&gt;</div>
<div class="line">  (boundary_in_helmholtz_mesh, the_file);</div>
<div class="line"> the_file.close();</div>
<div class="line"> </div>
<div class="line">  Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</div>
<div class="line">  &lt;HELMHOLTZ_ELEMENT,2&gt;</div>
<div class="line">  (<span class="keyword">this</span>,boundary_in_helmholtz_mesh,Helmholtz_mesh_pt,FSI_traction_mesh_pt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Setup Helmholtz flux from normal displacement interaction</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> boundary_in_solid_mesh=Outer_boundary_id;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc boundary coordinate for solid mesh</span></div>
<div class="line"> the_file.open(<span class="stringliteral">&quot;boundary_coordinate_solid.dat&quot;</span>);</div>
<div class="line"> Solid_mesh_pt-&gt;Mesh::template doc_boundary_coordinates&lt;ELASTICITY_ELEMENT&gt;</div>
<div class="line">  (boundary_in_solid_mesh, the_file);</div>
<div class="line"> the_file.close();</div>
<div class="line"> </div>
<div class="line"> Multi_domain_functions::setup_bulk_elements_adjacent_to_face_mesh</div>
<div class="line">  &lt;ELASTICITY_ELEMENT,2&gt;(</div>
<div class="line">   <span class="keyword">this</span>,boundary_in_solid_mesh,Solid_mesh_pt,Helmholtz_fsi_flux_mesh_pt);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//==============start_doc===========================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Doc the solution</span></div>
<div class="line"><span class="comment"></span><span class="comment">//==================================================================</span></div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">class</span> ELASTICITY_ELEMENT, <span class="keyword">class</span> HELMHOLTZ_ELEMENT&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classCoatedDiskProblem.html#af8e103d494f526c0e24c0c4ccef4ea6b">CoatedDiskProblem&lt;ELASTICITY_ELEMENT,HELMHOLTZ_ELEMENT&gt;::doc_solution</a>()</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> ofstream some_file,some_file2;</div>
<div class="line"> <span class="keywordtype">char</span> filename[100];</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Number of plot points</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> n_plot=5; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Compute/output the radiated power</span></div>
<div class="line"> <span class="comment">//----------------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/power%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Accumulate contribution from elements</span></div>
<div class="line"> <span class="keywordtype">double</span> power=0.0;</div>
<div class="line"> <span class="keywordtype">unsigned</span> nn_element=Helmholtz_outer_boundary_mesh_pt-&gt;nelement(); </div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> e=0;e&lt;nn_element;e++)</div>
<div class="line">  {</div>
<div class="line">   HelmholtzBCElementBase&lt;HELMHOLTZ_ELEMENT&gt; *el_pt = </div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span>HelmholtzBCElementBase&lt;HELMHOLTZ_ELEMENT&gt;*<span class="keyword">&gt;</span>(</div>
<div class="line">     Helmholtz_outer_boundary_mesh_pt-&gt;element_pt(e)); </div>
<div class="line">   power += el_pt-&gt;global_power_contribution(some_file);</div>
<div class="line">  }</div>
<div class="line"> some_file.close();</div>
<div class="line"> oomph_info &lt;&lt; <span class="stringliteral">&quot;Step: &quot;</span> &lt;&lt; Doc_info.number() </div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;: Q=&quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a>  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; k_squared=&quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a>  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; density ratio (annulus) =&quot;</span> </div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[0]  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; density ratio (rib)     =&quot;</span> </div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; omega_sq (annulus)=&quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[0]  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; omega_sq (rib    )=&quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[1]  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; Total radiated power &quot;</span> &lt;&lt; power  &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span></div>
<div class="line">            &lt;&lt; std::endl; </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Write trace file</span></div>
<div class="line"> Trace_file &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; power &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">  </div>
<div class="line"> std::ostringstream case_string;</div>
<div class="line"> case_string &lt;&lt; <span class="stringliteral">&quot;TEXT X=10,Y=90, T=\&quot;Q=&quot;</span> </div>
<div class="line">             &lt;&lt;  <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a> </div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;,  k&lt;sup&gt;2&lt;/sup&gt; = &quot;</span></div>
<div class="line">             &lt;&lt;  <a class="code" href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a></div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;,  density ratio = &quot;</span></div>
<div class="line">             &lt;&lt;  <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[0] &lt;&lt; <span class="stringliteral">&quot; and &quot;</span></div>
<div class="line">             &lt;&lt;  <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1] </div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;,  omega_sq = &quot;</span></div>
<div class="line">             &lt;&lt;  <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[0] &lt;&lt; <span class="stringliteral">&quot; and &quot;</span> </div>
<div class="line">             &lt;&lt;  <a class="code" href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a>[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> </div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;\&quot;\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output displacement field</span></div>
<div class="line"> <span class="comment">//--------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/elast_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output solid traction elements</span></div>
<div class="line"> <span class="comment">//--------------------------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/solid_traction_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Solid_traction_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output fsi traction elements</span></div>
<div class="line"> <span class="comment">//----------------------------- </span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/traction_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> FSI_traction_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output Helmholtz fsi flux elements</span></div>
<div class="line"> <span class="comment">//----------------------------------- </span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/flux_bc_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Helmholtz_fsi_flux_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output Helmholtz</span></div>
<div class="line"> <span class="comment">//-----------------</span></div>
<div class="line"> sprintf(filename,<span class="stringliteral">&quot;%s/helmholtz_soln%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">         Doc_info.number());</div>
<div class="line"> some_file.open(filename);</div>
<div class="line"> Helmholtz_mesh_pt-&gt;output(some_file,n_plot);</div>
<div class="line"> some_file &lt;&lt; case_string.str();</div>
<div class="line"> some_file.close();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output regions of solid mesh</span></div>
<div class="line"> <span class="comment">//-----------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nreg=Solid_mesh_pt-&gt;nregion();</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> r=0;r&lt;nreg;r++)</div>
<div class="line">  {</div>
<div class="line">   sprintf(filename,<span class="stringliteral">&quot;%s/region%i_%i.dat&quot;</span>,Doc_info.directory().c_str(),</div>
<div class="line">           r,Doc_info.number());   </div>
<div class="line">   some_file.open(filename);   </div>
<div class="line">   <span class="keywordtype">unsigned</span> nel=Solid_mesh_pt-&gt;nregion_element(r);</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nel;e++)</div>
<div class="line">    {     </div>
<div class="line">     FiniteElement* el_pt=Solid_mesh_pt-&gt;region_element_pt(r,e);</div>
<div class="line">     el_pt-&gt;output(some_file,n_plot);</div>
<div class="line">    }</div>
<div class="line">   some_file.close();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Do animation of Helmholtz solution</span></div>
<div class="line"> <span class="comment">//-----------------------------------</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nstep=40;</div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0;i&lt;nstep;i++)</div>
<div class="line">  {</div>
<div class="line">   sprintf(filename,<span class="stringliteral">&quot;%s/helmholtz_animation%i_frame%i.dat&quot;</span>,</div>
<div class="line">           Doc_info.directory().c_str(),</div>
<div class="line">           Doc_info.number(),i);</div>
<div class="line">   some_file.open(filename);</div>
<div class="line">   <span class="keywordtype">double</span> phi=2.0*MathematicalConstants::Pi*double(i)/double(nstep-1);</div>
<div class="line">   <span class="keywordtype">unsigned</span> nelem=Helmholtz_mesh_pt-&gt;nelement();</div>
<div class="line">   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> e=0;e&lt;nelem;e++)</div>
<div class="line">    {</div>
<div class="line">     HELMHOLTZ_ELEMENT* el_pt=<span class="keyword">dynamic_cast&lt;</span>HELMHOLTZ_ELEMENT*<span class="keyword">&gt;</span>(</div>
<div class="line">      Helmholtz_mesh_pt-&gt;element_pt(e));</div>
<div class="line">     el_pt-&gt;output_real(some_file,phi,n_plot);    </div>
<div class="line">    }</div>
<div class="line">   some_file.close();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> cout &lt;&lt; <span class="stringliteral">&quot;Doced for Q=&quot;</span> &lt;&lt; <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a> &lt;&lt; <span class="stringliteral">&quot; (step &quot;</span></div>
<div class="line">      &lt;&lt; Doc_info.number() &lt;&lt; <span class="stringliteral">&quot;)\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Increment label for output files</span></div>
<div class="line"> Doc_info.number()++;</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end doc</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="comment">//=======start_of_main==================================================</span><span class="comment"></span></div>
<div class="line"><span class="comment">/// Driver for acoustic fsi problem</span></div>
<div class="line"><span class="comment"></span><span class="comment">//======================================================================</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="acoustic__fsi_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Store command line arguments</span></div>
<div class="line"> CommandLineArgs::setup(argc,argv);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Define possible command line arguments and parse the ones that</span></div>
<div class="line"> <span class="comment">// were actually specified</span></div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Output directory</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--dir&quot;</span>,</div>
<div class="line">                                            &amp;<a class="code" href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Peakiness parameter for loading</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--alpha&quot;</span>,</div>
<div class="line">                                            &amp;<a class="code" href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Global_Parameters::Alpha</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Multiplier for number of elements in solid mesh</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--el_multiplier&quot;</span>,</div>
<div class="line">                            &amp;<a class="code" href="namespaceGlobal__Parameters.html#a35d5d2ecfff0cec6150a5dc79e5c1ad1">Global_Parameters::El_multiplier</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Outer radius of Helmholtz domain</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--outer_radius&quot;</span>,</div>
<div class="line">                            &amp;<a class="code" href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a>);</div>
<div class="line">  </div>
<div class="line"> <span class="comment">// Validaton run?</span></div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--validation&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Max. number of adaptations</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> max_adapt=3;</div>
<div class="line"> CommandLineArgs::specify_command_line_flag(<span class="stringliteral">&quot;--max_adapt&quot;</span>,&amp;max_adapt);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Parse command line</span></div>
<div class="line"> CommandLineArgs::parse_and_assign(); </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Doc what has actually been specified on the command line</span></div>
<div class="line"> CommandLineArgs::doc_specified_flags();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Set up the problem</span></div>
<div class="line"> <a class="code" href="classCoatedDiskProblem.html">CoatedDiskProblem</a>&lt;ProjectableTimeHarmonicLinearElasticityElement</div>
<div class="line">                   &lt;TTimeHarmonicLinearElasticityElement&lt;2,3&gt; &gt;,</div>
<div class="line">                   RefineableQHelmholtzElement&lt;2,3&gt; &gt; problem; </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> <span class="comment">// Set values for parameter values</span></div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a>=5.0; </div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[0]=0.1; </div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]=0.1; </div>
<div class="line"> <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//Parameter study</span></div>
<div class="line"> <span class="keywordtype">unsigned</span> nstep=3; </div>
<div class="line"> <span class="keywordflow">if</span> (CommandLineArgs::command_line_flag_has_been_set(<span class="stringliteral">&quot;--validation&quot;</span>))</div>
<div class="line">  {</div>
<div class="line">   nstep=1;</div>
<div class="line">   max_adapt=2;</div>
<div class="line">  }</div>
<div class="line"> <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0;i&lt;nstep;i++)</div>
<div class="line">  {</div>
<div class="line">   <span class="comment">// Solve the problem with Newton&#39;s method, allowing</span></div>
<div class="line">   <span class="comment">// up to max_adapt mesh adaptations after every solve.</span></div>
<div class="line">   problem.newton_solve(max_adapt);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Doc solution</span></div>
<div class="line">   problem.doc_solution();</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Make rib a lot heavier but keep its stiffness</span></div>
<div class="line">   <span class="keywordflow">if</span> (i==0)</div>
<div class="line">    {</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[1]-&gt;update_constitutive_parameters(</div>
<div class="line">      <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>,1.0);</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]=10.0; </div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Make rib very soft and inertia-less</span></div>
<div class="line">   <span class="keywordflow">if</span> (i==1)</div>
<div class="line">    {</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a>[1]-&gt;update_constitutive_parameters(</div>
<div class="line">      <a class="code" href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a>,1.0e-16);</div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a>[1]=0.0; </div>
<div class="line">     <a class="code" href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a>();</div>
<div class="line">    }</div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">//end of main</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="ttc" id="aacoustic__fsi_8cc_html_a3c04138a5bfe5d72780bb7e82a18e627"><div class="ttname"><a href="acoustic__fsi_8cc.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a></div><div class="ttdeci">int main(int argc, char **argv)</div><div class="ttdoc">Driver for acoustic fsi problem.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00845">acoustic_fsi.cc:845</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html"><div class="ttname"><a href="classCoatedDiskProblem.html">CoatedDiskProblem</a></div><div class="ttdoc">Coated disk FSI.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00235">acoustic_fsi.cc:236</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a143908e8db74ad6bd8b7efaaa26c78c3"><div class="ttname"><a href="classCoatedDiskProblem.html#a143908e8db74ad6bd8b7efaaa26c78c3">CoatedDiskProblem::create_fsi_traction_elements</a></div><div class="ttdeci">void create_fsi_traction_elements()</div><div class="ttdoc">Create FSI traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00574">acoustic_fsi.cc:575</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a31c3707de78a720e3936e3b34e70b1ba"><div class="ttname"><a href="classCoatedDiskProblem.html#a31c3707de78a720e3936e3b34e70b1ba">CoatedDiskProblem::create_solid_traction_elements</a></div><div class="ttdeci">void create_solid_traction_elements()</div><div class="ttdoc">Create solid traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00866">unstructured_acoustic_fsi.cc:867</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a34f61c03b152f2ac06e1e771b0dbe09b"><div class="ttname"><a href="classCoatedDiskProblem.html#a34f61c03b152f2ac06e1e771b0dbe09b">CoatedDiskProblem::create_helmholtz_fsi_flux_elements</a></div><div class="ttdeci">void create_helmholtz_fsi_flux_elements()</div><div class="ttdoc">Create Helmholtz FSI flux elements.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00620">acoustic_fsi.cc:621</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a4d63252d3916bda71f28b637d6590627"><div class="ttname"><a href="classCoatedDiskProblem.html#a4d63252d3916bda71f28b637d6590627">CoatedDiskProblem::complete_problem_setup</a></div><div class="ttdeci">void complete_problem_setup()</div><div class="ttdoc">Complete problem setup: Apply boundary conditions and set physical properties.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00769">unstructured_acoustic_fsi.cc:770</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a55b4cead41e01ab5fd728b607f62bb74"><div class="ttname"><a href="classCoatedDiskProblem.html#a55b4cead41e01ab5fd728b607f62bb74">CoatedDiskProblem::delete_face_elements</a></div><div class="ttdeci">void delete_face_elements(Mesh *const &amp;boundary_mesh_pt)</div><div class="ttdoc">Delete (face) elements in specified mesh.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00550">acoustic_fsi.cc:551</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a89e972df172b024b1358f0fac7646d6d"><div class="ttname"><a href="classCoatedDiskProblem.html#a89e972df172b024b1358f0fac7646d6d">CoatedDiskProblem::actions_before_adapt</a></div><div class="ttdeci">void actions_before_adapt()</div><div class="ttdoc">Actions before adapt: Wipe the mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00500">acoustic_fsi.cc:501</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a93f9d34cd24f08ca1ec726ae0057b939"><div class="ttname"><a href="classCoatedDiskProblem.html#a93f9d34cd24f08ca1ec726ae0057b939">CoatedDiskProblem::actions_after_adapt</a></div><div class="ttdeci">void actions_after_adapt()</div><div class="ttdoc">Actions after adapt: Rebuild the mesh of traction elements.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00523">acoustic_fsi.cc:524</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_a9585ca5b422c72dc2b91cbb3e311b736"><div class="ttname"><a href="classCoatedDiskProblem.html#a9585ca5b422c72dc2b91cbb3e311b736">CoatedDiskProblem::CoatedDiskProblem</a></div><div class="ttdeci">CoatedDiskProblem()</div><div class="ttdoc">Constructor:</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00309">acoustic_fsi.cc:309</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_ad24d43389155a6a9f2f66faf4b239c26"><div class="ttname"><a href="classCoatedDiskProblem.html#ad24d43389155a6a9f2f66faf4b239c26">CoatedDiskProblem::setup_interaction</a></div><div class="ttdeci">void setup_interaction()</div><div class="ttdoc">Setup interaction.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00705">acoustic_fsi.cc:706</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_ade4e1e8fd2e8b0f7592f26514f3d18cc"><div class="ttname"><a href="classCoatedDiskProblem.html#ade4e1e8fd2e8b0f7592f26514f3d18cc">CoatedDiskProblem::create_helmholtz_ABC_elements</a></div><div class="ttdeci">void create_helmholtz_ABC_elements()</div><div class="ttdoc">Create ABC face elements.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l01020">unstructured_acoustic_fsi.cc:1021</a></div></div>
<div class="ttc" id="aclassCoatedDiskProblem_html_af8e103d494f526c0e24c0c4ccef4ea6b"><div class="ttname"><a href="classCoatedDiskProblem.html#af8e103d494f526c0e24c0c4ccef4ea6b">CoatedDiskProblem::doc_solution</a></div><div class="ttdeci">void doc_solution()</div><div class="ttdoc">Doc the solution.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00727">acoustic_fsi.cc:727</a></div></div>
<div class="ttc" id="aclassMyStraightLine_html"><div class="ttname"><a href="classMyStraightLine.html">MyStraightLine</a></div><div class="ttdoc">////////////////////////////////////////////////////////////////////</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00052">unstructured_acoustic_fsi.cc:53</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html"><div class="ttname"><a href="namespaceGlobal__Parameters.html">Global_Parameters</a></div><div class="ttdoc">/////////////////////////////////////////////////////////////////// /////////////////////////////////...</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00048">acoustic_fsi.cc:49</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a0ddb3a77481b907fbb34f2e8d0a6eb9f"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a0ddb3a77481b907fbb34f2e8d0a6eb9f">Global_Parameters::pressure_load</a></div><div class="ttdeci">void pressure_load(const Vector&lt; double &gt; &amp;x, const Vector&lt; double &gt; &amp;n, Vector&lt; std::complex&lt; double &gt; &gt; &amp;traction)</div><div class="ttdoc">Pressure load (real and imag part)</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00151">unstructured_acoustic_fsi.cc:151</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a20fccdcfa2c15ad8b951b9ada3bb1661"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a20fccdcfa2c15ad8b951b9ada3bb1661">Global_Parameters::Nu</a></div><div class="ttdeci">double Nu</div><div class="ttdoc">Poisson's ratio.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00064">acoustic_fsi.cc:64</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a301ab922df72030c660b21328d6caf76"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a301ab922df72030c660b21328d6caf76">Global_Parameters::Directory</a></div><div class="ttdeci">string Directory</div><div class="ttdoc">Output directory.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00101">acoustic_fsi.cc:101</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a31fb55c20db4aa0127aafa20f0d76731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a31fb55c20db4aa0127aafa20f0d76731">Global_Parameters::P</a></div><div class="ttdeci">double P</div><div class="ttdoc">Uniform pressure.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00145">unstructured_acoustic_fsi.cc:145</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a35d5d2ecfff0cec6150a5dc79e5c1ad1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a35d5d2ecfff0cec6150a5dc79e5c1ad1">Global_Parameters::El_multiplier</a></div><div class="ttdeci">unsigned El_multiplier</div><div class="ttdoc">Multiplier for number of elements.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00104">acoustic_fsi.cc:104</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a517d4c31b8bce6563c2f605266dd9679"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a517d4c31b8bce6563c2f605266dd9679">Global_Parameters::Density_ratio</a></div><div class="ttdeci">double Density_ratio</div><div class="ttdoc">Density ratio: solid to fluid.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00070">acoustic_fsi.cc:70</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a73c731fa617a9d92851e4195493262e7"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a73c731fa617a9d92851e4195493262e7">Global_Parameters::E_pt</a></div><div class="ttdeci">Vector&lt; TimeHarmonicIsotropicElasticityTensor * &gt; E_pt</div><div class="ttdoc">The elasticity tensors for the two regions.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00135">unstructured_acoustic_fsi.cc:135</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a7814fddf663e56168174a42d2cd6b4c1"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a7814fddf663e56168174a42d2cd6b4c1">Global_Parameters::Q</a></div><div class="ttdeci">double Q</div><div class="ttdoc">FSI parameter.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00058">acoustic_fsi.cc:58</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a88ded445ecd7bd89701409e68fd0b900"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a88ded445ecd7bd89701409e68fd0b900">Global_Parameters::Outer_radius</a></div><div class="ttdeci">double Outer_radius</div><div class="ttdoc">Radius of outer boundary of Helmholtz domain.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00055">acoustic_fsi.cc:55</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_a91a3fa265abaf9e724c668ee800ffb29"><div class="ttname"><a href="namespaceGlobal__Parameters.html#a91a3fa265abaf9e724c668ee800ffb29">Global_Parameters::K_squared</a></div><div class="ttdeci">double K_squared</div><div class="ttdoc">Square of wavenumber for the Helmholtz equation.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00052">acoustic_fsi.cc:52</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ae0f9a80fb7510dbfbbef22582da231b7"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ae0f9a80fb7510dbfbbef22582da231b7">Global_Parameters::update_parameter_values</a></div><div class="ttdeci">void update_parameter_values()</div><div class="ttdoc">Function to update dependent parameter values.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00076">acoustic_fsi.cc:76</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ae16eb10039cab2098b02ec7dff946277"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ae16eb10039cab2098b02ec7dff946277">Global_Parameters::ABC_order</a></div><div class="ttdeci">unsigned ABC_order</div><div class="ttdoc">Order of absorbing/appproximate boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00117">unstructured_acoustic_fsi.cc:117</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_ae3cf8878ede839bffda01f79bbe3e819"><div class="ttname"><a href="namespaceGlobal__Parameters.html#ae3cf8878ede839bffda01f79bbe3e819">Global_Parameters::H_coating</a></div><div class="ttdeci">double H_coating</div><div class="ttdoc">Non-dim thickness of elastic coating.</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00061">acoustic_fsi.cc:61</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_af9e1e178dfb7f5e35b452599bd4c4324"><div class="ttname"><a href="namespaceGlobal__Parameters.html#af9e1e178dfb7f5e35b452599bd4c4324">Global_Parameters::Omega_sq</a></div><div class="ttdeci">double Omega_sq</div><div class="ttdoc">Non-dim square of frequency for solid – dependent variable!</div><div class="ttdef"><b>Definition:</b> <a href="acoustic__fsi_8cc_source.html#l00073">acoustic_fsi.cc:73</a></div></div>
<div class="ttc" id="anamespaceGlobal__Parameters_html_afbe27ad463a1fb23cb99d029a9fac731"><div class="ttname"><a href="namespaceGlobal__Parameters.html#afbe27ad463a1fb23cb99d029a9fac731">Global_Parameters::Alpha</a></div><div class="ttdeci">double Alpha</div><div class="ttdoc">Peakiness parameter for pressure load.</div><div class="ttdef"><b>Definition:</b> <a href="unstructured__acoustic__fsi_8cc_source.html#l00148">unstructured_acoustic_fsi.cc:148</a></div></div>
</div><!-- fragment --><hr  />
 <hr  />
<h1><a class="anchor" id="sources"></a>
Source files for this tutorial</h1>
<ul>
<li>The source files for this tutorial are located in the directory:<br  />
<br  />
 <center> <a href="../../../../demo_drivers/interaction/acoustic_fsi">demo_drivers/interaction/acoustic_fsi/ </a> </center><br  />
</li>
<li>The driver code is: <br  />
<br  />
 <center> <a href="../../../../demo_drivers/interaction/acoustic_fsi/unstructured_acoustic_fsi.cc">demo_drivers/interaction/acoustic_fsi/unstructured_acoustic_fsi.cc </a> </center></li>
</ul>
<hr  />
 <hr  />
 <h1><a class="anchor" id="pdf"></a>
PDF file</h1>
<p>A <a href="../latex/refman.pdf">pdf version</a> of this document is available. </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Thu Dec 19 2024 11:42:21
        </div>
      </div>
    </footer>
</body>
</html>

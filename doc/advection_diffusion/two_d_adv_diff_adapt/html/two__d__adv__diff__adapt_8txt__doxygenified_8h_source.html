<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
<title>oomph-lib: two_d_adv_diff_adapt.txt_doxygenified.h Source File</title>
<link rel="apple-touch-icon" sizes="57x57" href="../../../figures/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="../../../figures/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="../../../figures/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="../../../figures/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="../../../figures/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="../../../figures/apple-touch-icon-120x120.png">
<link rel="icon" type="image/png" href="../../../figures/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="../../../figures/favicon-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="../../../figures/favicon-16x16.png" sizes="16x16">
<link rel="manifest" href="../../../figures/manifest.json">
<link rel="mask-icon" href="../../../figures/safari-pinned-tab.svg" color="#008000">
<link rel="shortcut icon" href="../../../figures/favicon.ico">
<meta name="msapplication-TileColor" content="#00a300">
<meta name="msapplication-config" content="../../../figures/browserconfig.xml">
<meta name="theme-color" content="#008000">
<link href="http://fonts.googleapis.com/css?family=Open+Sans:400,300,600" rel="stylesheet" type="text/css">
<!-- Doxygen css-->
<!-- <link rel="stylesheet" type="text/css" href="doxygen.css"> -->
<!-- Bootstrap -->
<link href="../../../css/bootstrap.css" rel="stylesheet">
<!-- oomph-lib specific overrides -->
<link rel="stylesheet" type="text/css" href="../../../css/oomph_header.css">
</head>
<body>
<nav class="navbar navbar-default">
<div class="container">
<div class="container-fluid">
  <!-- Brand and toggle get grouped for better mobile display -->
  <div class="navbar-header">
    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="../../../html/index.html"><img alt="oomph-lib" src="../../../figures/oomph_logo.png"></a>
  </div>
  <!-- Collect the nav links, forms, and other content for toggling -->
  <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
    <ul class="nav navbar-nav">          
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Documentation <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li class="dropdown-header">Big picture</li>
          <li><a href="../../../../doc/intro/html/index.html">The finite element method</a></li>
          <li><a href="../../../../doc/the_data_structure/html/index.html">The data structure</a></li>
          <li><a href="../../../../doc/quick_guide/html/index.html">Not-so-quick guide</a></li>
          <li><a href="../../../../doc/optimisation/html/index.html">Optimisation</a></li>
          <li><a href="../../../../doc/order_of_action_functions/html/index.html">Order of action functions</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Example codes and tutorials</li>
          <li><a href="../../../../doc/example_code_list/html/index.html">List of example codes and tutorials</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#meshes">Meshing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#solvers">Solvers</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#parallel">MPI parallel processing</a></li>
          <li><a href="../../../../doc/example_code_list/html/index.html#visualisation">Post-processing/visualisation</a></li>
          <li role="separator" class="divider"></li>
          <li class="dropdown-header">Other</li>
          <li><a href="../../../../doc/change_log/html/index.html">Change log</a></li>
          <li><a href="../../../../doc/creating_doc/html/index.html">Creating documentation</a></li>
          <li><a href="../../../../doc/coding_conventions/html/index.html">Coding conventions</a></li>
          <li><a href="../../../../doc/index/html/index.html">Index</a></li>
          <li><a href="../../../../doc/FAQ/html/index.html">FAQ</a></li>
        </ul>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Get it <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/the_distribution/html/index.html">Installation guide</a></li>
            <li><a href="../../../../doc/subversion/html/index.html">Get code from subversion repository</a></li>
            <li><a href="../../../../doc/download/html/index.html">Get code as tar file</a></li>
            <li><a href="../../../../doc/copyright/html/index.html">Copyright</a></li>
          </ul>
        </li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../../../../doc/people/html/index.html">People</a></li>            
            <li><a href="../../../../doc/contact/html/index.html">Contact/Get involved</a></li>
            <li><a href="../../../../doc/publications/html/index.html">Publications</a></li>
            <li><a href="../../../../doc/acknowledgements/html/index.html">Acknowledgements</a></li>
            <li><a href="../../../../doc/picture_show/index.html">Picture show</a></li>
          </ul>
        </li>
      </li>
    </ul>
    <ul class="nav navbar-nav navbar-right navbar-search">
      <form class="navbar-form" role="search" action="../../../../doc/search_results/html/index.html">
        <div class="input-group">
          <input type="text" class="form-control" placeholder="Search" name="q">
          <span class="input-group-btn">
            <button class="btn btn-default" type="submit">Go</button>
          </span>
        </div><!-- /input-group -->
       <!--<div class="form-group">
          <input type="text" class="form-control" placeholder="Search">
        </div>
        <button type="submit" class="btn btn-default">Submit</button>-->
      </form>
    </ul>
  </div><!-- /.navbar-collapse -->
</div><!-- /.container-fluid -->
</div>
</nav>
<!-- Generated by Doxygen 1.8.17 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">two_d_adv_diff_adapt.txt_doxygenified.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="two__d__adv__diff__adapt_8txt__doxygenified_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">\mainpage Example problem: Adaptive solution of the 2D advection diffusion equation</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">In this example we discuss the adaptive solution of the 2D</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">advection-diffusion problem</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">&lt;TABLE&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">&lt;TR&gt; </span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">&lt;TD&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">&lt;B&gt;Two-dimensional advection-diffusion problem in a </span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">rectangular domain&lt;/B&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">&lt;/CENTER&gt; </span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment">Solve</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">\mbox{Pe}\ \sum_{i=1}^2 w_i \left(x_1,x_2\right) \frac{\partial u}{\partial</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">x_i} = \sum_{i=1}^2 \frac{\partial^2u}{\partial x_i^2} + f(x_1,x_2), </span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> \ \ \ \ \ \ \ \ \ \ (1)</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">in the rectangular domain \f$D =\left\{ (x_1,x_2) \in </span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">[0,1] \times [0,2]\right\}\f$, </span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">with Dirichlet boundary conditions</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">\left. u\right|_{\partial D}=u_0,</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \ \ (2)</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">where the \e Peclet \e number, \f$ \mbox{Pe} \f$ the boundary values, </span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">\f$ u_0\f$, the source function \f$ f(x_1,x_2),\f$  </span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">and the components of the  &quot;wind&quot; \f$ w_i(x_1,x_2) \ (i=1,2)\f$ are given. </span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">&lt;/TD&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">&lt;/TR&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">&lt;/TABLE&gt;  </span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">&lt;/CENTER&gt;  </span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">We  choose the forcing function and the boundary conditions</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">such that </span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">u_0(x_1,x_2) = \tanh(1-\alpha(x_1 \tan\Phi - x_2)),</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \  (3)</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">is the exact solution of the problem.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">For large values of \f$ \alpha, \f$ </span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">the exact solution approaches a step, oriented at an angle</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">\f$\Phi\f$ against the \f$x_1-\f$axis.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> In the computations we will impose the &quot;wind&quot;</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">\f[</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">\mathbf{w}\left(x_1,x_2 \right) = </span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">\left(</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">\begin{array}{c}</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">\sin(6x_2) \\</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> \cos(6x_1)</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment">\end{array}</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">\right),</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">\ \ \ \ \ \ \ \ \  (4)</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">\f]</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">illustrated in this vector plot:</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">\image html wind.gif &quot;Plot of the wind. &quot; </span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">\image latex wind.eps &quot;Plot of the wind. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">The graph below shows a plot of the solution, computed at various</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">levels of mesh adaptation, for \f$\Phi=45^\circ, \ \alpha=50 \f$ </span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">and a Peclet number of \f$ Pe = 200.\f$</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment">\image html step_soln.gif &quot;Plot of the forced solution at different levels of mesh refinement. &quot; </span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">\image latex step_soln.eps &quot;Plot of the forced solution at different levels of mesh refinement. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment">More interesting is the following plot which shows the solution for</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">the same parameter values and boundary conditions, but for a zero</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">forcing function, \f$ f\equiv 0. \f$</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">\image html unforced_soln.gif &quot;Plot of the unforced solution at different levels of mesh refinement. &quot; </span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment">\image latex unforced_soln.eps &quot;Plot of the unforced solution at different levels of mesh refinement. &quot; width=0.75\textwidth</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">The plot nicely illustrates the physical effects represented by the</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">(unforced) advection diffusion equation. If \f$ u(x_1,x_2) \f$ represents the</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">concentration of a chemical that is advected by the velocity field</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">\f$ {\bf w}\f$, while being dispersed by molecular</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">diffusion, the advection-diffusion equation describes the</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">steady-state concentration of this chemical. In this context</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">the Peclet number is a measure of the relative importance of </span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">advective and diffusive effects. For very small Peclet number, </span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">the concentration is determined predominantly by diffusive </span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">effects -- as \f$ \mbox{Pe} \to 0\f$, the advection</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">diffusion equation approaches the Poisson equation. </span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">Conversely, at large values of the Peclet number, the concentration is </span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">determined predominantly by advective effects. The chemical </span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">is &quot;swept along&quot; by the flow and diffusive effects are only important</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">in thin &quot;boundary&quot; or &quot;shear&quot; layers in which the concentration </span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment">varies over short lengthscales. These can be seen clearly in the </span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">most finely resolved solution above.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">\section main The driver code</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment">Overall, the structure of the driver code is very similar to </span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment">that in the &lt;A HREF=&quot;../../../poisson/two_d_poisson/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment">corresponding Poisson example&lt;/a&gt;. The only difference </span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">is that we have to specify function pointers to the source and the</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment">&quot;wind&quot; functions, which are passed to the problem constructor.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> We create the problem, perform a self-test, set the global parameters</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment">that affect the solution and solve the problem using </span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment">\c oomph-lib&#39;s &quot;black-box&quot; adaptive Newton solver. </span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment">\dontinclude two_d_adv_diff_adapt.cc</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">\skipline start_of_main</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment">\until end of main</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment">&lt;HR&gt;   </span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment">\section global Global parameters and functions</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment">The specification of the source function and the exact solution</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment">in the namespace \c TanhSolnForAdvectionDiffusion is similar to that</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment">for the &lt;A HREF=&quot;../../../poisson/two_d_poisson/html/index.html#global&quot;&gt;</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment">Poisson examples.&lt;/A&gt; The only difference is the inclusion of the</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">Peclet number and the &quot;wind&quot; function. </span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment">  </span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">\dontinclude two_d_adv_diff_adapt.cc</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment">\skipline start_of_namespace</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment">\until end of namespace</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment">\section problem The problem class</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">The problem class is very similar to those used in the corresponding </span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson/html/index.html#problem&quot;&gt; Poisson</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment">examples.&lt;/A&gt; The only change is that we use the function </span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment">\c Problem::actions_before_adapt() to document the progress of the</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment">automatic spatial adaptation. For this purpose, we store a \c DocInfo </span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">as private member data in the \c Problem. This allows us to increment </span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment">the counter that labels the output files, accessible </span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">from \c DocInfo::number(), whenever a new solution has been</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment">documented.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment">\dontinclude two_d_adv_diff_adapt.cc</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment">\skipline start_of_problem_class</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">\until end of problem class</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment">\section constructor The Problem constructor</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">The constructor is practically identical to the constructors used</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment">in the various </span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson/html/index.html#constructor&quot;&gt; Poisson</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment">examples.&lt;/A&gt; We specify the output directory in the \c Problem&#39;s</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">\c DocInfo object, create the mesh and an error estimator, and apply</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment">the boundary conditions by pinning the nodal values on the Dirichlet</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment">boundaries.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">\skipline start_of_constructor</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">\until end loop over boundaries</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">We complete the problem setup by passing the function</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">pointers to the source and wind functions, and the pointer to the Peclet</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">number to the elements. Finally, we set up the equation numbering scheme.</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">\skipline Complete the build of all elements so they are fully functional</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">\until end of constructor</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment">\section actions_before Actions before solve</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">As before, we use the \c Problem::actions_before_newton_solve() function to</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">set/update the boundary conditions.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">\skipline start_of_actions_before_newton_solve</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">\until end of actions before solve</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">\section doc Post-processing</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment">The function \c doc_solution(...) is identical to that in the</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../poisson/two_d_poisson/html/index.html#doc&quot;&gt; Poisson</span></div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment">example.&lt;/A&gt; We output the solution, the exact solution and the </span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">error.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">\skipline start_of_doc</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment">\until end of doc</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment">\section com Comments and Exercises</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment">-# Explore the change in the character of the solution of the </span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment">   unforced problem when the Peclet number is slowly increased from 0 to 200,</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">   say. Note how at small Peclet number, strong diffusive effects</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment">   smooth out the rapid spatial variations imposed by the boundary conditions.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">   Conversely, at large values of the Peclet number, the behaviour is</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">   dominated by advective effects. As a result, in regions where </span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment">   the &quot;wind&quot; is directed into the domain, the value of \f$ u \f$ </span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment">   set by the Dirichlet boundary conditions is &quot;swept&quot; into the domain. </span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">   In regions where the &quot;wind&quot; is directed out of the domain, </span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">   the value of \f$ u \f$ &quot;swept along&quot; by the flow</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">   in the interior &quot;clashes&quot; with the value prescribed by the boundary</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment">   conditions and the solution adjusts itself over a very short length</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">   scale, leading to the development of thin &quot;boundary layers&quot;.</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">-# Explore the character of the solution on coarse meshes at large</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">   and small Peclet numbers. Note how at large Peclet numbers </span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">   the solution on the coarse meshes displays strong &quot;wiggles&quot;</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">   throughout the domain. These</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">   only disappear once the mesh adaptation fully resolves the regions</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">   of rapid variation. We will explore this issue further in </span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">   &lt;A HREF=&quot;../../two_d_adv_diff_SUPG/html/index.html&quot;&gt;</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="comment">   another example.&lt;/A&gt; </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="comment"> </span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">&lt;HR&gt;</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment">\section sources Source files for this tutorial</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment">- The source files for this tutorial are located in the directory:</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/advection_diffusion/two_d_adv_diff_adapt/&quot;&gt;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="comment">demo_drivers/advection_diffusion/two_d_adv_diff_adapt/</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">- The driver code is: </span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">&lt;CENTER&gt;</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment">&lt;A HREF=&quot;../../../../demo_drivers/advection_diffusion/two_d_adv_diff_adapt/two_d_adv_diff_adapt.cc&quot;&gt;</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">demo_drivers/advection_diffusion/two_d_adv_diff_adapt/two_d_adv_diff_adapt.cc</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment">&lt;/A&gt;</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment">&lt;/CENTER&gt;</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">.</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment">&lt;hr&gt;</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment">\section pdf PDF file</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment">A &lt;a href=&quot;../latex/refman.pdf&quot;&gt;pdf version&lt;/a&gt; of this document is available.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">**/</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a8dcf0ff357bac1ffc580600c1bdfb343"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a8dcf0ff357bac1ffc580600c1bdfb343">Phi</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f Phi</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00065">two_d_adv_diff_adapt.txt:65</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_ad1d7c31f3af42f675d51dd67a3b19b65"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#ad1d7c31f3af42f675d51dd67a3b19b65">functions</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing f f equiv f I w textwidth unforced_soln Plot of the unforced solution at different levels of mesh refinement The plot nicely illustrates the physical effects represented by x_2 f represents the concentration of a chemical that is advected by the velocity field while being dispersed by molecular the advection diffusion equation describes the steady state concentration of this chemical In this context the Peclet number is a measure of the relative importance of advective and diffusive effects For very small Peclet the concentration is determined predominantly by diffusive effects as f the advection diffusion equation approaches the Poisson equation at large values of the Peclet the concentration is determined predominantly by advective effects The chemical is swept along by the flow and diffusive effects are only important in thin boundary or shear layers in which the concentration varies over short lengthscales These can be seen clearly in the most finely resolved solution above&lt; HR &gt;&lt; HR &gt; section main The driver code the structure of the driver code is very similar to that in the&lt; A HREF=&quot;../../../poisson/two_d_poisson/html/index.html&quot;&gt; corresponding Poisson example&lt;/a &gt; The only difference is that we have to specify function pointers to the source and the wind functions</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00107">two_d_adv_diff_adapt.txt:107</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a2ca0d291375c8cf864319d932aa25ef1"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a2ca0d291375c8cf864319d932aa25ef1">$D</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f $D</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00020">two_d_adv_diff_adapt.txt:20</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_aff0951cfff6c25be37dbc9676304fca4"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#aff0951cfff6c25be37dbc9676304fca4">adaptation</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh adaptation</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00065">two_d_adv_diff_adapt.txt:65</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_af3fabef386f9b90e39ea456a16dfffd7"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#af3fabef386f9b90e39ea456a16dfffd7">plot</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector plot</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00064">two_d_adv_diff_adapt.txt:64</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_ac481d21ad7c3baaec7c3468d5f23c0a3"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#ac481d21ad7c3baaec7c3468d5f23c0a3">Conversely</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing f f equiv f I w textwidth unforced_soln Plot of the unforced solution at different levels of mesh refinement The plot nicely illustrates the physical effects represented by x_2 f represents the concentration of a chemical that is advected by the velocity field while being dispersed by molecular the advection diffusion equation describes the steady state concentration of this chemical In this context the Peclet number is a measure of the relative importance of advective and diffusive effects For very small Peclet the concentration is determined predominantly by diffusive effects as f the advection diffusion equation approaches the Poisson equation Conversely</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00087">two_d_adv_diff_adapt.txt:87</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_ae59e8f551f78a176135d6f368c1edccf"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#ae59e8f551f78a176135d6f368c1edccf">number</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e number</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00028">two_d_adv_diff_adapt.txt:28</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a5e94633d36939e5ac1e2e7bec20d3d13"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a5e94633d36939e5ac1e2e7bec20d3d13">step</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a step</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00044">two_d_adv_diff_adapt.txt:44</a></div></div>
<div class="ttc" id="anamespaceTanhSolnForAdvectionDiffusion_html_aeba486af70e92ab7eec1da3ce44d51ee"><div class="ttname"><a href="namespaceTanhSolnForAdvectionDiffusion.html#aeba486af70e92ab7eec1da3ce44d51ee">TanhSolnForAdvectionDiffusion::Peclet</a></div><div class="ttdeci">double Peclet</div><div class="ttdoc">Peclet number.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8cc_source.html#l00050">two_d_adv_diff_adapt.cc:50</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a68c9e0b6e25811420052843d3443e6ad"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a68c9e0b6e25811420052843d3443e6ad">Overall</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing f f equiv f I w textwidth unforced_soln Plot of the unforced solution at different levels of mesh refinement The plot nicely illustrates the physical effects represented by x_2 f represents the concentration of a chemical that is advected by the velocity field while being dispersed by molecular the advection diffusion equation describes the steady state concentration of this chemical In this context the Peclet number is a measure of the relative importance of advective and diffusive effects For very small Peclet the concentration is determined predominantly by diffusive effects as f the advection diffusion equation approaches the Poisson equation at large values of the Peclet the concentration is determined predominantly by advective effects The chemical is swept along by the flow and diffusive effects are only important in thin boundary or shear layers in which the concentration varies over short lengthscales These can be seen clearly in the most finely resolved solution above&lt; HR &gt;&lt; HR &gt; section main The driver code Overall</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00103">two_d_adv_diff_adapt.txt:103</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_afa12ec1d0307da9553be8c5cde54d7e3"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#afa12ec1d0307da9553be8c5cde54d7e3">f</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 f</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00029">two_d_adv_diff_adapt.txt:29</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="two__d__adv__diff__adapt_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdoc">Driver code for 2D AdvectionDiffusion problem.</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8cc_source.html#l00322">two_d_adv_diff_adapt.cc:322</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a8d29346d6d585c2a92835d6f66c4bd8f"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a8d29346d6d585c2a92835d6f66c4bd8f">frac</a></div><div class="ttdeci">mainpage Example x_2 right frac</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00016">two_d_adv_diff_adapt.txt:16</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a53488c319bb3c7b17d2ebb8bde004fd5"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a53488c319bb3c7b17d2ebb8bde004fd5">diffusion</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing f f equiv f I w textwidth unforced_soln Plot of the unforced solution at different levels of mesh refinement The plot nicely illustrates the physical effects represented by x_2 f represents the concentration of a chemical that is advected by the velocity field while being dispersed by molecular diffusion</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00080">two_d_adv_diff_adapt.txt:80</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_ad8a88a5ad96649fa54493607e5ccd643"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#ad8a88a5ad96649fa54493607e5ccd643">mbox</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f mbox</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00028">two_d_adv_diff_adapt.txt:28</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a64ca40fb5c030138fd28be4db1d5d5e1"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a64ca40fb5c030138fd28be4db1d5d5e1">alpha</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f alpha</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00043">two_d_adv_diff_adapt.txt:43</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_abdc9d435af0940cc4d1e7e778184dbcc"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#abdc9d435af0940cc4d1e7e778184dbcc">test</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing f f equiv f I w textwidth unforced_soln Plot of the unforced solution at different levels of mesh refinement The plot nicely illustrates the physical effects represented by x_2 f represents the concentration of a chemical that is advected by the velocity field while being dispersed by molecular the advection diffusion equation describes the steady state concentration of this chemical In this context the Peclet number is a measure of the relative importance of advective and diffusive effects For very small Peclet the concentration is determined predominantly by diffusive effects as f the advection diffusion equation approaches the Poisson equation at large values of the Peclet the concentration is determined predominantly by advective effects The chemical is swept along by the flow and diffusive effects are only important in thin boundary or shear layers in which the concentration varies over short lengthscales These can be seen clearly in the most finely resolved solution above&lt; HR &gt;&lt; HR &gt; section main The driver code the structure of the driver code is very similar to that in the&lt; A HREF=&quot;../../../poisson/two_d_poisson/html/index.html&quot;&gt; corresponding Poisson example&lt;/a &gt; The only difference is that we have to specify function pointers to the source and the wind which are passed to the problem constructor We create the perform a self test</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00108">two_d_adv_diff_adapt.txt:108</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a324468ffa84fee5e9c1f91c323c12672"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a324468ffa84fee5e9c1f91c323c12672">problem</a></div><div class="ttdeci">mainpage Example problem</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00016">two_d_adv_diff_adapt.txt:16</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a80a923add262919bc71e41720b346309"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a80a923add262919bc71e41720b346309">function</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing function</div><div class="ttdef"><b>Definition:</b> <a href="two__d__adv__diff__adapt_8txt_source.html#l00072">two_d_adv_diff_adapt.txt:72</a></div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_acc6d07b5b26872c07775ebb484f912c1"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#acc6d07b5b26872c07775ebb484f912c1">the</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f f are given&lt;/TD &gt;&lt;/TR &gt;&lt;/TABLE &gt;&lt;/CENTER &gt; We choose the forcing function and the boundary conditions such that f[u_0(x_1, x_2)=\tanh(1-\alpha(x_1 \tan\Phi - x_2)),\ \ \ \ \ \ \ \ \ @E[ExactSoln]@\f] is the exact solution of the problem For large values of f f the exact solution approaches a oriented at an angle f Phi f against the f $x_1 f $axis In the computations we will impose the wind f[\mathbf{w}\left(x_1, x_2 \right)=\left(\begin{array}{c}\sin(6x_2) \\ \cos(6x_1)\end{array}\right),\ \ \ \ \ \ \ \ \ @E[WindFct]@\f] illustrated in this vector computed at various levels of mesh for f but for a zero forcing f f equiv f I w textwidth unforced_soln Plot of the unforced solution at different levels of mesh refinement The plot nicely illustrates the physical effects represented by the(unforced) advection diffusion equation. If \f$ u(x_1</div></div>
<div class="ttc" id="atwo__d__adv__diff__adapt_8txt_html_a1a190a80d82976e45c51212fc6d87873"><div class="ttname"><a href="two__d__adv__diff__adapt_8txt.html#a1a190a80d82976e45c51212fc6d87873">w_i</a></div><div class="ttdeci">mainpage Example x_2 right E[2DPoisson] f in the rectangular domain f with Dirichlet boundary conditions f[\left. u\right|_{\partial D}=u_0,\ \ \ \ \ \ \ \ \ \ @E[2DPoisson_BC]@\f] where the e Peclet e f f u_0 the source function f f and the components of the wind f w_i(x_1, x_2) \(i</div></div>

    <!-- jQuery for Bootstrap and Doxygen -->
    <script src="../../../js/jquery-1.12.0.min.js"></script>
    <!-- Minified boostrap plugins-->
    <script src="../../../js/bootstrap.js"></script>
    <!-- Doxygen dependency to add powertips to source code-->
    <script src="../../../js/jquery.powertip.min.js"></script>
    <!-- The  following script is generated by doxygen and hides/shows levels in 
         the data structure lists and adds powertips to source code-->
    <script src="../../../js/dynsections.js" ></script>
    <!-- add to Doxygen's class names so bootstrap css and js recognises them-->
    <script type="text/javascript">
    $(".contents").addClass("container");
    $(".header").addClass("container");
    $(".navpath").addClass("container");
    $("#navrow3").addClass("container");
    $("#navrow4").addClass("container");
    $(".mlabel").addClass("label");
    $(".mlabel").addClass("label-default");
    $(".memitem").addClass("panel");
    $(".memitem").addClass("panel-info");
    $(".memproto").addClass("panel-heading");
    $(".memdoc").addClass("panel-body");
    </script>
    <footer>
      <div class="container">
        <div class="text-muted" style="float:right;">Generated by <a href="http://www.doxygen.org/index.html">
          <img style="height:18px;" class="footer-img" src="doxygen.png" alt="doxygen"></a> on Wed Jul 21 2021 19:24:02
        </div>
      </div>
    </footer>
</body>
</html>
